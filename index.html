<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì‹¬í™” íƒêµ¬ ê³¼ì • í†µí•© ì›Œí¬ë¶ (ì™„ì „íŒ)</title>

    <!-- í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&display=swap');

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8fafc;
            color: #0f172a;
            word-break: keep-all;
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        #loading-screen {
            position: fixed;
            inset: 0;
            background: #0f172a;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .fade-in {
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media print {

            @page {
                size: A4;
                margin: 14mm 14mm 14mm 14mm;
            }

            /* âœ… ì¸ì‡„ ì‹œ: í™”ë©´(UI) ì‹¹ ìˆ¨ê¸°ê³  PrintViewë§Œ ë‚¨ê¸°ê¸° (1í˜ì´ì§€ UI ì¶œë ¥ ë°©ì§€) */
            body * {
                visibility: hidden !important;
            }

            .print-root,
            .print-root * {
                visibility: visible !important;
            }

            .print-root {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }

            /* (ë³´ì¡°) í™”ë©´ìš© ì˜ì—­ì€ í™•ì‹¤íˆ ìˆ¨ê¹€ */
            .no-print {
                display: none !important;
            }

            /* PrintViewë§Œ ë³´ì´ê²Œ */
            .print-only {
                display: block !important;
            }

            html,
            body {
                background: #fff !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                font-family: "Noto Sans KR", system-ui, -apple-system, Segoe UI, Roboto, sans-serif !important;
                color: #111827 !important;
            }

            /* ì„¹ì…˜ ë‹¨ìœ„ë¡œ 'ì‹œì‘'ë§Œ ìƒˆ í˜ì´ì§€ë¡œ(ëì„ ê°•ì œí•˜ì§€ ì•ŠìŒ) */
            .print-section {
                break-before: page;
                page-break-before: always;
            }

            .print-section.first {
                break-before: auto;
                page-break-before: auto;
            }

            /* ë„ˆë¬´ ê°•í•œ avoidëŠ” ê¸´ ê¸€ì—ì„œ 'ì˜ë¦¼'ì„ ìœ ë°œ â†’ ë¸”ë¡ì€ ê°€ëŠ¥í•œ ì„ ì—ì„œë§Œ */
            .print-card,
            .print-block {
                break-inside: auto;
                page-break-inside: auto;
            }

            /* âœ… ê¸´ í…ìŠ¤íŠ¸ëŠ” í˜ì´ì§€ ë‚´ì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ ë¶„í•  í—ˆìš© + ê¸´ URLë„ ì¤„ë°”ê¿ˆ */
            .print-pre {
                white-space: pre-wrap;
                overflow-wrap: anywhere;
                word-break: break-word;
            }

            .shadow-xl,
            .shadow-2xl,
            .shadow-lg,
            .shadow-sm {
                box-shadow: none !important;
            }

            .border-double {
                border-style: solid !important;
            }

            .print-title {
                font-size: 26pt !important;
                line-height: 1.15 !important;
                font-weight: 900 !important;
            }

            .print-subtitle {
                font-size: 12pt !important;
                letter-spacing: 0.08em !important;
                color: #6b7280 !important;
            }

            .print-h2 {
                font-size: 16pt !important;
                font-weight: 900 !important;
                margin: 0 0 10mm 0 !important;
            }

            .print-label {
                font-size: 9pt !important;
                font-weight: 800 !important;
                letter-spacing: 0.12em !important;
                color: #6b7280 !important;
                text-transform: uppercase;
            }

            .print-body {
                font-size: 11pt !important;
                line-height: 1.55 !important;
            }

            .print-small {
                font-size: 9.5pt !important;
                line-height: 1.5 !important;
                color: #374151 !important;
            }

            ul,
            ol {
                margin: 0;
                padding-left: 18px;
            }

            li {
                margin: 2mm 0;
            }
        }

        /* ê¸°ë³¸: í™”ë©´ì—ì„œëŠ” PrintView ìˆ¨ê¹€ */
        .print-only {
            display: none;
        }

        .btn-ai-glow {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            transition: all 0.3s ease;
        }

        .btn-ai-glow:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(79, 70, 229, 0.5);
        }
    </style>
</head>

<body>
    <div id="loading-screen">
        <div
            style="width:40px;height:40px;border:4px solid #6366f1;border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:20px;">
        </div>
        <p style="font-weight:900;letter-spacing:2px;">SYSTEM LOADING...</p>
        <p style="font-size:12px;color:#94a3b8;margin-top:6px;">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”.</p>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        /****************************************************************
         * 0) í™˜ê²½/ê¸°ë³¸ ìƒìˆ˜
         ****************************************************************/
        const { useState, useEffect } = React;

        // TODO: ë³¸ì¸ Apps Script ë°°í¬ URLë¡œ êµì²´í•˜ì„¸ìš”.
        const CONFIG = {
            SCRIPT_URL: "https://script.google.com/macros/s/AKfycbwU0llzFeQJW29LyStZRU9ohrveZq6sH_xVaF9IgV4Iwd1p8aqBiRjNJCuBNEJEOPcI/exec",
            GEMINI_MODEL: "gemini-2.5-flash" // ì„œë²„ì—ì„œ ì‚¬ìš© ì¤‘ì¸ ëª¨ë¸ëª…ì— ë§ì¶° ì¡°ì •
        };

        const EMPTY_STUDENT = {
            school: "",
            gradeClass: "",
            name: "",
            major: ""
        };


        const EMPTY_SESSION = {
            // 1ì°¨ì‹œ: í‚¤ì›Œë“œ â†’ ì£¼ì œ â†’ ë™ê¸° â†’ ì§ˆë¬¸
            s1_subject: "",        // êµê³¼(ê³¼ëª©/ë‹¨ì›/ê°œë…)
            s1_keywords: "",       // í¬ë§ ë¶„ì•¼ ê´€ì‹¬ í‚¤ì›Œë“œ(ì‰¼í‘œ)
            s1_topic: "",          // íƒêµ¬ ì£¼ì œ(ê°€ì œ)
            s1_motive: "",         // íƒêµ¬ ë™ê¸°
            s1_question: "",       // íƒêµ¬ ì§ˆë¬¸(RQ)
            s1_scope: "",          // ë²”ìœ„/ëŒ€ìƒ/ë³€ì¸(ê°€ëŠ¥í•˜ë©´)

            // 2ì°¨ì‹œ: ìë£Œ ì¡°ì‚¬(ì„ íƒ) â†’ ìš”ì•½/í•µì‹¬ â†’ ì£¼ì œ ì—°ê²° (ìµœëŒ€ 3ê°œ)
            s2_src1_type: "ë„ì„œ",
            s2_src1_title: "",
            s2_src1_ref: "",       // ì €ì/ê¸°ê´€/URL/ë°œí–‰ì—°ë„
            s2_src1_core: "",      // ìš”ì•½/í•µì‹¬ ë‚´ìš©
            s2_src1_connect: "",   // ë‚´ ì£¼ì œì™€ì˜ ì—°ê²°(ê°œë…/ë³€ì¸/ê´€ì )

            s2_src2_type: "ë…¼ë¬¸",
            s2_src2_title: "",
            s2_src2_ref: "",
            s2_src2_core: "",
            s2_src2_connect: "",

            s2_src3_type: "ë‰´ìŠ¤ê¸°ì‚¬",
            s2_src3_title: "",
            s2_src3_ref: "",
            s2_src3_core: "",
            s2_src3_connect: "",

            s2_takeaway: "",       // ìë£Œì¡°ì‚¬ ì¢…í•© ì •ë¦¬(ë‚´ê°€ ì–»ì€ ê´€ì /ê°€ì„¤/ë³€ì¸ í›„ë³´)

            // 3ì°¨ì‹œ: íƒêµ¬ ë°©ë²• ë° ê³¼ì •
            s3_method_type: "ë¬¸í—Œì—°êµ¬(ì´ë¡ /ì‚¬ë¡€ë¶„ì„)",
            s3_hypothesis: "",     // ê°€ì„¤/ì£¼ì¥(ìˆë‹¤ë©´)
            s3_variables: "",      // ë³€ì¸/ì§€í‘œ/ì¸¡ì • ë°©ë²•
            s3_process: "",        // ì ˆì°¨(ë‹¨ê³„ë³„)
            s3_data_plan: "",      // ë°ì´í„° ìˆ˜ì§‘/ì •ë¦¬/ì‹œê°í™” ê³„íš
            s3_tools: "",          // ë„êµ¬(ì—‘ì…€/í†µê·¸ë¼ë¯¸/íŒŒì´ì¬/ì„¤ë¬¸ë„êµ¬ ë“±)
            s3_ethics_safety: "",  // ìœ¤ë¦¬/ì•ˆì „/ê°œì¸ì •ë³´

            // 4ì°¨ì‹œ: ê²°ë¡  ë° ë°°ìš´ì /í›„ì†
            s4_findings: "",       // í•µì‹¬ ê²°ê³¼(í‘œ/ê·¸ë˜í”„/ê´€ì°° ìš”ì•½)
            s4_conclusion: "",     // ê²°ë¡ (ì£¼ì¥ + ê·¼ê±° ì—°ê²°)
            s4_learning: "",       // ë°°ìš´ì (ê°œë…/ê¸°ìˆ /íƒœë„)
            s4_limits: "",         // í•œê³„/ì˜¤ì°¨/ë°˜ë¡€/ì£¼ì˜
            s4_next: "",           // í›„ì† íƒêµ¬ ì œì•ˆ

            // íƒêµ¬ë³´ê³ ì„œ ì™„ì„±: ìë™ ìƒì„±ë³¸ì„ ì €ì¥/í¸ì§‘í•  ìˆ˜ ìˆëŠ” í•„ë“œ(ì„ íƒ)
            sR_report: "",
            // 1í˜ì´ì§€ ìš”ì•½(ì œì¶œìš©): ìë™ ìƒì„±ë³¸ì„ ì €ì¥/í¸ì§‘í•  ìˆ˜ ìˆëŠ” í•„ë“œ(ì„ íƒ)
            sR_onepage: "",
        };

        const norm = (v) => (v ?? "").toString().trim();

        const buildSourcesText = (sd) => {
            const mk = (i) => {
                const type = norm(sd[`s2_src${i}_type`]);
                const title = norm(sd[`s2_src${i}_title`]);
                const ref = norm(sd[`s2_src${i}_ref`]);
                const core = norm(sd[`s2_src${i}_core`]);
                const conn = norm(sd[`s2_src${i}_connect`]);
                if (!type && !title && !ref && !core && !conn) return "";
                return [
                    `- [${type || "ìë£Œ"}] ${title || "(ìë£Œëª… ë¯¸ì…ë ¥)"}`,
                    `  Â· ì¶œì²˜: ${ref || "(ë¯¸ì…ë ¥)"}`,
                    `  Â· í•µì‹¬: ${core || "(ë¯¸ì…ë ¥)"}`,
                    `  Â· ì£¼ì œ ì—°ê²°: ${conn || "(ë¯¸ì…ë ¥)"}`,
                ].join("\n");
            };

            const lines = [mk(1), mk(2), mk(3)].filter(Boolean);
            return lines.length ? lines.join("\n") : "- (ìë£Œê°€ ì•„ì§ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.)";
        };

        const buildFinalReport = (studentInfo, sd) => {
            const studentLine = [
                `í•™êµ: ${norm(studentInfo.school) || "ë¯¸ì…ë ¥"}`,
                `í•™ë²ˆ: ${norm(studentInfo.gradeClass) || "ë¯¸ì…ë ¥"}`,
                `ì´ë¦„: ${norm(studentInfo.name) || "ë¯¸ì…ë ¥"}`,
                `í¬ë§ ì „ê³µ: ${norm(studentInfo.major) || "ë¯¸ì…ë ¥"}`,
            ].join(" | ");

            const report = `
  [íƒêµ¬ë³´ê³ ì„œ]

  0. ê¸°ë³¸ ì •ë³´
  - ${studentLine}

  1. íƒêµ¬ ì£¼ì œ ë° ì—°êµ¬ ì§ˆë¬¸
  - êµê³¼(ê³¼ëª©/ë‹¨ì›/ê°œë…): ${norm(sd.s1_subject) || "(ë¯¸ì…ë ¥)"}
  - ê´€ì‹¬ í‚¤ì›Œë“œ: ${norm(sd.s1_keywords) || "(ë¯¸ì…ë ¥)"}
  - íƒêµ¬ ì£¼ì œ(ê°€ì œ): ${norm(sd.s1_topic) || "(ë¯¸ì…ë ¥)"}
  - íƒêµ¬ ë™ê¸°: ${norm(sd.s1_motive) || "(ë¯¸ì…ë ¥)"}
  - íƒêµ¬ ì§ˆë¬¸(RQ): ${norm(sd.s1_question) || "(ë¯¸ì…ë ¥)"}
  - ë²”ìœ„/ëŒ€ìƒ/ë³€ì¸: ${norm(sd.s1_scope) || "(ë¯¸ì…ë ¥)"}

  2. ì´ë¡ ì  ë°°ê²½ ë° ìë£Œ ì¡°ì‚¬
  ${buildSourcesText(sd)}
    - ìë£Œì¡°ì‚¬ ì¢…í•©(ë‚´ê°€ ì–»ì€ ê´€ì /ê°€ì„¤/ë³€ì¸ í›„ë³´): ${norm(sd.s2_takeaway) || "(ë¯¸ì…ë ¥)"}

  3. íƒêµ¬ ë°©ë²• ë° ê³¼ì •
  - ë°©ë²• ìœ í˜•: ${norm(sd.s3_method_type) || "(ë¯¸ì…ë ¥)"}
  - ê°€ì„¤/ì£¼ì¥(ì„ íƒ): ${norm(sd.s3_hypothesis) || "(ë¯¸ì…ë ¥)"}
  - ë³€ì¸/ì§€í‘œ/ì¸¡ì •: ${norm(sd.s3_variables) || "(ë¯¸ì…ë ¥)"}
  - ê³¼ì •(ë‹¨ê³„ë³„): ${norm(sd.s3_process) || "(ë¯¸ì…ë ¥)"}
  - ë°ì´í„° ê³„íš(ìˆ˜ì§‘/ì •ë¦¬/ì‹œê°í™”): ${norm(sd.s3_data_plan) || "(ë¯¸ì…ë ¥)"}
  - ì‚¬ìš© ë„êµ¬: ${norm(sd.s3_tools) || "(ë¯¸ì…ë ¥)"}
  - ìœ¤ë¦¬/ì•ˆì „/ê°œì¸ì •ë³´: ${norm(sd.s3_ethics_safety) || "(ë¯¸ì…ë ¥)"}

  4. ê²°ê³¼, ê²°ë¡  ë° ì„±ì°°
  - í•µì‹¬ ê²°ê³¼: ${norm(sd.s4_findings) || "(ë¯¸ì…ë ¥)"}
  - ê²°ë¡ : ${norm(sd.s4_conclusion) || "(ë¯¸ì…ë ¥)"}
  - ë°°ìš´ ì : ${norm(sd.s4_learning) || "(ë¯¸ì…ë ¥)"}
  - í•œê³„/ì£¼ì˜ì : ${norm(sd.s4_limits) || "(ë¯¸ì…ë ¥)"}
  - í›„ì† íƒêµ¬: ${norm(sd.s4_next) || "(ë¯¸ì…ë ¥)"}

  5. ì°¸ê³ ë¬¸í—Œ(ì´ˆì•ˆ)
  - ìœ„ ìë£Œ ì¡°ì‚¬(2ë²ˆ)ì— ê¸°ì¬í•œ ì¶œì²˜ë¥¼ ë³´ê³ ì„œ ì–‘ì‹ì— ë§ê²Œ ì •ë¦¬í•©ë‹ˆë‹¤.
  `.trim();

            return report;
        };

        /**********************
         * Validation Helpers
         **********************/
        const scoreSourceRef = (ref) => {
            const r = norm(ref);
            const hasUrl = /https?:\/\/\S+/i.test(r);
            const hasYear = /(19|20)\d{2}/.test(r) || /\d{4}\s*ë…„/.test(r);
            // ê¸°ê´€/ì €ì ì¶”ì •(ë„ˆë¬´ ì—„ê²©í•˜ì§€ ì•Šê²Œ)
            const hasOrgOrAuthor = /[ê°€-í£A-Za-z]{2,}/.test(r);

            const score = [hasUrl, hasYear, hasOrgOrAuthor].filter(Boolean).length;
            return { score, hasUrl, hasYear, hasOrgOrAuthor };
        };

        const isMeasurableQuestion = (q) => {
            const s = norm(q);
            if (s.length < 10) return false;
            // ì¸¡ì •/ê²€ì¦/ê´€ê³„ ì¤‘ì‹¬ í‚¤ì›Œë“œê°€ ìˆìœ¼ë©´ í†µê³¼ë¡œ ê°„ì£¼(íœ´ë¦¬ìŠ¤í‹±)
            if (/ìƒê´€|ê´€ê³„|ì°¨ì´|ì˜í–¥|íš¨ê³¼|ë¹„êµ|ì˜ˆì¸¡|ë¶„ì„|ê²€ì¦|ì¸¡ì •|ë³€ì¸|ì§€í‘œ|ìœ ì˜ë¯¸/.test(s)) return true;
            // ìˆ«ì/ê¸°ê°„/ë¹„ìœ¨ ë“± íŒíŠ¸ê°€ ìˆìœ¼ë©´ í†µê³¼ë¡œ ê°„ì£¼
            if (/\d/.test(s)) return true;
            return false;
        };

        const getIssues = (studentInfo, sd) => {
            const issues = {
                info: [],
                s1: [],
                s2: [],
                s3: [],
                s4: [],
                onepage: [],
                report: []
            };

            // info
            if (!norm(studentInfo.school)) issues.info.push("í•™êµëª…");
            if (!norm(studentInfo.gradeClass)) issues.info.push("í•™ë²ˆ");
            if (!norm(studentInfo.name)) issues.info.push("ì„±ëª…");
            if (!norm(studentInfo.major)) issues.info.push("í¬ë§ ì „ê³µ");

            // 1ì°¨ì‹œ
            if (!norm(sd.s1_subject)) issues.s1.push("êµê³¼(ê³¼ëª©/ë‹¨ì›/ê°œë…)");
            if (!norm(sd.s1_keywords)) issues.s1.push("ê´€ì‹¬ í‚¤ì›Œë“œ(5~10ê°œ)");
            if (!norm(sd.s1_topic)) issues.s1.push("íƒêµ¬ ì£¼ì œ(ê°€ì œ)");
            if (!norm(sd.s1_motive)) issues.s1.push("íƒêµ¬ ë™ê¸°");
            if (!norm(sd.s1_question)) issues.s1.push("íƒêµ¬ ì§ˆë¬¸(RQ)");
            if (norm(sd.s1_question) && !isMeasurableQuestion(sd.s1_question)) {
                issues.s1.push("RQê°€ â€˜ì¸¡ì •/ê²€ì¦ ê°€ëŠ¥í•œ í˜•íƒœâ€™ì¸ì§€(ìƒê´€/ì°¨ì´/ì˜í–¥/ì§€í‘œ ë“±) ë³´ê°•");
            }
            if (!norm(sd.s1_scope)) issues.s1.push("ë²”ìœ„/ëŒ€ìƒ/ë³€ì¸(ì¸¡ì • ê°€ëŠ¥í•˜ê²Œ)");

            // 2ì°¨ì‹œ(ìë£Œì¡°ì‚¬ëŠ” â€˜ê¶Œì¥â€™, ë‹¨ ì¶œì²˜ í˜•ì‹ì€ ì…ë ¥ ì‹œ ì ê²€)
            const anySourceTitle =
                norm(sd.s2_src1_title) || norm(sd.s2_src2_title) || norm(sd.s2_src3_title);

            if (!anySourceTitle) issues.s2.push("ìë£Œ 1ê°œ ì´ìƒ ì…ë ¥(ê¶Œì¥)");

            [1, 2, 3].forEach((i) => {
                const title = norm(sd[`s2_src${i}_title`]);
                const ref = norm(sd[`s2_src${i}_ref`]);
                const core = norm(sd[`s2_src${i}_core`]);
                const conn = norm(sd[`s2_src${i}_connect`]);

                if (title || ref || core || conn) {
                    const { score } = scoreSourceRef(ref);
                    if (score < 2) issues.s2.push(`ìë£Œ ${i} ì¶œì²˜ í˜•ì‹(ê¸°ê´€/ì—°ë„/URL ì¤‘ 2ê°œ ì´ìƒ)`);
                    if (!core) issues.s2.push(`ìë£Œ ${i} í•µì‹¬ ìš”ì•½(3~6ì¤„)`);
                    if (!conn) issues.s2.push(`ìë£Œ ${i} ì£¼ì œ ì—°ê²°(ë‚´ ì£¼ì œì— ì–´ë–»ê²Œ ì“°ëŠ”ì§€)`);
                }
            });

            // 3ì°¨ì‹œ(ìœ¤ë¦¬/ì•ˆì „ì€ ì‚¬ì‹¤ìƒ í•„ìˆ˜)
            if (!norm(sd.s3_variables)) issues.s3.push("ë³€ì¸/ì§€í‘œ/ì¸¡ì •(ë…ë¦½Â·ì¢…ì†Â·í†µì œ)");
            if (!norm(sd.s3_process)) issues.s3.push("ê³¼ì •(ë‹¨ê³„ë³„ ì ˆì°¨)");
            if (!norm(sd.s3_data_plan)) issues.s3.push("ë°ì´í„° ê³„íš(í‘œ/ê·¸ë˜í”„ ì‚°ì¶œë¬¼)");
            if (!norm(sd.s3_ethics_safety)) issues.s3.push("ìœ¤ë¦¬/ì•ˆì „/ê°œì¸ì •ë³´(í•„ìˆ˜)");

            // 4ì°¨ì‹œ
            if (!norm(sd.s4_findings)) issues.s4.push("í•µì‹¬ ê²°ê³¼(ê·¼ê±° ì¤‘ì‹¬)");
            if (!norm(sd.s4_conclusion)) issues.s4.push("ê²°ë¡ (ì£¼ì¥ + ê·¼ê±° ì—°ê²°)");
            if (!norm(sd.s4_limits)) issues.s4.push("í•œê³„/ì£¼ì˜ì (ê³¼ì¥ ë°©ì§€)");
            if (!norm(sd.s4_next)) issues.s4.push("í›„ì† íƒêµ¬(í•œê³„ ë³´ì™„)");

            // 1í˜ì´ì§€ ìš”ì•½/ë³´ê³ ì„œ: í•µì‹¬ ìš”ì†Œê°€ ë¹ ì§€ë©´ ê²½ê³ 
            if (!norm(sd.s4_conclusion) || !norm(sd.s3_process) || !anySourceTitle) {
                issues.onepage.push("ìš”ì•½ì€ â€˜ìë£Œ/ë°©ë²•/ê²°ë¡ â€™ 3ìš”ì†Œê°€ ëª¨ë‘ ìˆì–´ì•¼ ì„¤ë“ë ¥ì´ ë†’ìŠµë‹ˆë‹¤.");
            }
            if (!norm(sd.sR_report) && (!norm(sd.s3_process) || !norm(sd.s4_conclusion))) {
                issues.report.push("ë³´ê³ ì„œ ìë™ ìƒì„± ì „, ë°©ë²•/ê²°ë¡  ì…ë ¥ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.");
            }

            const total =
                issues.info.length +
                issues.s1.length +
                issues.s2.length +
                issues.s3.length +
                issues.s4.length;

            return { ...issues, total };
        };

        const summarizeIssues = (issues) => {
            const lines = [];
            if (issues.info.length) lines.push(`- ì •ë³´ ì…ë ¥: ${issues.info.join(", ")}`);
            if (issues.s1.length) lines.push(`- 1ì°¨ì‹œ: ${issues.s1.join(", ")}`);
            if (issues.s2.length) lines.push(`- 2ì°¨ì‹œ: ${issues.s2.join(", ")}`);
            if (issues.s3.length) lines.push(`- 3ì°¨ì‹œ: ${issues.s3.join(", ")}`);
            if (issues.s4.length) lines.push(`- 4ì°¨ì‹œ: ${issues.s4.join(", ")}`);
            return lines.join("\n");
        };

        /**********************
         * One-page Summary
         **********************/
        const buildSourcesShort = (sd) => {
            const mk = (i) => {
                const type = norm(sd[`s2_src${i}_type`]);
                const title = norm(sd[`s2_src${i}_title`]);
                const ref = norm(sd[`s2_src${i}_ref`]);
                if (!type && !title && !ref) return "";
                return `- [${type || "ìë£Œ"}] ${title || "(ì œëª© ë¯¸ì…ë ¥)"} / ${ref || "(ì¶œì²˜ ë¯¸ì…ë ¥)"}`;
            };
            const lines = [mk(1), mk(2), mk(3)].filter(Boolean);
            return lines.length ? lines.join("\n") : "- (ìë£Œê°€ ì•„ì§ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.)";
        };

        const buildOnePageSummary = (studentInfo, sd) => {
            const studentLine = [
                `í•™êµ ${norm(studentInfo.school) || "ë¯¸ì…ë ¥"}`,
                `í•™ë²ˆ ${norm(studentInfo.gradeClass) || "ë¯¸ì…ë ¥"}`,
                `ì´ë¦„ ${norm(studentInfo.name) || "ë¯¸ì…ë ¥"}`,
                `í¬ë§ì „ê³µ ${norm(studentInfo.major) || "ë¯¸ì…ë ¥"}`
            ].join(" | ");

            return `
[1í˜ì´ì§€ ìš”ì•½]

0) ê¸°ë³¸ ì •ë³´
- ${studentLine}

1) ì£¼ì œ ë° ì—°êµ¬ì§ˆë¬¸
- ì£¼ì œ: ${norm(sd.s1_topic) || "(ë¯¸ì…ë ¥)"}
- RQ: ${norm(sd.s1_question) || "(ë¯¸ì…ë ¥)"}
- ë²”ìœ„/ëŒ€ìƒ/ë³€ì¸: ${norm(sd.s1_scope) || "(ë¯¸ì…ë ¥)"}

2) í•µì‹¬ ê·¼ê±°(ìë£Œ)
${buildSourcesShort(sd)}
- ìë£Œì¡°ì‚¬ ì¢…í•©: ${norm(sd.s2_takeaway) || "(ë¯¸ì…ë ¥)"}

3) ë°©ë²•(ê³¼ì •)
- ë°©ë²• ìœ í˜•: ${norm(sd.s3_method_type) || "(ë¯¸ì…ë ¥)"}
- ë³€ì¸/ì§€í‘œ: ${norm(sd.s3_variables) || "(ë¯¸ì…ë ¥)"}
- ì ˆì°¨: ${norm(sd.s3_process) || "(ë¯¸ì…ë ¥)"}
- ë°ì´í„°/ë„êµ¬: ${norm(sd.s3_data_plan) || "(ë¯¸ì…ë ¥)"} / ${norm(sd.s3_tools) || "(ë¯¸ì…ë ¥)"}

4) ê²°ê³¼Â·ê²°ë¡ Â·í•œê³„Â·í›„ì†
- ê²°ê³¼: ${norm(sd.s4_findings) || "(ë¯¸ì…ë ¥)"}
- ê²°ë¡ : ${norm(sd.s4_conclusion) || "(ë¯¸ì…ë ¥)"}
- í•œê³„: ${norm(sd.s4_limits) || "(ë¯¸ì…ë ¥)"}
- í›„ì†: ${norm(sd.s4_next) || "(ë¯¸ì…ë ¥)"}
`.trim();
        };


        const TAB_ITEMS = [
            { id: 0, label: "ì •ë³´ ì…ë ¥" },
            { id: 1, label: "1ì°¨ì‹œ" },
            { id: 2, label: "2ì°¨ì‹œ" },
            { id: 3, label: "3ì°¨ì‹œ" },
            { id: 4, label: "4ì°¨ì‹œ" },

            { id: 5, label: "1í˜ì´ì§€ ìš”ì•½" },        // âœ… ì¶”ê°€
            { id: 6, label: "íƒêµ¬ë³´ê³ ì„œ ì™„ì„±" },

            { id: 11, label: "íƒêµ¬ ìë£Œ íƒìƒ‰" },
            { id: 14, label: "ì°¸ì¡°ì‚¬ì´íŠ¸" },
            { id: 12, label: "AI ì‚¬ìš© ìˆ˜ì¹™" },
            { id: 13, label: "íƒêµ¬ ë°©ë²• ê°€ì´ë“œ" },
        ];

        // âœ… ì¸ì‡„ì— í¬í•¨í•  íƒ­ idë§Œ ì§€ì •
        const PRINT_TAB_IDS = [1, 2, 3, 4, 5, 6];


        // íƒ­ë³„ ìƒ‰ìƒ(ì›í•˜ëŠ” ìƒ‰ìœ¼ë¡œ ë°”ê¿”ë„ ë¨)
        const TAB_STYLE = {
            // ì •ë³´ì…ë ¥
            0: {
                on: "bg-sky-600 text-white border-sky-600 shadow-lg",
                off: "bg-sky-50 text-sky-800 border-sky-200 hover:bg-sky-100"
            },

            // 1~4ì°¨ì‹œ (ê°ê° ë‹¤ë¥´ê²Œ)
            1: {
                on: "bg-indigo-600 text-white border-indigo-600 shadow-lg",
                off: "bg-indigo-50 text-indigo-900 border-indigo-200 hover:bg-indigo-100"
            },
            2: {
                on: "bg-emerald-600 text-white border-emerald-600 shadow-lg",
                off: "bg-emerald-50 text-emerald-900 border-emerald-200 hover:bg-emerald-100"
            },
            3: {
                on: "bg-rose-600 text-white border-rose-600 shadow-lg",
                off: "bg-rose-50 text-rose-900 border-rose-200 hover:bg-rose-100"
            },
            4: {
                on: "bg-amber-600 text-white border-amber-600 shadow-lg",
                off: "bg-amber-50 text-amber-900 border-amber-200 hover:bg-amber-100"
            },

            // 1í˜ì´ì§€ ìš”ì•½ / íƒêµ¬ë³´ê³ ì„œ ì™„ì„± (ì„œë¡œ ë‹¤ë¥´ê²Œ)
            5: {
                on: "bg-violet-600 text-white border-violet-600 shadow-lg",
                off: "bg-violet-50 text-violet-900 border-violet-200 hover:bg-violet-100"
            },
            6: {
                on: "bg-slate-900 text-white border-slate-900 shadow-lg",
                off: "bg-slate-50 text-slate-900 border-slate-300 hover:bg-slate-100"
            },

            // ë³´ì¡°ìë£Œ íƒ­(ë™ì¼ í†¤ìœ¼ë¡œ ë¬¶ê¸°)
            11: {
                on: "bg-teal-600 text-white border-teal-600 shadow-lg",
                off: "bg-teal-50 text-teal-900 border-teal-200 hover:bg-teal-100"
            },
            12: {
                on: "bg-teal-600 text-white border-teal-600 shadow-lg",
                off: "bg-teal-50 text-teal-900 border-teal-200 hover:bg-teal-100"
            },
            13: {
                on: "bg-teal-600 text-white border-teal-600 shadow-lg",
                off: "bg-teal-50 text-teal-900 border-teal-200 hover:bg-teal-100"
            },
            14: {
                on: "bg-teal-600 text-white border-teal-600 shadow-lg",
                off: "bg-teal-50 text-teal-900 border-teal-200 hover:bg-teal-100"
            },
        };


        /****************************************************************
         * 1) ê³µìš© UI ì»´í¬ë„ŒíŠ¸
         ****************************************************************/
        const Label = ({ children }) => (
            <div className="text-xs font-black uppercase tracking-[0.22em] text-slate-400">
                {children}
            </div>
        );

        const InputField = ({ label, name, value, onChange, placeholder }) => (
            <div className="space-y-4">
                <Label>{label}</Label>
                <input
                    name={name}
                    value={value}
                    onChange={onChange}
                    placeholder={placeholder}
                    className="w-full p-6 rounded-3xl bg-slate-50 font-black text-lg outline-none focus:ring-4 focus:ring-indigo-100 border border-slate-100"
                />
            </div>
        );

        const TextAreaField = ({
            label,
            name,
            value,
            onChange,
            placeholder,
            height = "h-40",
            bgColor = "bg-slate-50",
            textColor = "text-slate-900"
        }) => (
            <div className="space-y-4">
                <Label>{label}</Label>
                <textarea
                    name={name}
                    value={value}
                    onChange={onChange}
                    placeholder={placeholder}
                    className={`w-full ${height} ${bgColor} ${textColor} p-6 rounded-3xl font-bold text-base outline-none focus:ring-4 focus:ring-indigo-100 border border-slate-100 resize-none scrollbar-hide`}
                />
            </div>
        );

        const AiResultBox = ({ loading, result, onClose }) => {
            if (!loading && !result) return null;
            return (
                <div className="mb-8 bg-slate-900 text-white rounded-[40px] border border-white/10 shadow-2xl p-8 relative overflow-hidden">
                    <div className="absolute top-0 right-0 p-8 opacity-10">
                        <LucideIcon name="sparkles" className="w-20 h-20" />
                    </div>

                    <div className="flex items-start justify-between gap-6">
                        <div>
                            <div className="text-[10px] font-black uppercase tracking-[0.3em] text-slate-400">
                                AI Coach Output
                            </div>
                            <div className="text-lg font-black mt-2">
                                {loading ? "ìƒì„± ì¤‘ì…ë‹ˆë‹¤..." : "ê²°ê³¼ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}
                            </div>
                        </div>

                        <button
                            type="button"
                            onClick={onClose}
                            className="bg-white/10 hover:bg-white/15 px-4 py-2 rounded-2xl font-black text-xs border border-white/10"
                        >
                            ë‹«ê¸°
                        </button>
                    </div>

                    <div className="mt-6 whitespace-pre-wrap text-sm leading-relaxed font-bold text-slate-100">
                        {loading ? "ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”." : result}
                    </div>
                </div>
            );
        };

        const Header = ({ serverStatus, handleSaveAll, handlePrint, handleLogout }) => (
            <header className="px-4 md:px-10 py-6 bg-white border-b border-slate-200 sticky top-0 z-40">
                <div className="max-w-6xl mx-auto flex items-center justify-between gap-6 flex-wrap">
                    <div className="flex items-center gap-4">
                        <div className="bg-slate-900 text-white rounded-3xl px-5 py-3 shadow-lg">
                            <div className="text-[10px] font-black uppercase tracking-[0.32em] text-slate-400">Workbook</div>
                            <div className="text-sm font-black mt-1">ì‹¬í™” íƒêµ¬ ê³¼ì • í†µí•© ì›Œí¬ë¶</div>
                        </div>

                        <div className="text-xs font-black text-slate-500">
                            {serverStatus || "ìƒíƒœ: ì¤€ë¹„ë¨"}
                        </div>
                    </div>

                    <div className="flex items-center gap-3">
                        <button
                            type="button"
                            onClick={handleSaveAll}
                            className="btn-ai-glow text-white px-6 py-3 rounded-3xl text-xs font-black shadow-xl active:scale-95 flex items-center gap-2"
                        >
                            <LucideIcon name="save" className="w-4 h-4 text-amber-300" />
                            ì „ì²´ ì €ì¥
                        </button>

                        <button
                            type="button"
                            onClick={handlePrint}
                            className="bg-white border border-slate-200 hover:border-slate-400 text-slate-900 px-6 py-3 rounded-3xl text-xs font-black shadow-sm active:scale-95 flex items-center gap-2"
                        >
                            <LucideIcon name="printer" className="w-4 h-4" />
                            ì¸ì‡„/PDF
                        </button>


                        <button
                            type="button"
                            onClick={handleLogout}
                            className="bg-slate-100 hover:bg-slate-200 text-slate-900 px-6 py-3 rounded-3xl text-xs font-black shadow-sm active:scale-95"
                        >
                            ë¡œê·¸ì•„ì›ƒ
                        </button>
                    </div>
                </div>
            </header>
        );

        const TabNavigation = ({ activeTab, setActiveTab, setAiResult }) => (
            <nav className="px-4 md:px-10 py-5 bg-slate-50 border-b border-slate-200">
                <div className="max-w-6xl mx-auto flex gap-2 overflow-x-auto scrollbar-hide">
                    {TAB_ITEMS.map((t) => {
                        const isOn = activeTab === t.id;

                        // íƒ­ë³„ ìŠ¤íƒ€ì¼(ì—†ìœ¼ë©´ ê¸°ë³¸ê°’)
                        const st = TAB_STYLE?.[t.id] || {
                            on: "bg-slate-900 text-white border-slate-900 shadow-lg",
                            off: "bg-white text-slate-600 border-slate-200 hover:border-indigo-200 hover:text-slate-900",
                        };

                        // ìµœì¢… className ë¬¸ìì—´
                        const cls =
                            "px-5 py-3 rounded-3xl text-xs font-black border transition-all shrink-0 " +
                            (isOn ? st.on : st.off);

                        return (
                            <button
                                key={t.id}
                                type="button"
                                onClick={() => {
                                    setAiResult("");
                                    setActiveTab(t.id);
                                }}
                                className={cls}
                            >
                                {t.label}
                            </button>
                        );
                    })}
                </div>
            </nav>
        );


        const LoginScreen = ({ personalCode, setPersonalCode, handleLogin, serverStatus }) => (
            <div className="fixed inset-0 bg-slate-900/95 flex items-center justify-center z-50">
                <div className="w-full max-w-xl p-8 md:p-12">
                    <div className="bg-white rounded-[56px] p-10 md:p-14 shadow-2xl border border-white/10">
                        <div className="flex items-center justify-between flex-wrap gap-4 mb-10">
                            <div>
                                <div className="text-[10px] font-black uppercase tracking-[0.32em] text-slate-400">Access</div>
                                <div className="text-3xl font-black text-slate-900 tracking-tighter mt-2">ê°œì¸ ì½”ë“œ ë¡œê·¸ì¸</div>
                                <div className="text-xs font-bold text-slate-500 mt-2">ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ì €ì¥í•©ë‹ˆë‹¤.</div>
                            </div>
                            <div className="bg-slate-900 text-white rounded-[28px] px-6 py-4 shadow-xl border border-white/5">
                                <div className="text-[10px] font-black uppercase tracking-[0.3em] text-slate-400">Status</div>
                                <div className="text-xs font-black mt-1">{serverStatus || "ëŒ€ê¸° ì¤‘"}</div>
                            </div>
                        </div>

                        <div className="space-y-4">
                            <Label>Personal Code</Label>
                            <input
                                value={personalCode}
                                onChange={(e) => setPersonalCode(e.target.value)}
                                placeholder="ì˜ˆ: ABCD-1234"
                                className="w-full p-6 rounded-3xl bg-slate-50 font-black text-lg outline-none focus:ring-4 focus:ring-indigo-100 border border-slate-100"
                            />
                            <button
                                type="button"
                                onClick={handleLogin}
                                className="btn-ai-glow w-full text-white px-8 py-5 rounded-3xl text-sm font-black shadow-2xl active:scale-95 flex items-center justify-center gap-2"
                            >
                                <LucideIcon name="log-in" className="w-5 h-5 text-amber-300" />
                                ë¡œê·¸ì¸
                            </button>
                            <div className="text-[11px] text-slate-500 font-bold mt-2">
                                â€» ì„œë²„ URL/ê¶Œí•œ ì„¤ì •ì´ ì˜¬ë°”ë¥´ì§€ ì•Šìœ¼ë©´ ë¡œë“œ/ì €ì¥ì´ ì‹¤íŒ¨í•©ë‹ˆë‹¤.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        );

        /****************************************************************
         * 2) (A) ë°ì´í„°: 4ëŒ€ ì „ëµ ëª¨ë“ˆ
         ****************************************************************/
        const STRATEGY_DATA = {
            papers: {
                key: "papers",
                color: "blue",
                label: "í•™ìˆ ì  ì ‘ê·¼",
                titleCard: "1. ë…¼ë¬¸/í•™ìˆ ì§€",
                descCard: "RISS, DBpiaì—ì„œ ê²€ì¦ëœ ì—°êµ¬ ë³€í˜•í•˜ê¸°",
                title: "ë…¼ë¬¸ í”Œë«í¼ë³„ ê²€ìƒ‰ ì „ëµ",
                subTabs: ["dbpia", "riss", "google"],
                content: {
                    dbpia: {
                        name: "DBpia (ë””ë¹„í”¼ì•„)",
                        badge: "êµ­ë‚´ ë…¼ë¬¸",
                        steps: [
                            { title: "1. ì£¼ì œë¶„ë¥˜ íƒ­ í™œìš©", desc: "ë©”ì¸ ìƒë‹¨ [ì£¼ì œë¶„ë¥˜] í´ë¦­ â†’ ê´€ì‹¬ ê³„ì—´(ì‚¬íšŒê³¼í•™, ê³µí•™ ë“±) ì„ íƒí•©ë‹ˆë‹¤." },
                            { title: "2. ì´ìš©ìˆ˜ + 1ë…„ í•„í„°ë§", desc: "ê²€ìƒ‰ í•„í„°ì—ì„œ ì •ë ¬ ê¸°ì¤€ì„ [ì´ìš©ìˆ˜], ê¸°ê°„ì„ [ìµœê·¼ 1ë…„]ìœ¼ë¡œ ì„¤ì •í•´ íŠ¸ë Œë“œë¥¼ íŒŒì•…í•©ë‹ˆë‹¤." },
                            { title: "3. Top 10 í›‘ì–´ë³´ê¸°", desc: "ê°€ì¥ ë§ì´ ì½íŒ ë…¼ë¬¸ 10ê°œì˜ ì œëª©ì„ ë³´ê³  í•µì‹¬ í‚¤ì›Œë“œë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤." },
                            { title: "4. ë³€í˜•í•˜ì—¬ ì ìš©", desc: "ëŒ€ìƒ(ëŒ€í•™ìƒâ†’ê³ ë“±í•™ìƒ), ì§€ì—­(ì„œìš¸â†’ìš°ë¦¬ë™ë„¤) ë“± í•œ ìš”ì†Œë§Œ ë°”ê¿” ë‚´ ì£¼ì œë¡œ ë³€í˜•í•©ë‹ˆë‹¤." },
                        ],
                    },
                    riss: {
                        name: "RISS (í•™ìœ„ë…¼ë¬¸)",
                        badge: "ë°©ë²•ë¡  ë²¤ì¹˜ë§ˆí‚¹",
                        steps: [
                            { title: "1. í•™ìœ„ë…¼ë¬¸ íƒ­ í´ë¦­", desc: "í‚¤ì›Œë“œ ê²€ìƒ‰ í›„ [í•™ìœ„ë…¼ë¬¸] íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤. ì„/ë°•ì‚¬ ë…¼ë¬¸ì€ ì—°êµ¬ ê³¼ì •ì´ ìƒì„¸í•´ ë”°ë¼í•˜ê¸° ì¢‹ìŠµë‹ˆë‹¤." },
                            { title: "2. êµ­ë‚´ì„ì‚¬ í•„í„°", desc: "ë‚œì´ë„ê°€ ë†’ì€ ë°•ì‚¬/í•´ì™¸ ë…¼ë¬¸ë³´ë‹¤ [êµ­ë‚´ ì„ì‚¬] ë…¼ë¬¸ì„ ìš°ì„  íƒìƒ‰í•©ë‹ˆë‹¤." },
                            { title: "3. ëª©ì°¨ í™•ì¸", desc: "ëª©ì°¨ë¥¼ ë³´ê³  ì„¤ë¬¸ ë¬¸í•­/ì‹¤í—˜ ì„¤ê³„ê°€ ìˆ˜í–‰ ê°€ëŠ¥í•œ ìˆ˜ì¤€ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤." },
                            { title: "4. ì œì–¸ ì°¾ê¸°", desc: "ê²°ë¡ ì˜ [ì œì–¸]ì—ì„œ ì—°êµ¬ìê°€ ë‚¨ê¸´ í›„ì† ê³¼ì œë¥¼ ë‚´ íƒêµ¬ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤." },
                        ],
                    },
                    google: {
                        name: "Google Scholar",
                        badge: "ì‹¬í™”/í™•ì¥",
                        steps: [
                            { title: "1. 2024ë…„ ì´í›„ ì„¤ì •", desc: "ì¢Œì¸¡ ì‚¬ì´ë“œë°”ì—ì„œ [2024ë…„ ì´í›„]ë¡œ ì œí•œí•´ ìµœì‹  íŠ¸ë Œë“œë¥¼ íŒŒì•…í•©ë‹ˆë‹¤." },
                            { title: "2. ì¸ìš© ì¶”ì ", desc: "[00íšŒ ì¸ìš©ë¨]ì„ í´ë¦­í•´ ë” ìµœì‹ /ì‹¬í™”ëœ í›„ì† ì—°êµ¬ë¥¼ ì°¾ìŠµë‹ˆë‹¤." },
                            { title: "3. Related Articles", desc: "ê´€ì‹¬ ë…¼ë¬¸ í•˜ë‹¨ì˜ [ê´€ë ¨ í•™ìˆ ìë£Œ] ë²„íŠ¼ì„ ëˆŒëŸ¬ ìœ ì‚¬ ì£¼ì œ ë…¼ë¬¸ ë¬¶ìŒì„ í™•ì¸í•©ë‹ˆë‹¤." },
                            { title: "4. Review ë…¼ë¬¸ ê²€ìƒ‰", desc: "ê²€ìƒ‰ì–´ + â€œreviewâ€ë¡œ ë¶„ì•¼ ì „ì²´ íë¦„ì„ ìš”ì•½í•œ ë…¼ë¬¸ì„ ì°¾ìŠµë‹ˆë‹¤." },
                        ],
                    },
                },
                caseStudy: {
                    before: "RISS ì„ì‚¬ ë…¼ë¬¸: â€˜ìˆ˜ë©´ ì‹œê°„ì´ ê³ ë“±í•™ìƒì˜ í•™ìŠµ ëª°ì…ë„ì— ë¯¸ì¹˜ëŠ” ì˜í–¥â€™",
                    after: "ë‚˜ì˜ íƒêµ¬: â€˜ì‹œí—˜ ê¸°ê°„ ê³ ì¹´í˜ì¸ ìŒë£Œ ì„­ì·¨ëŸ‰ì´ ìˆ˜ë©´ì˜ ì§ˆê³¼ 1êµì‹œ ì§‘ì¤‘ë ¥ì— ë¯¸ì¹˜ëŠ” ìƒê´€ê´€ê³„â€™",
                    points: [
                        "ë³€ìˆ˜ êµ¬ì²´í™”: ìˆ˜ë©´ ì‹œê°„ â†’ ì¹´í˜ì¸ ì„­ì·¨",
                        "ìƒí™© êµ¬ì²´í™”: í‰ì†Œ â†’ ì‹œí—˜ ê¸°ê°„",
                        "ì¸¡ì • ê°€ëŠ¥ì„±: ì§‘ì¤‘ë ¥ â†’ ìê°€ì§„ë‹¨í‘œ/ì¡°ëŠ” íšŸìˆ˜",
                    ],
                },
            },

            books: {
                key: "books",
                color: "amber",
                label: "ë„ì„œ",
                titleCard: "2. ë„ì„œ/ë…ì„œ",
                descCard: "êµê³¼ ê°œë…ê³¼ ì‹¬í™” ë„ì„œ ì—°ê²°í•˜ê¸°",
                title: "ë„ì„œ ì‹¬í™” íƒêµ¬ ì „ëµ",
                subTabs: ["selection", "reading"],
                content: {
                    selection: {
                        name: "1. ì‹¤íŒ¨ ì—†ëŠ” ì±… ê³ ë¥´ê¸°",
                        badge: "ì„ ì • ê¿€íŒ",
                        steps: [
                            { title: "1. êµê³¼ì„œ ì£¼ì„ í•´í‚¹", desc: "êµê³¼ì„œ â€˜ë” ì½ì–´ë³´ê¸°â€™/ê°ì£¼ì— ì–¸ê¸‰ëœ ì±…ì„ ìš°ì„  ê²€í† í•©ë‹ˆë‹¤." },
                            { title: "2. ëŒ€í•™/í•™ê³¼ ì¶”ì²œë„ì„œ", desc: "í¬ë§ ëŒ€í•™ í•™ê³¼ì˜ ê¶Œì¥ ë„ì„œ ëª©ë¡ í‚¤ì›Œë“œë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤." },
                            { title: "3. ì„œë¬¸ 3ë¶„ ì»·", desc: "ë„ì„œì˜ ì„œë¬¸ì„ ì½ê³  ì§‘í•„ ì˜ë„ê°€ í¥ë¯¸ë¡­ì§€ ì•Šìœ¼ë©´ ê³¼ê°íˆ êµì²´í•©ë‹ˆë‹¤." },
                            { title: "4. ê³¼í•™ ì»¤ë®¤ë‹ˆì¼€ì´í„°", desc: "ì „ê³µì„œê°€ ì–´ë µë‹¤ë©´ í•´ë‹¹ ë¶„ì•¼ ì „ë¬¸ ê¸°ì/ì»¤ë®¤ë‹ˆì¼€ì´í„°ì˜ ëŒ€ì¤‘ì„œë¥¼ ë¨¼ì € ì½ìŠµë‹ˆë‹¤." },
                        ],
                    },
                    reading: {
                        name: "2. ì‹œê°„ ì ˆì•½ ë°œì·Œë…",
                        badge: "ì½ê¸° ê¸°ìˆ ",
                        steps: [
                            { title: "1. ìƒ‰ì¸(Index) í™œìš©", desc: "ì±… ë’¤ â€˜ìƒ‰ì¸â€™ì—ì„œ í‚¤ì›Œë“œë¥¼ ì°¾ì•„ í•´ë‹¹ í˜ì´ì§€ë§Œ ì§‘ì¤‘ì ìœ¼ë¡œ ì½ìŠµë‹ˆë‹¤." },
                            { title: "2. ì±•í„° ì„œë¡ /ê²°ë¡  í™œìš©", desc: "ì±•í„° ì²« ë¬¸ë‹¨(ë¬¸ì œ ì œê¸°)Â·ë§ˆì§€ë§‰ ë¬¸ë‹¨(ê²°ë¡ )ì„ ìš°ì„  í™•ì¸í•˜ê³  í•„ìš” ì‹œ í™•ì¥í•˜ì—¬ ì½ìŠµë‹ˆë‹¤." },
                            { title: "3. ëª©ì°¨ ë§ˆì¸ë“œë§µ", desc: "ëª©ì°¨ë¡œ ë…¼ë¦¬ êµ¬ì¡°ë¥¼ ë¨¼ì € ê·¸ë¦¬ê³ , ë‚´ ì£¼ì œì— í•„ìš”í•œ ë¶€ë¶„ì„ ê³¨ë¼ ì½ìŠµë‹ˆë‹¤." },
                            { title: "4. ì°¸ê³ ë¬¸í—Œ ê¼¬ë¦¬ ë¬¼ê¸°", desc: "ì°¸ê³ ë¬¸í—Œì˜ ë…¼ë¬¸ì„ ì‹¤ì œë¡œ ì°¾ì•„ ì½ìœ¼ë©´ ì‹¬í™” ì—­ëŸ‰ ì–´í•„ì— íš¨ê³¼ì ì…ë‹ˆë‹¤." },
                        ],
                    },
                },
                caseStudy: {
                    before: "í†µí•©ì‚¬íšŒ ìˆ˜ì—… ì¤‘ â€˜ì  íŠ¸ë¦¬í”¼ì¼€ì´ì…˜â€™ ê°œë… í•™ìŠµ",
                    after: "ë„ì„œ â€˜ê³¨ëª©ì˜ ì „ìŸâ€™ ë°œì·Œë… í›„, ìš°ë¦¬ ë™ë„¤ ìƒê¶Œì˜ ì„ëŒ€ë£Œ ìƒìŠ¹ê³¼ í”„ëœì°¨ì´ì¦ˆ ë¹„ìœ¨ ë³€í™” ì¡°ì‚¬",
                    points: [
                        "êµê³¼ ê°œë… ì‹¬í™”",
                        "ìƒ‰ì¸ì„ í†µí•œ í‚¤ì›Œë“œ ì¤‘ì‹¬ ë…ì„œ",
                        "ì´ë¡ ì„ í˜„ì‹¤(ìš°ë¦¬ ë™ë„¤)ì— ì ìš©",
                    ],
                },
            },

            news: {
                key: "news",
                color: "emerald",
                label: "ë‰´ìŠ¤/ë¯¸ë””ì–´",
                titleCard: "3. ë‰´ìŠ¤/ë¯¸ë””ì–´",
                descCard: "ë¹…ì¹´ì¸ì¦ˆ, ê³¼í•™ì¡ì§€ íŠ¸ë Œë“œ ë¶„ì„",
                title: "ë‰´ìŠ¤/ë¯¸ë””ì–´ í™œìš© ì „ëµ",
                subTabs: ["sources", "topicizing"],
                content: {
                    sources: {
                        name: "1. ì–´ë””ì„œ ì°¾ì„ê¹Œ?",
                        badge: "ì ‘ì† ê²½ë¡œ",
                        steps: [
                            { title: "ë¹…ì¹´ì¸ì¦ˆ (BigKinds)", desc: "í•œêµ­ì–¸ë¡ ì§„í¥ì¬ë‹¨ì´ ìš´ì˜í•˜ëŠ” ë‰´ìŠ¤ ë¹…ë°ì´í„° ë¶„ì„ ì‚¬ì´íŠ¸ì…ë‹ˆë‹¤. í‚¤ì›Œë“œ ê´€ê³„ë„ë¥¼ í™•ì¸í•´ ì£¼ì œ í™•ì¥ì— í™œìš©í•©ë‹ˆë‹¤." },
                            { title: "ì‚¬ì´ì–¸ìŠ¤íƒ€ì„ì¦ˆ / ë™ì•„ì‚¬ì´ì–¸ìŠ¤", desc: "ì „ë¬¸ ê³¼í•™/ê³µí•™ ì´ìŠˆë¡œ ìµœì‹  ê¸°ìˆ  ë™í–¥ì„ íŒŒì•…í•©ë‹ˆë‹¤." },
                            { title: "êµ­íšŒë„ì„œê´€ [í˜„ì•ˆê³¼ ê³¼ì œ]", desc: "ì‚¬íšŒ/ì •ì±… ì´ìŠˆë¥¼ ë‹¤ë£¹ë‹ˆë‹¤. ì „ë¬¸ê°€ë“¤ì´ í˜„ì¬ ì´ìŠˆë¥¼ 4ìª½ ë‚´ì™¸ë¡œ ìš”ì•½í•œ ë³´ê³ ì„œë¥¼ ì œê³µí•©ë‹ˆë‹¤." },
                            { title: "TED Talks / ì„¸ë°”ì‹œ", desc: "ì˜ìƒ ë§¤ì²´. ìµœì‹  ì•„ì´ë””ì–´ë¥¼ 15ë¶„ ë‚´ì™¸ë¡œ ì ‘í•  ìˆ˜ ìˆì–´ ë™ê¸° ìœ ë°œì— ì¢‹ìŠµë‹ˆë‹¤." },
                        ],
                    },
                    topicizing: {
                        name: "2. ì£¼ì œë¡œ ë§Œë“¤ê¸°",
                        badge: "ì—°ê²° ê¸°ìˆ ",
                        steps: [
                            { title: "1. í—¤ë“œë¼ì¸ ì„œí•‘", desc: "â€˜ë…¼ë€/ìœ„ê¸°/ê¸‰ì¦/ì‹ ê¸°ìˆ â€™ í‚¤ì›Œë“œë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ê¸°ì‚¬ í›„ë³´ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤." },
                            { title: "2. Global to Local", desc: "ì „ ì§€êµ¬ì  ë¬¸ì œ(ê¸°í›„ë³€í™”)ë¥¼ ìš°ë¦¬ ì§€ì—­(í•™êµ ê¸‰ì‹ì‹¤ íƒ„ì†Œë°œìêµ­) ë¬¸ì œë¡œ ì¶•ì†Œí•©ë‹ˆë‹¤." },
                            { title: "3. íŒ©íŠ¸ ì²´í¬ & ë°˜ë¡ ", desc: "ê¸°ì‚¬ì˜ ì£¼ì¥ì´ ë§ëŠ”ì§€ ë°ì´í„°ë¥¼ ì°¾ì•„ ê²€ì¦í•˜ê±°ë‚˜, ë°˜ëŒ€ ì˜ê²¬ì„ íƒêµ¬ ì£¼ì œë¡œ ì‚¼ìŠµë‹ˆë‹¤." },
                            { title: "4. í•´ê²°ì±… ì œì•ˆí˜•", desc: "í˜„ìƒ ì¡°ì‚¬ì—ì„œ ëë‚´ì§€ ë§ê³ , 'ìš°ë¦¬ëŠ” ë¬´ì—‡ì„ í•  ìˆ˜ ìˆëŠ”ê°€?' ì œì•ˆìœ¼ë¡œ ê²°ë¡ ì„ ë§Œë“­ë‹ˆë‹¤." },
                        ],
                    },
                },
                caseStudy: {
                    before: "ë¹…ì¹´ì¸ì¦ˆ: â€˜ì „ë™ í‚¥ë³´ë“œ ì‚¬ê³  ê¸‰ì¦â€™ í‚¤ì›Œë“œ ê´€ê³„ë„ í™•ì¸",
                    after: "ìš°ë¦¬ í•™êµ í•™ìƒë“¤ì˜ í—¬ë©§ ì°©ìš© ì‹¤íƒœ ì¡°ì‚¬ ë° ì¸ì‹ ê°œì„  ë„›ì§€(Nudge) ë””ìì¸ ì œì•ˆ",
                    points: [
                        "ë¹…ë°ì´í„°ë¡œ ì´ìŠˆ íŒŒì•…",
                        "í•™êµ ë¬¸ì œë¡œ ì¶•ì†Œ(Localizing)",
                        "í•´ê²°ì±…(ë””ìì¸) ì œì‹œ",
                    ],
                },
            },

            life: {
                key: "life",
                color: "violet",
                label: "ìƒí™œ/ë°ì´í„°",
                titleCard: "4. ìƒí™œ ì† ë¶ˆí¸í•¨",
                descCard: "ì¼ìƒ ê´€ì°°ê³¼ ê³µê³µë°ì´í„° í™œìš©",
                title: "ìƒí™œ ì† ê´€ì°° ë° ë°ì´í„° í™œìš©",
                subTabs: ["observation", "publicdata"],
                content: {
                    observation: {
                        name: "1. ë¶ˆí¸í•¨ì´ ê³§ ì£¼ì œ",
                        badge: "í•™êµ ìƒí™œ",
                        steps: [
                            { title: "1. â€˜ì™œ?â€™ë¼ê³  ë”´ì§€ ê±¸ê¸°", desc: "í•™êµ ìƒí™œ ì¤‘ ë¶ˆí¸í•˜ê±°ë‚˜ ë¹„íš¨ìœ¨ì ì¸ ê²ƒì„ ì°¾ìŠµë‹ˆë‹¤. (ì˜ˆ: ê¸‰ì‹ ì¤„ì€ ì™œ í•­ìƒ 2í•™ë…„ ìª½ì´ ëŠë¦´ê¹Œ?)" },
                            { title: "2. ê´€ì°° ì¼ì§€ ì“°ê¸°", desc: "ì¼ì£¼ì¼ê°„ ë¶ˆí¸í•œ í˜„ìƒì„ ë°ì´í„°ë¡œ ê¸°ë¡í•©ë‹ˆë‹¤. (ì˜ˆ: ìš”ì¼ë³„ ê¸‰ì‹ ë©”ë‰´ì™€ ì”ë°˜ëŸ‰ ê´€ê³„)" },
                            { title: "3. êµê³¼ ê°œë… ì•ˆê²½ ì“°ê¸°", desc: "í˜„ìƒì„ êµê³¼ì„œ ê°œë…ìœ¼ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤. (ëŒ€ê¸°í–‰ë ¬/í™˜ê²½/í™”í•™ ë“±)" },
                            { title: "4. ì‹¤í—˜/ì¡°ì‚¬ë¡œ ì¦ëª…", desc: "ë³€ì¸ì„ í†µì œí•´ ì‹¤í—˜í•˜ê±°ë‚˜ ì„¤ë¬¸ì¡°ì‚¬ë¡œ ê°€ì„¤ì´ ë§ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤." },
                        ],
                    },
                    publicdata: {
                        name: "2. ê³µê³µë°ì´í„° í™œìš©",
                        badge: "ë°ì´í„° ë¶„ì„",
                        steps: [
                            { title: "1. ê³µê³µë°ì´í„°í¬í„¸ / KOSIS", desc: "ì„¤ë¬¸ ì—†ì´ë„ ì–‘ì§ˆì˜ ë°ì´í„°ë¥¼ í™•ë³´í•  ìˆ˜ ìˆëŠ” êµ­ê°€ í†µê³„Â·ê³µê³µë°ì´í„°ë¥¼ í™œìš©í•©ë‹ˆë‹¤." },
                            { title: "2. ìƒê´€ê´€ê³„ ì°¾ê¸°", desc: "ê´€ë ¨ ì—†ì–´ ë³´ì´ëŠ” ë‘ ë°ì´í„°ë¥¼ ì—°ê²°í•´ ìƒˆë¡œìš´ ê°€ì„¤ì„ ì„¸ì›ë‹ˆë‹¤. (ì˜ˆ: ë¯¸ì„¸ë¨¼ì§€ì™€ ë„ì„œê´€ ëŒ€ì¶œ)" },
                            { title: "3. ì—‘ì…€/íŒŒì´ì¬ ë¶„ì„", desc: "CSVë¥¼ ì‹œê°í™”Â·ë¶„ì„í•˜ë©´ ìˆ˜í–‰ ê·¼ê±°ê°€ ë©ë‹ˆë‹¤." },
                            { title: "4. ì§€ì—­ ë¬¸ì œ í•´ê²°", desc: "ì§€ì—­ì˜ ë¯¼ì›/í†µê³„ ë°ì´í„°ë¥¼ ë¶„ì„í•´ ê°€ì¥ ì‹œê¸‰í•œ ê°œì„ ì ì„ ì œì•ˆí•©ë‹ˆë‹¤." },
                        ],
                    },
                },
                caseStudy: {
                    before: "ê´€ì°°: â€˜ë¹„ ì˜¤ëŠ” ë‚ ì€ ì§€ê°ìƒì´ ë§ì€ ê²ƒ ê°™ì•„.â€™",
                    after: "ê¸°ìƒ ë°ì´í„°ì™€ í•™êµ ì§€ê° í†µê³„ì˜ ìƒê´€ê´€ê³„ ë¶„ì„ ë° ë¹„ ì˜¤ëŠ” ë‚  êµí†µ ì²´ì¦ ì‹œë®¬ë ˆì´ì…˜",
                    points: [
                        "ì¼ìƒì˜ í˜¸ê¸°ì‹¬",
                        "ê³µê³µë°ì´í„° í™œìš©",
                        "í†µê³„ì  ë¶„ì„ ì—­ëŸ‰ ì–´í•„",
                    ],
                },
            },
        };

        const SITE_DATA = [
            {
                id: "literature",
                category: "1. ìš°ìˆ˜ ì„ í–‰ì—°êµ¬ ë° ìµœì‹  ë™í–¥ (ë…¼ë¬¸)",
                emoji: "ğŸ“š",
                color: "blue",
                desc: "íƒêµ¬ì˜ ì‹œì‘ì€ ê¸°ì¡´ ì—°êµ¬ ì¡°ì‚¬ì…ë‹ˆë‹¤. ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” í•™ìˆ  ê²€ìƒ‰ ì—”ì§„ì…ë‹ˆë‹¤.",
                sites: [
                    { name: "DBPia", url: "https://www.dbpia.co.kr", tag: "êµ­ë‚´ë…¼ë¬¸", desc: "ì£¼ì œë³„ ë¶„ë¥˜ê°€ ì˜ ë˜ì–´ ìˆì–´ íƒìƒ‰ì´ ì‰¬ìš´ í•™ìˆ ì§€ ì‚¬ì´íŠ¸" },
                    { name: "RISS (í•™ìˆ ì—°êµ¬ì •ë³´)", url: "https://www.riss.kr", tag: "í•™ìœ„ë…¼ë¬¸", desc: "êµ­ë‚´ ì„/ë°•ì‚¬ í•™ìœ„ë…¼ë¬¸ ë¬´ë£Œ ì—´ëŒ. ì—°êµ¬ ë°©ë²• ë²¤ì¹˜ë§ˆí‚¹ìš©" },
                    { name: "SCIENCEON", url: "https://scienceon.kisti.re.kr", tag: "ê³¼í•™ê¸°ìˆ ", desc: "ë…¼ë¬¸, íŠ¹í—ˆ, ë³´ê³ ì„œë¥¼ í•œ ë²ˆì— í†µí•© ê²€ìƒ‰ (KISTI ìš´ì˜)" },
                    { name: "Google Scholar", url: "https://scholar.google.co.kr", tag: "í•´ì™¸ë…¼ë¬¸", desc: "ì „ ì„¸ê³„ ë…¼ë¬¸ ê²€ìƒ‰ ë° ì¸ìš© íšŸìˆ˜ í™•ì¸" },
                    { name: "KISS (í•œêµ­í•™ìˆ ì •ë³´)", url: "https://kiss.kstudy.com", tag: "ì¸ë¬¸ì‚¬íšŒ", desc: "ì¸ë¬¸í•™, ì‚¬íšŒê³¼í•™ ë¶„ì•¼ì˜ ë°©ëŒ€í•œ ë…¼ë¬¸ ë°ì´í„°ë² ì´ìŠ¤" },
                    { name: "êµ­íšŒë„ì„œê´€", url: "https://www.nanet.go.kr", tag: "ì •ì±…/ë²•ë¥ ", desc: "ì‚¬íšŒ ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ì •ì±… ìë£Œ ë° íŒ©íŠ¸ë¶ ê²€ìƒ‰" }
                ]
            },
            {
                id: "data",
                category: "2. êµ­ê°€ ê³µê³µìë£Œ ë° í†µê³„ (ë°ì´í„°)",
                emoji: "ğŸ“Š",
                color: "emerald",
                desc: "ë‡Œí”¼ì…œ ë§ê³  ì˜¤í”¼ì…œ. ë³´ê³ ì„œì˜ ì‹ ë¢°ë„ë¥¼ ë†’ì—¬ì¤„ ê³µì‹ ë°ì´í„°ì…ë‹ˆë‹¤.",
                sites: [
                    { name: "êµ­ê°€í†µê³„í¬í„¸ (KOSIS)", url: "https://kosis.kr", tag: "ê³µì‹í†µê³„", desc: "ëŒ€í•œë¯¼êµ­ ì¸êµ¬, ë¬¼ê°€, ê³ ìš© ë“± ëª¨ë“  ê³µì‹ í†µê³„ì˜ ê¸°ì¤€" },
                    { name: "ê³µê³µë°ì´í„°í¬í„¸", url: "https://www.data.go.kr", tag: "Raw Data", desc: "ë‚ ì”¨, êµí†µ, í™˜ê²½ ë“± ê°€ê³µë˜ì§€ ì•Šì€ CSV ë°ì´í„° ì œê³µ" },
                    { name: "ê¸°ìƒìë£Œê°œë°©í¬í„¸", url: "https://data.kma.go.kr", tag: "ë‚ ì”¨/ê¸°í›„", desc: "ê³¼ê±° 100ë…„ì¹˜ ë‚ ì”¨, ê¸°í›„ ë³€í™” ë°ì´í„° ë‹¤ìš´ë¡œë“œ" },
                    { name: "SGIS (í†µê³„ì§€ë¦¬)", url: "https://sgis.kostat.go.kr", tag: "ì§€ë„/ì‹œê°í™”", desc: "ì§€ë„ ìœ„ì— ì¸êµ¬/ìƒê¶Œ í†µê³„ë¥¼ ì…í˜€ ë³´ì—¬ì£¼ëŠ” ì‹œê°í™” ë„êµ¬" },
                    { name: "e-ë‚˜ë¼ì§€í‘œ", url: "https://www.index.go.kr", tag: "ì§€í‘œ", desc: "ë³µì¡í•œ í†µê³„ë¥¼ ë³´ê¸° ì‰¬ìš´ ê·¸ë˜í”„ë¡œ ìš”ì•½ ì œê³µ" }
                ]
            },
            {
                id: "science",
                category: "3. ê³¼í•™ ì¼ë°˜ ì•„ì´ë””ì–´ (Inspiration)",
                emoji: "ğŸ”­",
                color: "amber",
                desc: "ê³¼í•™ì  í˜¸ê¸°ì‹¬ì´ í•„ìš”í•  ë•Œ ë°©ë¬¸í•´ë³´ì„¸ìš”.",
                sites: [
                    { name: "ì‚¬ì´ì–¸ìŠ¤íƒ€ì„ì¦ˆ", url: "https://www.sciencetimes.co.kr", tag: "ê³¼í•™ë‰´ìŠ¤", desc: "ìµœì‹  ê³¼í•™ ê¸°ìˆ  ë™í–¥ê³¼ ì´ìŠˆë¥¼ ë‹¤ë£¨ëŠ” ì „ë¬¸ ë‰´ìŠ¤" },
                    { name: "êµ­ë¦½ì¤‘ì•™ê³¼í•™ê´€", url: "https://www.science.go.kr", tag: "ì „ëŒíšŒ", desc: "ì „êµ­ê³¼í•™ì „ëŒíšŒ ìˆ˜ìƒì‘ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í†µí•´ ìˆ˜ì¤€ íŒŒì•…" },
                    { name: "ì¹´ì˜¤ìŠ¤ì¬ë‹¨", url: "https://ikaos.org", tag: "ê³ ê¸‰ê°•ì—°", desc: "ê¸°ì´ˆ ê³¼í•™ ë¶„ì•¼ ì„í•™ë“¤ì˜ ê¹Šì´ ìˆëŠ” ê°•ì—° ì˜ìƒ" },
                    { name: "ì‚¬ì´ì–¸ìŠ¤ì˜¬", url: "https://www.scienceall.com", tag: "ê³¼í•™ë¬¸í™”", desc: "ê³¼í•™ ìš©ì–´ ì‚¬ì „, ì¹´ë“œë‰´ìŠ¤ ë“± í¥ë¯¸ë¡œìš´ ì½˜í…ì¸ " },
                    { name: "ë™ì•„ì‚¬ì´ì–¸ìŠ¤", url: "https://www.dongascience.com", tag: "ê³¼í•™ë§¤ê±°ì§„", desc: "ì²­ì†Œë…„ ëˆˆë†’ì´ì˜ ìµœì‹  ê³¼í•™ ê¸°ì‚¬" }
                ]
            },
            {
                id: "subject",
                category: "4. ë¶„ì•¼ë³„ ì‹¬í™” íƒêµ¬ (ì „ê³µ ì í•©ì„±)",
                emoji: "ğŸ§¬",
                color: "violet",
                desc: "í¬ë§ ì „ê³µê³¼ ê´€ë ¨ëœ ê¹Šì´ ìˆëŠ” ìë£Œë¥¼ ì°¾ëŠ” ì „ë¬¸ ê¸°ê´€ì…ë‹ˆë‹¤.",
                sites: [
                    { name: "í•œêµ­ìƒëª…ê³µí•™ì—°êµ¬ì›", url: "https://www.kribb.re.kr", tag: "ìƒëª…ê³¼í•™", desc: "ë°”ì´ì˜¤ ìµœì‹  ë‰´ìŠ¤ ë° ì—°êµ¬ ì„±ê³¼" },
                    { name: "ë°”ì´ì˜¤ì•ˆì „ì„±ì •ë³´", url: "https://www.biosafety.or.kr", tag: "GMO/ì•ˆì „", desc: "LMO, ìœ ì „ì ë³€í˜• ìƒë¬¼ì²´ ì•ˆì „ ì •ë³´" },
                    { name: "ë©”ë””ì¹¼íƒ€ì„ì¦ˆ", url: "https://www.medicaltimes.com", tag: "ì˜í•™/ë³´ê±´", desc: "ì˜ë£Œê³„ ìµœì‹  ì´ìŠˆ ë° ì •ì±… ë‰´ìŠ¤" },
                    { name: "SWì¤‘ì‹¬ì‚¬íšŒ", url: "https://www.software.kr", tag: "SW/AI", desc: "ì†Œí”„íŠ¸ì›¨ì–´ ì •ì±…, AI êµìœ¡ ë° ì‚°ì—… ë™í–¥" },
                    { name: "ITFIND", url: "https://www.itfind.or.kr", tag: "ICT", desc: "ì •ë³´í†µì‹  ê¸°ìˆ  ì—°êµ¬ ë³´ê³ ì„œ ë° ë™í–¥" },
                    { name: "Baekjoon OJ", url: "https://www.acmicpc.net", tag: "ì½”ë”©", desc: "ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œ í’€ì´ ë° í”„ë¡œê·¸ë˜ë° ì—°ìŠµ" },
                    { name: "ê¸°ê³„Â·ë¡œë´‡ì—°êµ¬ì •ë³´", url: "https://www.materic.or.kr", tag: "ê¸°ê³„/ë¡œë´‡", desc: "ê¸°ê³„ ë° ë¡œë´‡ ê´€ë ¨ ë…¼ë¬¸, ê¸°ìˆ  ë™í–¥" },
                    { name: "í•œêµ­ë¬¼ë¦¬í•™íšŒ", url: "https://www.kps.or.kr", tag: "ë¬¼ë¦¬", desc: "ë¬¼ë¦¬í•™ í•™ìˆ  ì •ë³´ ë° í–‰ì‚¬" },
                    { name: "í•œêµ­í™”í•™ì—°êµ¬ì›", url: "https://www.krict.re.kr", tag: "í™”í•™", desc: "í™”í•™ ê´€ë ¨ ìµœì‹  ì—°êµ¬ ì„±ê³¼" },
                    { name: "ì•Œì§€ì˜¤ë§¤ìŠ¤", url: "https://www.algeomath.kr", tag: "ìˆ˜í•™", desc: "ë„í˜•, ê·¸ë˜í”„ë¥¼ ì§ì ‘ ê·¸ë ¤ë³´ëŠ” ìˆ˜í•™ íƒêµ¬ ë„êµ¬" },
                    { name: "êµ­ë¦½êµ­ì–´ì›", url: "https://www.korean.go.kr", tag: "êµ­ì–´", desc: "í‘œì¤€êµ­ì–´ëŒ€ì‚¬ì „, ì–´ë¬¸ ê·œë²” ìë£Œ" },
                    { name: "êµ­í† ì§€ë¦¬ì •ë³´ì›", url: "https://www.ngii.go.kr", tag: "ì§€ë¦¬", desc: "ìˆ˜ì¹˜ì§€ë„, í•­ê³µì‚¬ì§„ ë“± êµ­í†  ì •ë³´" },
                    { name: "í•œêµ­ì˜ì–´ì˜ë¬¸í•™íšŒ", url: "https://www.ellak.or.kr", tag: "ì˜ë¬¸í•™", desc: "ì˜ì–´ì˜ë¬¸í•™ ê´€ë ¨ í•™ìˆ  ì •ë³´" },
                    { name: "í•œêµ­ë¬¸í™”ì‚¬íšŒí•™íšŒ", url: "https://socul.or.kr", tag: "ì‚¬íšŒ", desc: "ë¬¸í™” ì‚¬íšŒí•™ ê´€ë ¨ ì—°êµ¬" },
                    { name: "ì°¾ê¸°ì‰¬ìš´ ìƒí™œë²•ë ¹", url: "https://www.easylaw.go.kr", tag: "ë²•/ì‚¬íšŒ", desc: "ì¼ìƒ ìƒí™œê³¼ ê´€ë ¨ëœ ë²•ë ¹ì„ ì‰½ê²Œ í’€ì´" }
                ]
            },
            {
                id: "tools",
                category: "5. ë¶„ì„ ë„êµ¬ ë° ìœ í‹¸ë¦¬í‹° (í•„ìˆ˜)",
                emoji: "ğŸ› ï¸",
                color: "rose",
                desc: "ë³´ê³ ì„œ ì‘ì„±ì„ ë„ì™€ì£¼ëŠ” ì‹¤ì „ ë„êµ¬ë“¤ì…ë‹ˆë‹¤.",
                sites: [
                    { name: "ì¹´í”¼í‚¬ëŸ¬", url: "https://www.copykiller.com", tag: "í‘œì ˆê²€ì‚¬", desc: "ë³´ê³ ì„œ ì œì¶œ ì „ í‘œì ˆë¥  í™•ì¸ í•„ìˆ˜ (ì—°êµ¬ ìœ¤ë¦¬)" },
                    { name: "ë¶€ì‚°ëŒ€ ë§ì¶¤ë²• ê²€ì‚¬ê¸°", url: "http://speller.cs.pusan.ac.kr", tag: "êµì •", desc: "í•œêµ­ì–´ ë§ì¶¤ë²•/ë¬¸ë²• êµì •ê¸°" },
                    { name: "í†µê·¸ë¼ë¯¸", url: "https://tong.kostat.go.kr", tag: "í†µê³„íˆ´", desc: "êµìœ¡ìš© í†µê³„ í”„ë¡œê·¸ë¨. ì„¤ë¬¸ ê²°ê³¼ ê·¸ë˜í”„ ì œì‘ì— ìµœì " },
                    { name: "ë¹…ì¹´ì¸ì¦ˆ", url: "https://www.bigkinds.or.kr", tag: "ë‰´ìŠ¤ë¶„ì„", desc: "ë‰´ìŠ¤ í‚¤ì›Œë“œ ê´€ê³„ë„ ë¶„ì„ ì œê³µ" },
                    { name: "ë¯¸ë¦¬ìº”ë²„ìŠ¤", url: "https://www.miricanvas.com", tag: "ë””ìì¸", desc: "ë³´ê³ ì„œ í‘œì§€, ë°œí‘œ PPT ë””ìì¸ ì œì‘" },
                    { name: "ë©˜í‹°ë¯¸í„°", url: "https://www.mentimeter.com", tag: "ì„¤ë¬¸/íˆ¬í‘œ", desc: "ì‹¤ì‹œê°„ ì„¤ë¬¸ì¡°ì‚¬ ë° ì›Œë“œí´ë¼ìš°ë“œ ìƒì„± ë„êµ¬" }
                ]
            }
        ];

        const SITE_COLOR = {
            blue: { pill: "bg-blue-50 text-blue-700 border-blue-100", icon: "bg-blue-100 text-blue-600", corner: "bg-blue-50", hoverIcon: "group-hover:text-blue-500", hoverTitle: "group-hover:text-blue-700", btn: "hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200" },
            emerald: { pill: "bg-emerald-50 text-emerald-700 border-emerald-100", icon: "bg-emerald-100 text-emerald-600", corner: "bg-emerald-50", hoverIcon: "group-hover:text-emerald-500", hoverTitle: "group-hover:text-emerald-700", btn: "hover:bg-emerald-50 hover:text-emerald-600 hover:border-emerald-200" },
            amber: { pill: "bg-amber-50 text-amber-700 border-amber-100", icon: "bg-amber-100 text-amber-600", corner: "bg-amber-50", hoverIcon: "group-hover:text-amber-500", hoverTitle: "group-hover:text-amber-700", btn: "hover:bg-amber-50 hover:text-amber-600 hover:border-amber-200" },
            violet: { pill: "bg-violet-50 text-violet-700 border-violet-100", icon: "bg-violet-100 text-violet-600", corner: "bg-violet-50", hoverIcon: "group-hover:text-violet-500", hoverTitle: "group-hover:text-violet-700", btn: "hover:bg-violet-50 hover:text-violet-600 hover:border-violet-200" },
            rose: { pill: "bg-rose-50 text-rose-700 border-rose-100", icon: "bg-rose-100 text-rose-600", corner: "bg-rose-50", hoverIcon: "group-hover:text-rose-500", hoverTitle: "group-hover:text-rose-700", btn: "hover:bg-rose-50 hover:text-rose-600 hover:border-rose-200" },
        };

        const ResourceCheatkey = () => {
            const clamp2 = {
                display: "-webkit-box",
                WebkitBoxOrient: "vertical",
                WebkitLineClamp: 2,
                overflow: "hidden",
            };

            const scrollToCategory = (id) => {
                const el = document.getElementById(`res-${id}`);
                if (el) el.scrollIntoView({ behavior: "smooth", block: "start" });
            };

            const CAT_BTNS = [
                { id: "literature", label: "ğŸ“š ë…¼ë¬¸/í•™ìˆ " },
                { id: "data", label: "ğŸ“Š ë°ì´í„°/í†µê³„" },
                { id: "science", label: "ğŸ”­ ê³¼í•™ ì¼ë°˜" },
                { id: "subject", label: "ğŸ§¬ ë¶„ì•¼ë³„ ì‹¬í™”" },
                { id: "tools", label: "ğŸ› ï¸ ë„êµ¬/ìœ í‹¸" },
            ];

            return (
                <div className="bg-white rounded-[40px] border border-slate-100 shadow-sm p-8 md:p-10">
                    <div className="mb-8 border-b border-slate-200 pb-6">
                        <h3 className="text-2xl md:text-3xl font-black text-slate-900 tracking-tight">
                            ğŸ§° íƒêµ¬ë³´ê³ ì„œ ì¹˜íŠ¸í‚¤ (ì‚¬ì´íŠ¸ ëª¨ìŒ)
                        </h3>
                        <p className="text-slate-500 mt-2 font-bold text-sm">
                            ë…¼ë¬¸ ê²€ìƒ‰ë¶€í„° ë°ì´í„° ë¶„ì„, ìœ¤ë¦¬ ê²€ì‚¬ê¹Œì§€. ì¦ê²¨ì°¾ê¸° í•´ë‘ê³  í•„ìš”í•  ë•Œ êº¼ë‚´ ì“°ì„¸ìš”.
                        </p>
                    </div>

                    {/* ì¹´í…Œê³ ë¦¬ ë²„íŠ¼(ìŠ¤í¬ë¡¤ ì´ë™) */}
                    <div className="flex flex-wrap gap-2 mb-8 sticky top-24 bg-white/90 backdrop-blur z-20 py-2">
                        {CAT_BTNS.map((b) => {
                            const section = SITE_DATA.find((s) => s.id === b.id);
                            const c = SITE_COLOR[section?.color || "blue"];
                            return (
                                <button
                                    key={b.id}
                                    type="button"
                                    onClick={() => scrollToCategory(b.id)}
                                    className={
                                        "px-4 py-2 bg-white border border-slate-200 rounded-full text-sm font-black text-slate-600 transition-all shadow-sm " +
                                        c.btn
                                    }
                                >
                                    {b.label}
                                </button>
                            );
                        })}
                    </div>

                    {/* ì„¹ì…˜ ë Œë” */}
                    <div className="space-y-16">
                        {SITE_DATA.map((section) => {
                            const c = SITE_COLOR[section.color] || SITE_COLOR.blue;

                            return (
                                <div key={section.id} id={`res-${section.id}`} className="scroll-mt-32">
                                    <div className="flex items-center gap-3 mb-5">
                                        <span className={`${c.icon} p-2 rounded-xl text-xl`}>
                                            {section.emoji}
                                        </span>
                                        <div>
                                            <h4 className="text-lg md:text-xl font-black text-slate-900">
                                                {section.category}
                                            </h4>
                                            <p className="text-xs text-slate-500 font-bold mt-1">
                                                {section.desc}
                                            </p>
                                        </div>
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                                        {section.sites.map((site) => (
                                            <a
                                                key={site.name}
                                                href={site.url}
                                                target="_blank"
                                                rel="noreferrer"
                                                className="bg-white p-5 rounded-xl border border-slate-200 block group relative overflow-hidden transition-all duration-200 hover:-translate-y-1 hover:shadow-md hover:border-slate-400"
                                            >
                                                <div className={`absolute top-0 right-0 w-16 h-16 ${c.corner} rounded-bl-full -mr-8 -mt-8 transition-transform group-hover:scale-150`} />

                                                <div className="relative z-10">
                                                    <div className="flex justify-between items-start mb-2">
                                                        <span className={`text-[10px] font-black px-2 py-0.5 rounded-md border ${c.pill}`}>
                                                            {site.tag}
                                                        </span>

                                                        <svg
                                                            className={`w-4 h-4 text-slate-300 transition-colors ${c.hoverIcon}`}
                                                            fill="none"
                                                            stroke="currentColor"
                                                            viewBox="0 0 24 24"
                                                        >
                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                                                        </svg>
                                                    </div>

                                                    <div className={`font-black text-slate-800 transition-colors truncate mb-1 ${c.hoverTitle}`} title={site.name}>
                                                        {site.name}
                                                    </div>

                                                    <p className="text-xs text-slate-500 leading-relaxed" style={clamp2}>
                                                        {site.desc}
                                                    </p>
                                                </div>
                                            </a>
                                        ))}
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                </div>
            );
        };

        /****************************************************************
         * 3) (B) UI: 4ëŒ€ ì „ëµ ëª¨ë“ˆ ì»´í¬ë„ŒíŠ¸ (case 11ì—ì„œ ì‚¬ìš©)
         *    - ìˆ˜ì •: "íƒêµ¬ ìë£Œ íƒìƒ‰ ë°©ë²•" íƒ­ì—ì„œ ì°¸ì¡°ì‚¬ì´íŠ¸(<ResourceCheatkey />)ë¥¼ ì œê±°í–ˆìŠµë‹ˆë‹¤.
         ****************************************************************/
        const ResearchStrategyModule = () => {
            const [strategy, setStrategy] = React.useState("papers");
            const [subTabs, setSubTabs] = React.useState({
                papers: "dbpia",
                books: "selection",
                news: "sources",
                life: "observation",
            });

            const data = STRATEGY_DATA[strategy];
            const currentSub = subTabs[strategy];
            const block = data.content?.[currentSub] || null;
            const steps = block?.steps || [];

            React.useEffect(() => {
                if (window.lucide) window.lucide.createIcons();
            }, [strategy, currentSub]);

            const COLOR = {
                blue: {
                    ring: "ring-blue-500",
                    border: "border-blue-200",
                    hoverBorder: "hover:border-blue-300",
                    stepHoverBorder: "group-hover:border-blue-300",
                    softBg: "bg-blue-50",
                    softText: "text-blue-700",
                    solidBg: "bg-blue-600",
                },
                amber: {
                    ring: "ring-amber-500",
                    border: "border-amber-200",
                    hoverBorder: "hover:border-amber-300",
                    stepHoverBorder: "group-hover:border-amber-300",
                    softBg: "bg-amber-50",
                    softText: "text-amber-700",
                    solidBg: "bg-amber-600",
                },
                emerald: {
                    ring: "ring-emerald-500",
                    border: "border-emerald-200",
                    hoverBorder: "hover:border-emerald-300",
                    stepHoverBorder: "group-hover:border-emerald-300",
                    softBg: "bg-emerald-50",
                    softText: "text-emerald-700",
                    solidBg: "bg-emerald-600",
                },
                violet: {
                    ring: "ring-violet-500",
                    border: "border-violet-200",
                    hoverBorder: "hover:border-violet-300",
                    stepHoverBorder: "group-hover:border-violet-300",
                    softBg: "bg-violet-50",
                    softText: "text-violet-700",
                    solidBg: "bg-violet-600",
                },
            };

            const c = COLOR[data.color];

            const select = (next) => {
                setStrategy(next);
                const nextData = STRATEGY_DATA[next];
                setSubTabs((prev) => {
                    const cur = prev[next];
                    const fallback = nextData.subTabs?.[0];
                    return { ...prev, [next]: cur || fallback };
                });
            };

            const setSub = (sub) => setSubTabs((prev) => ({ ...prev, [strategy]: sub }));

            const cardBase =
                "cursor-pointer bg-white p-7 rounded-[32px] border shadow-sm transition-all text-left";
            const activeCard = "ring-4 ring-indigo-50 scale-[1.02] shadow-xl";

            const StrategyCard = ({ k, icon, color, label, title, desc }) => {
                const isActive = strategy === k;
                const cc = COLOR[color];

                return (
                    <button
                        type="button"
                        onClick={() => select(k)}
                        className={
                            `${cardBase} ` +
                            (isActive
                                ? `ring-2 ${cc.ring} ${activeCard} ${cc.border}`
                                : `border-slate-200 ${cc.hoverBorder}`)
                        }
                    >
                        <div className="flex items-start justify-between gap-4">
                            <div>
                                <span
                                    className={`${cc.softBg} ${cc.softText} text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-widest inline-block mb-3`}
                                >
                                    {label}
                                </span>
                                <div className="text-lg font-black text-slate-900 tracking-tight">
                                    {title}
                                </div>
                                <div className="text-xs text-slate-500 font-bold mt-2 leading-relaxed">
                                    {desc}
                                </div>
                            </div>
                            <div className={`${cc.softBg} p-3 rounded-2xl shrink-0`}>
                                <LucideIcon name={icon} className={`w-6 h-6 ${cc.softText}`} />
                            </div>
                        </div>
                    </button>
                );
            };

            return (
                <div className="space-y-10 fade-in">
                    {/* Header */}
                    <div className="flex items-center justify-between gap-6 flex-wrap">
                        <div>
                            <h2 className="text-4xl font-black tracking-tighter text-amber-600 flex items-center gap-4">
                                <LucideIcon name="search" className="w-10 h-10" />
                                íƒêµ¬ ìë£Œ ì°¾ê¸° ë¹„ë²•
                            </h2>
                            <p className="text-slate-500 font-bold mt-3 text-sm">
                                ë…¼ë¬¸Â·ì±…Â·ë‰´ìŠ¤Â·ìƒí™œ ë°ì´í„°. 4ê°€ì§€ ë£¨íŠ¸ë¡œ íƒêµ¬ ì£¼ì œë¥¼ ë¹ ë¥´ê²Œ êµ¬ì²´í™”í•©ë‹ˆë‹¤.
                            </p>
                            <p className="text-slate-400 font-bold mt-2 text-xs">
                                â€» ì°¸ì¡°ì‚¬ì´íŠ¸ ëª¨ìŒì€ ìƒë‹¨ì˜ <b>ì°¸ì¡°ì‚¬ì´íŠ¸</b> íƒ­ì—ì„œ í™•ì¸í•©ë‹ˆë‹¤.
                            </p>
                        </div>

                        <div className="bg-slate-900 text-white rounded-[28px] px-6 py-4 shadow-xl border border-white/5">
                            <div className="text-[10px] font-black uppercase tracking-[0.3em] text-slate-400">
                                Quick Rule
                            </div>
                            <div className="text-sm font-black mt-1">
                                â€œì°¾ê³  â†’ ë³€í˜•í•˜ê³  â†’ ì¸¡ì • ê°€ëŠ¥í•˜ê²Œ ë§Œë“ ë‹¤â€
                            </div>
                        </div>
                    </div>

                    {/* 4 Cards */}
                    <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6">
                        <StrategyCard
                            k="papers"
                            icon="graduation-cap"
                            color="blue"
                            label={STRATEGY_DATA.papers.label}
                            title={STRATEGY_DATA.papers.titleCard}
                            desc={STRATEGY_DATA.papers.descCard}
                        />
                        <StrategyCard
                            k="books"
                            icon="book-open"
                            color="amber"
                            label={STRATEGY_DATA.books.label}
                            title={STRATEGY_DATA.books.titleCard}
                            desc={STRATEGY_DATA.books.descCard}
                        />
                        <StrategyCard
                            k="news"
                            icon="newspaper"
                            color="emerald"
                            label={STRATEGY_DATA.news.label}
                            title={STRATEGY_DATA.news.titleCard}
                            desc={STRATEGY_DATA.news.descCard}
                        />
                        <StrategyCard
                            k="life"
                            icon="lightbulb"
                            color="violet"
                            label={STRATEGY_DATA.life.label}
                            title={STRATEGY_DATA.life.titleCard}
                            desc={STRATEGY_DATA.life.descCard}
                        />
                    </div>

                    {/* Detail Panel */}
                    <div className="bg-white rounded-[40px] shadow-xl border border-slate-100 overflow-hidden">
                        <div className="flex flex-col lg:flex-row">
                            {/* Left */}
                            <div className="flex-1 p-8 md:p-12 border-b lg:border-b-0 lg:border-r border-slate-100">
                                <div className="mb-6">
                                    <span
                                        className={`${c.softBg} ${c.softText} px-4 py-2 rounded-full text-[10px] font-black uppercase tracking-widest inline-block`}
                                    >
                                        Step-by-Step Guide
                                    </span>

                                    <div className="mt-4 flex items-end justify-between flex-wrap gap-4">
                                        <div>
                                            <h3 className="text-2xl md:text-3xl font-black text-slate-900 tracking-tighter">
                                                {data.title}
                                            </h3>
                                            <p className="text-slate-500 font-bold text-sm mt-2">
                                                {block?.badge ? `${block.badge} Â· ` : ""}
                                                {block?.name || ""}
                                            </p>
                                        </div>

                                        {/* Sub Tabs */}
                                        {data.subTabs?.length ? (
                                            <div className="bg-slate-100 p-1.5 rounded-2xl inline-flex flex-wrap gap-2">
                                                {data.subTabs.map((sub) => {
                                                    const isOn = currentSub === sub;
                                                    return (
                                                        <button
                                                            key={sub}
                                                            type="button"
                                                            onClick={() => setSub(sub)}
                                                            className={
                                                                "px-4 py-2 rounded-xl text-xs font-black transition-all " +
                                                                (isOn
                                                                    ? "bg-white text-slate-900 shadow-sm border border-slate-200"
                                                                    : "text-slate-500 hover:text-slate-700")
                                                            }
                                                        >
                                                            {data.content[sub].name}
                                                        </button>
                                                    );
                                                })}
                                            </div>
                                        ) : null}
                                    </div>
                                </div>

                                {/* Steps */}
                                <div className="relative">
                                    <div className="absolute left-4 top-3 bottom-3 w-px bg-slate-100"></div>
                                    <div className="space-y-7">
                                        {steps.map((step, idx) => {
                                            const isFirst = idx === 0;
                                            return (
                                                <div key={idx} className="relative flex gap-6 items-start group">
                                                    <div
                                                        className={
                                                            "relative z-10 w-8 h-8 rounded-full flex items-center justify-center font-black text-xs shadow-sm transition-colors " +
                                                            (isFirst
                                                                ? `${c.solidBg} text-white`
                                                                : `bg-white border-2 border-slate-200 text-slate-400 ${c.stepHoverBorder}`)
                                                        }
                                                    >
                                                        {idx + 1}
                                                    </div>
                                                    <div className="flex-1 pt-0.5">
                                                        <h4 className="font-black text-slate-900 text-lg tracking-tight">
                                                            {step.title}
                                                        </h4>
                                                        <p className="text-slate-500 text-sm font-medium mt-2 leading-relaxed">
                                                            {step.desc}
                                                        </p>
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            </div>

                            {/* Right */}
                            <div className="lg:w-[40%] bg-slate-50 p-8 md:p-12">
                                <div className="bg-white rounded-[32px] shadow-sm border border-slate-200 p-8 h-full flex flex-col">
                                    <div className="flex items-center gap-3 mb-6">
                                        <div className={`${c.softBg} ${c.softText} p-3 rounded-2xl`}>
                                            <LucideIcon name="sparkles" className={`w-5 h-5 ${c.softText}`} />
                                        </div>
                                        <div>
                                            <div className="text-slate-900 font-black tracking-tight">
                                                ì‹¤ì „ ë³€í˜• ì˜ˆì‹œ (Adaptation)
                                            </div>
                                            <div className="text-[11px] text-slate-500 font-bold mt-1">
                                                â€˜ê·¸ëŒ€ë¡œâ€™ê°€ ì•„ë‹ˆë¼ â€˜ë³€í˜•â€™ì´ í•µì‹¬ì…ë‹ˆë‹¤.
                                            </div>
                                        </div>
                                    </div>

                                    <div className="space-y-6 flex-1">
                                        <div className="opacity-70">
                                            <div className="text-[10px] font-black uppercase tracking-widest text-slate-400 mb-2">
                                                Before
                                            </div>
                                            <div className="p-4 border-l-4 border-slate-300 bg-slate-50 rounded-r-2xl text-sm text-slate-600 font-medium italic">
                                                {data.caseStudy.before}
                                            </div>
                                        </div>

                                        <div className="flex justify-center text-slate-300">
                                            <LucideIcon name="arrow-down" className="w-6 h-6 animate-bounce" />
                                        </div>

                                        <div>
                                            <div className={`text-[10px] font-black uppercase tracking-widest mb-2 ${c.softText}`}>
                                                After
                                            </div>
                                            <div className={`p-5 border-l-4 ${c.softBg} rounded-r-2xl text-sm font-black text-slate-900 shadow-sm`}>
                                                {data.caseStudy.after}
                                            </div>
                                            <ul className="mt-5 space-y-2">
                                                {data.caseStudy.points.map((p, i) => (
                                                    <li key={i} className="flex items-start gap-2 text-xs text-slate-600 font-bold">
                                                        <span className={`${c.softText} mt-0.5`}>â—</span>
                                                        <span>{p}</span>
                                                    </li>
                                                ))}
                                            </ul>
                                        </div>
                                    </div>

                                    <div className="mt-8 p-5 rounded-[24px] bg-slate-900 text-white border border-white/5 shadow-xl">
                                        <div className="text-[10px] font-black uppercase tracking-[0.3em] text-slate-400">
                                            Tip
                                        </div>
                                        <div className="text-sm font-black mt-1">
                                            ë³€í˜• ê·œì¹™: ëŒ€ìƒÂ·ì§€ì—­Â·ê¸°ê°„Â·ë³€ìˆ˜ ì¤‘ 1~2ê°œë§Œ ë°”ê¿‰ë‹ˆë‹¤.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {/* (ì¤‘ìš”) ì—¬ê¸°ì„œëŠ” ì°¸ì¡°ì‚¬ì´íŠ¸ ëª©ë¡ì„ ë Œë”ë§í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. */}
                </div>
            );
        };

        /****************************************************************
         * 4) TabContent (case 11: ResearchStrategyModuleë¡œ êµì²´)
         ****************************************************************/
        // =========================
// íƒ­ 13 êµì²´: 'íƒêµ¬ ë°©ë²• ê°€ì´ë“œ' (ìƒˆ ë²„ì „)
// - ì›ë³¸(React + lucide-react) ì½”ë“œë¥¼ ë‹¨ì¼ HTML(UMD React + lucide) í™˜ê²½ì— ë§ê²Œ ë³€í™˜
// - ì•„ì´ì½˜ì€ <LucideIcon ... /> ê¸°ë°˜ìœ¼ë¡œ ë Œë”ë§ (Appì˜ refreshIcons + ì»´í¬ë„ŒíŠ¸ useEffectë¡œ ê°±ì‹ )
// =========================

const LucideIcon = ({ name, className = "", style = {}, ...rest }) => {
  const ref = React.useRef(null);

  React.useEffect(() => {
    try {
      if (!ref.current) return;
      const lucide = window.lucide;
      if (!lucide || !lucide.icons || !lucide.createElement) return;

      const icon = lucide.icons[name];
      if (!icon) return;

      // Create SVG without replacing React-owned nodes.
      const svg = lucide.createElement(icon, { class: className });
      if (style && typeof style === "object") {
        Object.assign(svg.style, style);
      }

      ref.current.innerHTML = "";
      ref.current.appendChild(svg);
    } catch (e) {
      // Fail gracefully if the CDN is blocked/offline.
    }
  }, [name, className]);

  return <span ref={ref} aria-hidden="true" {...rest} />;
};

// ì—…ë¡œë“œëœ 'íƒêµ¬ ë°©ë²• ê°€ì´ë“œ' ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì¬êµ¬ì„±í•œ ë°ì´í„°
const InquiryMethodSteps = [
  {
    id: 1,
    title: "íƒêµ¬ ë°©ë²• ì„ íƒ",
    subtitle: "ì£¼ì œì— ë§ëŠ” ë°©ë²• ê³ ë¥´ê¸°",
    iconName: "pie-chart",
    color: "bg-indigo-100 text-indigo-600",
    content:
      "íƒêµ¬ ì§ˆë¬¸ì˜ ì„±ê²©ì— ë”°ë¼ ê°€ì¥ ì í•©í•œ ë°©ë²•ì„ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤. ì£¼ì œì™€ ë°©ë²•ì´ ë§ì•„ì•¼ ì¢‹ì€ í‰ê°€ë¥¼ ë°›ìŠµë‹ˆë‹¤.",
    coreFrame: {
      flow: "1ì°¨ì‹œ(ì§ˆë¬¸) â†’ 2ì°¨ì‹œ(ê·¼ê±°) â†’ 3ì°¨ì‹œ(ë°©ë²•) â†’ 4ì°¨ì‹œ(ê²°ë¡ )",
      tip: "ë³´ê³ ì„œëŠ” 'ì„œë¡ ë¶€í„° ìˆœì„œëŒ€ë¡œ'ê°€ ì•„ë‹ˆë¼, ë³¸ë¡ (ë°©ë²•/ê²°ê³¼)ì´ ë¨¼ì € íƒ„íƒ„í•´ì•¼ ì™„ì„±ë„ê°€ ì˜¬ë¼ê°‘ë‹ˆë‹¤."
    },
    tableData: [
      { q: "ì‚¬ëŒì˜ ì¸ì‹/íƒœë„ë¥¼ ì•Œê³  ì‹¶ë‹¤", m: "ì„¤ë¬¸/ë©´ë‹´", e: "n, %, í‰ê·  + ê·¸ë˜í”„", targetId: "card-survey" },
      { q: "ì¡°ê±´ì„ ë°”ê¿” ê²°ê³¼ ë³€í™”ë¥¼ ë³´ê³  ì‹¶ë‹¤", m: "ì‹¤í—˜/ê´€ì°°", e: "ë³€ì¸í‘œ + ë°˜ë³µì¸¡ì • + ì „í›„ë¹„êµ", targetId: "card-experiment" },
      { q: "ì´ë¯¸ ê³µê°œ ë°ì´í„°ê°€ ì¶©ë¶„í•˜ë‹¤", m: "ë°ì´í„° ë¶„ì„", e: "ì¶œì²˜/ì „ì²˜ë¦¬ + ê·¸ë˜í”„ 2~3ê°œ + í•´ì„", targetId: "card-data" },
      { q: "ì™œ ê·¸ëŸ°ì§€ ì´ë¡ /ì‚¬ë¡€ ì„¤ëª…ì´ í•µì‹¬", m: "ë¬¸í—Œì—°êµ¬", e: "ê°œë…ì •ì˜ + ì‚¬ë¡€ë¹„êµí‘œ + ì—°ê²°ë¬¸ì¥", targetId: "card-literature" },
      { q: "í•´ê²°ì±…ì„ ë§Œë“¤ê³  ê²€ì¦í•˜ê³  ì‹¶ë‹¤", m: "í”„ë¡œì íŠ¸/ì„¤ê³„", e: "ê°œì„ ì•ˆ + ê²€ì¦ì§€í‘œ(ì „í›„)", targetId: "card-project" }
    ],
    methodCards: [
      {
        id: "card-survey",
        title: "ì„¤ë¬¸/ë©´ë‹´ (ì¸ì‹Â·íƒœë„ ì¡°ì‚¬)",
        subtitle: "ì‚¬ëŒì˜ ìƒê°ì„ ë¬»ëŠ” ì£¼ì œ",
        iconName: "message-circle",
        outputs: "ë¬¸í•­ì§€ Â· ì‘ë‹µ ìš”ì•½í‘œ Â· ê·¸ë˜í”„ 2ê°œ ì´ìƒ Â· ì§ˆë¬¸ë³„ í•´ì„ 1~2ë¬¸ì¥",
        when: [
          "í•™ìƒ/êµì‚¬ì˜ â€˜ì¸ì‹Â·íƒœë„Â·ë§Œì¡±ë„â€™ë¥¼ ì•Œê³  ì‹¶ìŠµë‹ˆë‹¤.",
          "ê²½í—˜/ìŠµê´€/ì‚¬ìš© íŒ¨í„´ì„ ë¹„êµí•˜ê³  ì‹¶ìŠµë‹ˆë‹¤."
        ],
        weakness: [
          "ëŒ€ìƒ(n)Â·ê¸°ê°„Â·ì„ ì • ê¸°ì¤€ì„ ë°í™ë‹ˆë‹¤.",
          "ë¬¸í•­ 5~10ê°œ(ì„ ë‹¤+ì„œìˆ  í˜¼í•© ê¶Œì¥)ë¡œ ì„¤ê³„í•©ë‹ˆë‹¤.",
          "ê²°ê³¼ëŠ” ë°˜ë“œì‹œ %/í‰ê·  + ê·¸ë˜í”„(ë§‰ëŒ€/ì›)ë¡œ ì œì‹œí•©ë‹ˆë‹¤.",
          "í‘œë³¸ í¸í–¥/ì‘ë‹µ ì™œê³¡ ê°€ëŠ¥ì„±ì„ â€˜í•œê³„â€™ë¡œ ì”ë‹ˆë‹¤."
        ],
        mistake: "â€œë§ì´ ê·¸ë ‡ë‹¤â€ ê°™ì€ í‘œí˜„ë§Œ ì“°ê³  ìˆ«ì(%)Â·nì„ ì•ˆ ì”ë‹ˆë‹¤.",
        fix: "ëª¨ë“  ì£¼ì¥ ì˜†ì— (n= , %= , í‰ê· = ) ì¤‘ í•˜ë‚˜ë¥¼ ë¶™ì…ë‹ˆë‹¤."
      },
      {
        id: "card-experiment",
        title: "ì‹¤í—˜/ê´€ì°° (ë³€ì¸ í†µì œ)",
        subtitle: "ì¡°ê±´ì„ ë°”ê¿” ê²°ê³¼ë¥¼ ë³¸ë‹¤",
        iconName: "microscope",
        outputs: "ë³€ì¸í‘œ Â· ì ˆì°¨ 6~10ë‹¨ê³„ Â· ì¸¡ì •ê°’ í‘œ Â· ì „í›„/ì§‘ë‹¨ ë¹„êµ ê·¸ë˜í”„",
        when: [
          "ë‚´ê°€ ì¡°ê±´(X)ì„ ë°”ê¾¸ë©´ ê²°ê³¼(Y)ê°€ ë‹¬ë¼ì§€ëŠ”ì§€ ë³´ê³  ì‹¶ìŠµë‹ˆë‹¤.",
          "ì¸¡ì •(ì‹œê°„/íšŸìˆ˜/ì ìˆ˜/ë†ë„ ë“±)ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤."
        ],
        weakness: [
          "ë…ë¦½/ì¢…ì†/í†µì œ ë³€ì¸ì„ í‘œë¡œ ì •ë¦¬í•©ë‹ˆë‹¤.",
          "ì ˆì°¨ë¥¼ 6~10ë‹¨ê³„ë¡œ â€˜í–‰ë™ ë™ì‚¬â€™ë¡œ ì”ë‹ˆë‹¤.",
          "ìµœì†Œ 3íšŒ ë°˜ë³µ ì¸¡ì •(ê°€ëŠ¥í•˜ë©´ 5íšŒ) í›„ í‰ê· ì„ ëƒ…ë‹ˆë‹¤.",
          "ì˜¤ì°¨Â·í†µì œ ì‹¤íŒ¨ ê°€ëŠ¥ì„±ì„ â€˜í•œê³„â€™ë¡œ ì”ë‹ˆë‹¤."
        ],
        mistake: "ë³€ì¸ì„ ì•ˆ ì ê³  â€˜í•´ë³´ë‹ˆ ê·¸ëŸ° ê²ƒ ê°™ë‹¤â€™ë¡œ ëëƒ…ë‹ˆë‹¤.",
        fix: "ê²°ê³¼ë¥¼ ìˆ«ì(í‰ê· /ì°¨ì´)ë¡œ ì œì‹œí•˜ê³ , í†µì œ ë³€ì¸ì„ 2ê°œ ì´ìƒ ëª…ì‹œí•©ë‹ˆë‹¤."
      },
      {
        id: "card-data",
        title: "ë°ì´í„° ë¶„ì„ (ê³µê³µ/í•™êµ ë°ì´í„°)",
        subtitle: "ì´ë¯¸ ìˆëŠ” ë°ì´í„°ë¡œ ê²€ì¦",
        iconName: "bar-chart-3",
        outputs: "ì¶œì²˜/ë³€ìˆ˜ ì„¤ëª… Â· ì „ì²˜ë¦¬ ê¸°ë¡ Â· ê·¸ë˜í”„ 2~3ê°œ Â· í•´ì„ ë¬¸ì¥",
        when: [
          "ê³µê³µë°ì´í„°/í†µê³„/í•™êµ ê¸°ë¡ì²˜ëŸ¼ â€˜ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë°ì´í„°â€™ê°€ ìˆìŠµë‹ˆë‹¤.",
          "ì¶”ì„¸Â·ë¹„êµÂ·ê´€ê³„ë¥¼ ê·¸ë˜í”„ë¡œ ë³´ì—¬ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        ],
        weakness: [
          "ë°ì´í„° ì¶œì²˜(ê¸°ê´€/ì—°ë„/URL)ë¥¼ ì ìŠµë‹ˆë‹¤.",
          "ë³€ìˆ˜(ì—´)ê°€ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€ ì„¤ëª…í•©ë‹ˆë‹¤.",
          "ì „ì²˜ë¦¬(ê²°ì¸¡ì¹˜/í•„í„°ë§/ì§‘ê³„)ë¥¼ í•œ ì¤„ì´ë¼ë„ ê¸°ë¡í•©ë‹ˆë‹¤.",
          "ê·¸ë˜í”„ 1ê°œë‹¹ í•´ì„ 2ë¬¸ì¥(ë¬´ì—‡ì´ ë³´ì„ + ì™œ ê·¸ëŸ´ê¹Œ)ì„ ì”ë‹ˆë‹¤."
        ],
        mistake: "ê·¸ë˜í”„ë§Œ ë¶™ì´ê³  í•´ì„ì„ ì•ˆ ì”ë‹ˆë‹¤.",
        fix: "ê·¸ë˜í”„ë§ˆë‹¤ â€˜ê´€ì°° 1ë¬¸ì¥ + í•´ì„ 1ë¬¸ì¥â€™ì„ ê°•ì œí•©ë‹ˆë‹¤."
      },
      {
        id: "card-literature",
        title: "ë¬¸í—Œì—°êµ¬ (ì´ë¡ /ì‚¬ë¡€ë¶„ì„)",
        subtitle: "ì™œ ê·¸ëŸ°ì§€ â€˜ì„¤ëª…â€™ì´ í•µì‹¬",
        iconName: "book-open",
        outputs: "ê°œë… ì •ì˜ 3ê°œ Â· ì„ í–‰ì—°êµ¬/ì‚¬ë¡€ ë¹„êµí‘œ Â· ì£¼ì œ ì—°ê²° ë¬¸ì¥ Â· ì‹œì‚¬ì ",
        when: [
          "ì›ì¸/ë°°ê²½/ê°œë… ì •ì˜ê°€ í•µì‹¬ì´ê³  â€˜ì™œ?â€™ë¥¼ ì„¤ëª…í•´ì•¼ í•©ë‹ˆë‹¤.",
          "ì‚¬ë¡€ ë¹„êµ(ì •ì±…/í•™êµ/ì§€ì—­/êµ­ê°€)ê°€ ì„¤ë“ë ¥ì„ ë§Œë“­ë‹ˆë‹¤."
        ],
        weakness: [
          "í•µì‹¬ ê°œë… 3ê°œë¥¼ â€˜ì •ì˜â€™í•©ë‹ˆë‹¤(ì¶œì²˜ í¬í•¨).",
          "ì„ í–‰ì—°êµ¬/ì‚¬ë¡€ 2~3ê°œë¥¼ ë¹„êµí‘œë¡œ ì •ë¦¬í•©ë‹ˆë‹¤.",
          "ê° ìë£Œì— â€˜ë‚´ ì£¼ì œì— ì–´ë–»ê²Œ ì“°ëŠ”ì§€(ì—°ê²° ë¬¸ì¥)â€™ë¥¼ ë°˜ë“œì‹œ ì”ë‹ˆë‹¤."
        ],
        mistake: "ìš”ì•½ë§Œ í•˜ê³  ë‚´ ì£¼ì œì— ì—°ê²°ì„ ì•ˆ í•©ë‹ˆë‹¤.",
        fix: "ìë£Œë§ˆë‹¤ â€˜ì´ ìë£Œë¥¼ ë‚´ ì—°êµ¬ì§ˆë¬¸ì— ì´ë ‡ê²Œ ì”ë‹ˆë‹¤â€™ 1ë¬¸ì¥ì„ ë¶™ì…ë‹ˆë‹¤."
      },
      {
        id: "card-project",
        title: "í”„ë¡œì íŠ¸/ì„¤ê³„ (ê°œì„ ì•ˆÂ·í”„ë¡œí† íƒ€ì…)",
        subtitle: "í•´ê²°ì±…ì„ ë§Œë“¤ê³  ê²€ì¦",
        iconName: "settings",
        outputs: "ë¬¸ì œì •ì˜ Â· ê°œì„ ì•ˆ(í”„ë¡œí† íƒ€ì…) Â· ê²€ì¦(ì „í›„/í”¼ë“œë°±) Â· í•œê³„/í›„ì†",
        when: [
          "í•™êµ/ì§€ì—­ ë¬¸ì œë¥¼ â€˜ê°œì„ â€™í•˜ëŠ” í•´ê²°ì±…ì„ ì œì•ˆí•˜ë ¤ í•©ë‹ˆë‹¤.",
          "ì „í›„ ë¹„êµ ë˜ëŠ” ì‚¬ìš©ì í”¼ë“œë°±ìœ¼ë¡œ ê²€ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        ],
        weakness: [
          "ë¬¸ì œì •ì˜(ëˆ„ê°€/ì–¸ì œ/ì–´ë””ì„œ/ë¬´ì—‡ì´ ë¶ˆí¸)ë¥¼ 1ë¬¸ë‹¨ìœ¼ë¡œ ì”ë‹ˆë‹¤.",
          "í•´ê²°ì±…(ê·œì¹™/ë””ìì¸/ë„êµ¬)ì„ êµ¬ì²´í™”í•©ë‹ˆë‹¤(ê·¸ë¦¼/í™”ë©´/ì ˆì°¨).",
          "ê²€ì¦ ì§€í‘œ 1ê°œë¼ë„ ì¸¡ì •í•©ë‹ˆë‹¤(ì „í›„ ë³€í™”, ë§Œì¡±ë„, ì¤€ìˆ˜ìœ¨ ë“±)."
        ],
        mistake: "â€œì¢‹ì•„ì§ˆ ê²ƒ ê°™ë‹¤â€ë¡œ ëë‚´ê³  ê²€ì¦ì´ ì—†ìŠµë‹ˆë‹¤.",
        fix: "ì „í›„ ë¹„êµ ê°€ëŠ¥í•œ ì§€í‘œë¥¼ 1ê°œ ì •í•´ ìˆ«ìë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤."
      }
    ]
  },
  {
    id: 2,
    title: "1ì°¨ì‹œ: ì£¼ì œ ë° ì§ˆë¬¸",
    subtitle: "ì§ˆë¬¸ ì¢íˆê¸° & ë²”ìœ„ ì„¤ì •",
    iconName: "search",
    color: "bg-blue-100 text-blue-600",
    content:
      "íƒêµ¬ì˜ ì‹œì‘ì€ 'ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì§ˆë¬¸'ì„ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤. ì£¼ì œëŠ” ë„“ë”ë¼ë„ ì—°êµ¬ ì§ˆë¬¸ì€ êµ¬ì²´ì ì¸ ëŒ€ìƒ, ê¸°ê°„, ë³€ì¸ì„ í¬í•¨í•˜ì—¬ ì¢í˜€ì•¼ 'ê³¼ì œ í­ì£¼'ë¥¼ ë§‰ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    details: [
      "êµê³¼ ê°œë… 1ê°œë¥¼ 'ê³ ì •'í•˜ê³  ì§„ë¡œê´€ë ¨ í‚¤ì›Œë“œë¥¼ ì—°ê²°í•˜ê¸°",
      "íƒêµ¬ì§ˆë¬¸ì— ëŒ€ìƒ, ê¸°ê°„, ë³€ì¸ì„ ëª…ì‹œí•˜ì—¬ í•œ ë¬¸ì¥ìœ¼ë¡œ ë§Œë“¤ê¸°",
      "ë‹¨ìˆœí•œ í˜¸ê¸°ì‹¬ì„ ë„˜ì–´ 'ë³€ì¸ ê°„ì˜ ê´€ê³„'ë¥¼ ë³¼ ìˆ˜ ìˆëŠ”ì§€ ì ê²€",
      "ë™ê¸° ì‘ì„± ì‹œ ê°œì¸ì  ê²½í—˜ê³¼ í•™ë¬¸ì  í˜¸ê¸°ì‹¬ì„ ì—°ê²°í•˜ê¸°"
    ]
  },
  {
    id: 3,
    title: "2ì°¨ì‹œ: ê·¼ê±° í™•ë³´ (ìë£Œì¡°ì‚¬)",
    subtitle: "ì´ë¡ ì  ë°°ê²½ & ì£¼ì œ ì—°ê²°",
    iconName: "book-open",
    color: "bg-yellow-100 text-yellow-600",
    content:
      "ë„ì„œ, ë…¼ë¬¸, ê¸°ì‚¬ ë“± ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ìë£Œë¥¼ ì°¾ì•„ ë‚´ íƒêµ¬ì˜ ë‹¨ë‹¨í•œ ê¸°ë°˜ì„ ë§Œë“­ë‹ˆë‹¤. ë‹¨ìˆœíˆ ìë£Œë¥¼ ìš”ì•½í•˜ëŠ” ê²ƒì„ ë„˜ì–´ 'ë‚´ ì£¼ì œì™€ ì–´ë–»ê²Œ ì—°ê²°ë˜ëŠ”ì§€' ì„¤ëª…í•˜ëŠ” ê²ƒì´ í•µì‹¬ì…ë‹ˆë‹¤.",
    details: [
      "ë„ì„œ/ë…¼ë¬¸/ê¸°ì‚¬ ì¤‘ 2~3ê°œë¥¼ ì„ ì •í•˜ì—¬ í•µì‹¬ ë‚´ìš© ìš”ì•½",
      "ìë£Œë§ˆë‹¤ 'ì´ ìë£Œë¥¼ ë‚´ ì—°êµ¬ì§ˆë¬¸ì— ì´ë ‡ê²Œ í™œìš©í•¨'ì´ë¼ëŠ” ì—°ê²° ë¬¸ì¥ í•„ìˆ˜ ì‘ì„±",
      "ìë£Œ ì¡°ì‚¬ë¥¼ í†µí•´ ê°€ì„¤ì„ ì„¸ìš°ê±°ë‚˜ ë³€ì¸ í›„ë³´ ì°¾ê¸°",
      "ë³µì‚¬/ë¶™ì—¬ë„£ê¸° ê¸ˆì§€, ë°˜ë“œì‹œ ìì‹ ì˜ ì–¸ì–´ë¡œ ì¬êµ¬ì„±"
    ]
  },
  {
    id: 4,
    title: "3ì°¨ì‹œ: ë°©ë²• ë° ê³¼ì • ì„¤ê³„",
    subtitle: "ë³€ì¸ í†µì œ & ì ˆì°¨ êµ¬ì²´í™”",
    iconName: "flask-conical",
    color: "bg-purple-100 text-purple-600",
    content:
      "ì„ íƒí•œ ë°©ë²•(ì‹¤í—˜, ì„¤ë¬¸, ë¶„ì„ ë“±)ì— ë§ì¶° êµ¬ì²´ì ì¸ ì‹¤í–‰ ê³„íšì„ ì§­ë‹ˆë‹¤. ë³€ì¸ì„ ì² ì €íˆ í†µì œí•˜ê³ , ìœ¤ë¦¬ ë° ì•ˆì „ ë¬¸ì œë¥¼ ì‚¬ì „ì— ê³„íší•´ì•¼ íƒêµ¬ì˜ ì‹ ë¢°ë„ê°€ ì˜¬ë¼ê°‘ë‹ˆë‹¤.",
    details: [
      "ë…ë¦½/ì¢…ì†/í†µì œ ë³€ì¸ì„ ëª…í™•íˆ í‘œë¡œ ì •ë¦¬í•˜ê¸°",
      "ì ˆì°¨ë¥¼ 6~10ë‹¨ê³„ì˜ 'í–‰ë™ ë™ì‚¬'ë¡œ êµ¬ì²´ì ìœ¼ë¡œ ì„œìˆ ",
      "ë°ì´í„° ìˆ˜ì§‘ ë„êµ¬ ë° ë¶„ì„ ê³„íš ë¯¸ë¦¬ ì„¸ìš°ê¸°",
      "ì—°êµ¬ ìœ¤ë¦¬, ì•ˆì „ ìˆ˜ì¹™, ê°œì¸ì •ë³´ ë³´í˜¸ ê³„íš(ìµëª… ì²˜ë¦¬ ë“±) í¬í•¨"
    ]
  },
  {
    id: 5,
    title: "4ì°¨ì‹œ: ê²°ë¡  ë° ì„±ì°°",
    subtitle: "ì£¼ì¥ + ê·¼ê±° + í•´ì„ + í•œê³„",
    iconName: "check-circle",
    color: "bg-green-100 text-green-600",
    content:
      "ìˆ˜ì§‘í•œ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê²°ë¡ ì„ ë„ì¶œí•©ë‹ˆë‹¤. ë‹¨ìˆœíˆ 'ê·¸ë ‡ë‹¤'ë¼ê³  ì£¼ì¥í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, êµ¬ì²´ì ì¸ ìˆ˜ì¹˜ì™€ ê·¼ê±°ë¥¼ ì œì‹œí•´ì•¼ í•©ë‹ˆë‹¤. í•œê³„ë¥¼ ì†”ì§í•˜ê²Œ ì¸ì •í•˜ëŠ” ê²ƒë„ ì¤‘ìš”í•©ë‹ˆë‹¤.",
    details: [
      "ê²°ë¡  ê³µì‹: ì£¼ì¥ + ê·¼ê±°(ìˆ«ì/ì¶œì²˜/í†µê³„) + í•´ì„(ì´ìœ ) + í•œê³„",
      "ê·¸ë˜í”„/í‘œ í•˜ë‚˜ë‹¹ 'ê´€ì°° 1ë¬¸ì¥ + í•´ì„ 1ë¬¸ì¥' ì§ì§€ì–´ ì“°ê¸°",
      "ìƒê´€ê´€ê³„ë¥¼ ì¸ê³¼ê´€ê³„ë¡œ ë‹¨ì • ì§“ëŠ” ë…¼ë¦¬ì  ì˜¤ë¥˜ ì£¼ì˜",
      "í•œê³„ì ì„ ëª…ì‹œí•˜ê³ , ì´ë¥¼ ë³´ì™„í•  ìˆ˜ ìˆëŠ” í›„ì† íƒêµ¬ ì œì•ˆ"
    ]
  },
  {
    id: 6,
    title: "ì‹¤ìˆ˜ ì˜ˆë°© ì²´í¬ (Checklist)",
    subtitle: "íƒêµ¬ë³´ê³ ì„œ ì‘ì„± ì‹œ í”í•œ ì‹¤ìˆ˜ & ì˜ˆë°©ë²•",
    iconName: "alert-triangle",
    color: "bg-red-100 text-red-600",
    content: "ì²´í¬ë°•ìŠ¤ë¥¼ ëª¨ë‘ ì±„ìš°ë©´ â€œì£¼ì¥-ê·¼ê±°-í•œê³„â€ê°€ ìë™ìœ¼ë¡œ íƒ„íƒ„í•´ì§‘ë‹ˆë‹¤.",
    mistakes: [
      {
        id: "m1",
        title: "ê²°ë¡ ë§Œ ìˆê³  ê·¼ê±°(ìˆ«ì/ì¶œì²˜)ê°€ ì—†ìŠµë‹ˆë‹¤.",
        why: "ì£¼ì¥ë§Œ ìˆìœ¼ë©´ â€˜ëŠë‚Œâ€™ìœ¼ë¡œ ë³´ì´ê³  ì„¤ë“ë ¥ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤.",
        how: "ê²°ë¡  ë¬¸ì¥ë§ˆë‹¤ (n / % / í‰ê·  / í‘œÂ·ê·¸ë˜í”„ ë²ˆí˜¸ / ì¶œì²˜) ì¤‘ 1ê°œ ì´ìƒì„ ë¶™ì…ë‹ˆë‹¤.",
        criteria: "ë‚´ ê²°ë¡  ë¬¸ì¥ ì˜†ì— ìˆ«ì ë˜ëŠ” ì¶œì²˜ê°€ ìˆìŠµë‹ˆë‹¤."
      },
      {
        id: "m2",
        title: "'íƒêµ¬ ì§ˆë¬¸'ì´ ë„ˆë¬´ ë„“ì–´ì„œ ë²”ìœ„ê°€ í­ì£¼í•©ë‹ˆë‹¤.",
        why: "ìë£Œ/ë¶„ì„ì´ ëì—†ì´ ëŠ˜ì–´ë‚˜ê³  ê²°ë¡ ì´ íë ¤ì§‘ë‹ˆë‹¤.",
        how: "ëŒ€ìƒÂ·ê¸°ê°„Â·ë³€ì¸ì„ ë„£ì–´ â€˜í•œ ë¬¸ì¥â€™ìœ¼ë¡œ ì¢í™ë‹ˆë‹¤(ì˜ˆ: ìš°ë¦¬í•™êµ 2í•™ë…„, 4ì£¼, Xâ†”Y).",
        criteria: "ë‚´ 'íƒêµ¬ ì§ˆë¬¸'ì— ëŒ€ìƒÂ·ê¸°ê°„Â·ë³€ì¸ì´ ë“¤ì–´ìˆìŠµë‹ˆë‹¤."
      },
      {
        id: "m3",
        title: "ê·¸ë˜í”„ëŠ” ìˆëŠ”ë° í•´ì„ì´ ì—†ìŠµë‹ˆë‹¤.",
        why: "ê·¸ë˜í”„ê°€ ë§í•˜ëŠ” ì˜ë¯¸(íŒ¨í„´/ê´€ê³„)ê°€ ì „ë‹¬ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
        how: "ê·¸ë˜í”„ 1ê°œë‹¹ â€˜ê´€ì°° 1ë¬¸ì¥ + í•´ì„ 1ë¬¸ì¥â€™ì„ ë°˜ë“œì‹œ ì”ë‹ˆë‹¤.",
        criteria: "ê·¸ë˜í”„ë§ˆë‹¤ í•´ì„ 2ë¬¸ì¥ì„ ì¼ìŠµë‹ˆë‹¤."
      },
      {
        id: "m4",
        title: "ìƒê´€ì„ ì¸ê³¼ë¡œ ë‹¨ì •í•©ë‹ˆë‹¤.",
        why: "ë…¼ë¦¬ ì˜¤ë¥˜ë¡œ ì‹ ë¢°ë„ê°€ í¬ê²Œ ë–¨ì–´ì§‘ë‹ˆë‹¤.",
        how: "â€˜ê´€ê³„ê°€ ìˆë‹¤â€™ë¡œ í‘œí˜„í•˜ê³ , ì¸ê³¼ëŠ” ì¶”ê°€ í†µì œ/ì‹¤í—˜ì´ í•„ìš”í•˜ë‹¤ê³  ì ìŠµë‹ˆë‹¤.",
        criteria: "â€˜ì›ì¸ì´ë‹¤â€™ í‘œí˜„ì„ í”¼í•˜ê³  í•œê³„ë¥¼ ì ì—ˆìŠµë‹ˆë‹¤."
      },
      {
        id: "m5",
        title: "ìë£Œì¡°ì‚¬ëŠ” ìš”ì•½ë§Œ ìˆê³  â€˜ë‚´ ì£¼ì œ ì—°ê²°â€™ì´ ì—†ìŠµë‹ˆë‹¤.",
        why: "ì„ í–‰ì—°êµ¬ê°€ ë‚´ ì—°êµ¬ì— ì–´ë–»ê²Œ ì“°ì´ëŠ”ì§€ ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.",
        how: "ìë£Œë§ˆë‹¤ â€˜ì´ ìë£Œë¥¼ ë‚´ 'íƒêµ¬ ì§ˆ'ë¬¸ì— ì´ë ‡ê²Œ ì”ë‹ˆë‹¤â€™ ì—°ê²° ë¬¸ì¥ì„ 1~2ë¬¸ì¥ ì”ë‹ˆë‹¤.",
        criteria: "ìë£Œ 2~3ê°œ ëª¨ë‘ì— ì—°ê²° ë¬¸ì¥ì´ ìˆìŠµë‹ˆë‹¤."
      },
      {
        id: "m6",
        title: "ìœ¤ë¦¬/ì•ˆì „/ê°œì¸ì •ë³´ í•­ëª©ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",
        why: "ì„¤ë¬¸/ë©´ë‹´/ì‚¬ì§„/ê¸°ë¡ë¬¼ì€ ê°ì  í¬ì¸íŠ¸ê°€ í½ë‹ˆë‹¤.",
        how: "ìµëª… ì²˜ë¦¬, ë™ì˜ ì ˆì°¨, ì‚¬ì§„Â·ê¸°ë¡ë¬¼ ì²˜ë¦¬, ìœ„í—˜ìš”ì†Œ íšŒí”¼ë¥¼ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ì”ë‹ˆë‹¤.",
        criteria: "ìœ¤ë¦¬/ì•ˆì „ í•­ëª©ì— ìµœì†Œ 4ì¤„ ì´ìƒ ì ì—ˆìŠµë‹ˆë‹¤."
      }
    ]
  },
  {
    id: 7,
    title: "ë¬¸ì¥ ê°•í™” ê³µì‹ (Template)",
    subtitle: "ì„¤ë“ë ¥ì„ ë†’ì´ëŠ” ë¬¸ì¥ ê³µì‹",
    iconName: "file-text",
    color: "bg-teal-100 text-teal-600",
    content:
      "â€œAê°€ Bë³´ë‹¤ í¬ë‹¤â€ë¥¼ â€˜ì„¤ë“ë ¥ ìˆëŠ” ë¬¸ì¥â€™ìœ¼ë¡œ ë°”ê¾¸ëŠ” ë²•. ì£¼ì¥ë§Œ ì“°ëŠ” ì‹¤ìˆ˜ë¥¼ ë§‰ê¸° ìœ„í•´, ì•„ë˜ í…œí”Œë¦¿ì„ ê·¸ëŒ€ë¡œ ë¶™ì—¬ ë„£ê³  ì±„ì›ë‹ˆë‹¤.",
    templateBox: [
      { label: "1) ì£¼ì¥(í•œ ë¬¸ì¥)", text: "Aê°€ Bë³´ë‹¤ ë†’ë‹¤/í¬ë‹¤/íš¨ê³¼ê°€ ìˆë‹¤." },
      { label: "2) ê·¼ê±°(ìˆ«ì/ì¶œì²˜)", text: "n= , %= , í‰ê· = , (í‘œ/ê·¸ë˜í”„ ë²ˆí˜¸), ì¶œì²˜(ê¸°ê´€/ì—°ë„/URL)" },
      { label: "3) í•´ì„(ì™œ ê·¸ëŸ°ì§€)", text: "ì´ ê²°ê³¼ëŠ” â—‹â—‹ ë•Œë¬¸ìœ¼ë¡œ í•´ì„ëœë‹¤." },
      { label: "4) í•œê³„(ë¸Œë ˆì´í¬)", text: "í‘œë³¸/ê¸°ê°„/ì¸¡ì •/í†µì œì˜ í•œê³„ê°€ ìˆë‹¤." }
    ],
    fiveSecCheck: [
      { id: "c1", text: "ì£¼ì¥ ì˜†ì— ìˆ«ì(%, í‰ê· , n) ë˜ëŠ” ì¶œì²˜ê°€ ìˆìŠµë‹ˆë‹¤." },
      { id: "c2", text: "ê·¸ë˜í”„/í‘œê°€ ìˆìœ¼ë©´ ë²ˆí˜¸ + í•´ì„ 2ë¬¸ì¥ì´ ìˆìŠµë‹ˆë‹¤." },
      { id: "c3", text: "â€˜ì™œ?â€™ í•´ì„ ë¬¸ì¥ì´ ìˆìŠµë‹ˆë‹¤." },
      { id: "c4", text: "â€˜í•˜ì§€ë§Œâ€™ í•œê³„ ë¬¸ì¥ì´ ìˆìŠµë‹ˆë‹¤." },
      { id: "c5", text: "í•œê³„ê°€ ìˆìœ¼ë©´ í›„ì† íƒêµ¬ê°€ ë¶™ì–´ ìˆìŠµë‹ˆë‹¤." }
    ],
    examples: [
      {
        bad: "Aê°€ Bë³´ë‹¤ ë” í¬ë‹¤.",
        good: "n=58ëª… ì„¤ë¬¸ì—ì„œ A â€˜ë§Œì¡±â€™ì€ 62%, BëŠ” 41%ì…ë‹ˆë‹¤(ê·¸ë˜í”„ 2). ë‹¤ë§Œ ì‘ë‹µì´ íŠ¹ì • í•™ë…„ì— ì¹˜ìš°ì³¤ìŠµë‹ˆë‹¤."
      },
      {
        bad: "Aê°€ ë” íš¨ê³¼ì ì´ë‹¤.",
        good: "ë°˜ë³µ 3íšŒ ì¸¡ì •ì—ì„œ A í‰ê·  12.4ì´ˆ, B í‰ê·  15.1ì´ˆë¡œ Aê°€ ë” ì§§ì•˜ìŠµë‹ˆë‹¤(í‘œ 1). ë‹¨, ì˜¨ë„ ì¡°ê±´ì´ ì™„ì „ í†µì œë˜ì§„ ì•Šì•˜ìŠµë‹ˆë‹¤."
      },
      {
        bad: "Xê°€ Yì— ì˜í–¥ì„ ì¤€ë‹¤.",
        good: "2019~2024ë…„ ìë£Œì—ì„œ Xì™€ YëŠ” r=0.52ë¡œ ì–‘ì˜ ê´€ê³„ê°€ ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤(ì‚°ì ë„ 1, ì¶œì²˜: KOSIS 2024). ìƒê´€ì€ ì¸ê³¼ë¥¼ ì˜ë¯¸í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
      }
    ],
    finalTip: "ê²°ë¡ ì€ â€œì£¼ì¥ + ê·¼ê±°(ìˆ«ì/ì¶œì²˜) + í•´ì„ + í•œê³„â€ 4ìš”ì†Œê°€ í•œ ì„¸íŠ¸ì…ë‹ˆë‹¤."
  },
  {
    id: 8,
    title: "ê¶Œì¥ ë³´ê³ ì„œ êµ¬ì„± (ì œì¶œìš©)",
    subtitle: "ë³´ê³ ì„œ ì‘ì„± í‘œì¤€ ê°€ì´ë“œ",
    iconName: "layout",
    color: "bg-orange-100 text-orange-600",
    content: "ì œì¶œìš© ë³´ê³ ì„œì˜ í‘œì¤€ êµ¬ì„±ì…ë‹ˆë‹¤. ì´ ìˆœì„œëŒ€ë¡œ ë‚´ìš©ì„ ì •ë¦¬í•˜ë©´ ë…¼ë¦¬ì ì¸ íë¦„ì„ ê°–ì¶œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    reportStructure: [
      { section: "1. ì„œë¡ ", content: "ë™ê¸°/ëª©ì  + ì—°êµ¬ì§ˆë¬¸" },
      { section: "2. ì´ë¡ ì  ë°°ê²½/ìë£Œì¡°ì‚¬", content: "í•µì‹¬ ê·¼ê±° + ì£¼ì œ ì—°ê²°" },
      { section: "3. ë°©ë²•/ê³¼ì •", content: "ë³€ì¸Â·ì§€í‘œÂ·ì ˆì°¨Â·ë„êµ¬" },
      { section: "4. ê²°ê³¼/ë¶„ì„", content: "í‘œ/ê·¸ë˜í”„/í•´ì„" },
      { section: "5. ê²°ë¡ /ë…¼ì˜", content: "ì£¼ì¥ + ê·¼ê±° + í•œê³„ + í›„ì†" },
      { section: "6. ì°¸ê³ ë¬¸í—Œ", content: "ì¶œì²˜ ì–‘ì‹ í†µì¼" }
    ],
    finalTip:
      "ë¶„ëŸ‰ì€ ë³´í†µ ë³¸ë¬¸ 3~6ìª½(A4) ë‚´ì—ì„œ â€˜í•µì‹¬ ê·¼ê±°+ê³¼ì •â€™ì´ ë³´ì´ê²Œ êµ¬ì„±í•˜ê³ , í‘œ/ì„¤ë¬¸ì§€/ì¶”ê°€ ê·¸ë˜í”„ëŠ” ë¶€ë¡ìœ¼ë¡œ ë¶™ì´ë©´ ê¹”ë”í•©ë‹ˆë‹¤."
  },
  {
    id: 9,
    title: "ëŒ€ì… í‰ê°€ í¬ì¸íŠ¸ (Admissions)",
    subtitle: "ëŒ€í•™ì—ì„œ ì¢‹ê²Œ ë³´ì´ëŠ” í•µì‹¬ ì—­ëŸ‰",
    iconName: "graduation-cap",
    color: "bg-rose-100 text-rose-600",
    content:
      "ëŒ€ì…ì—ì„œ ì…í•™ì‚¬ì •ê´€ë“¤ì´ ìƒí™œê¸°ë¡ë¶€ì™€ ë³´ê³ ì„œë¥¼ ë³¼ ë•Œ ì£¼ëª©í•˜ëŠ” 'ì¢‹ê²Œ ë³´ì´ëŠ”' í¬ì¸íŠ¸ì…ë‹ˆë‹¤. ì´ 4ê°€ì§€ ì—­ëŸ‰ì´ ë“œëŸ¬ë‚˜ëŠ”ì§€ ì ê²€í•´ë³´ì„¸ìš”.",
    admissionsPoints: [
      { title: "í•™ì—…ì—­ëŸ‰", desc: "êµê³¼ ê°œë…ì„ ê·¼ê±°ë¡œ ë¬¸ì œë¥¼ ì •ì˜í•˜ê³  ë…¼ë¦¬ì ìœ¼ë¡œ ì„œìˆ í–ˆëŠ”ê°€" },
      { title: "ì§„ë¡œì—­ëŸ‰", desc: "í¬ë§ ì „ê³µê³¼ ì—°ê²°ëœ êµê³¼/íƒìƒ‰ì„ â€˜ì‚°ì¶œë¬¼â€™ë¡œ ì¦ëª…í–ˆëŠ”ê°€" },
      { title: "ìê¸°ì£¼ë„ì„±", desc: "ê³„íš â†’ ìˆ˜í–‰ â†’ ìˆ˜ì •(ì‹œí–‰ì°©ì˜¤) í”ì ì´ ìˆëŠ”ê°€" },
      { title: "íƒêµ¬ë ¥", desc: "ë³€ì¸/ì§€í‘œ/ìë£Œ(ì¶œì²˜)ê°€ ëª…í™•í•˜ê³ , í•œê³„ë¥¼ ìŠ¤ìŠ¤ë¡œ ì¸ì‹í–ˆëŠ”ê°€" }
    ]
  }
];

function InquiryMethodPage() {
  const [activeStep, setActiveStep] = useState(InquiryMethodSteps[0]);
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
  const [checkedItems, setCheckedItems] = useState({});
  const [copied, setCopied] = useState(false);

  // lucide ì•„ì´ì½˜ ê°±ì‹  (ìƒíƒœ ë³€í™”ë¡œ ìƒˆ ì•„ì´ì½˜ì´ DOMì— ë“±ì¥í•  ìˆ˜ ìˆìŒ)
  useEffect(() => {
    try {
      window.lucide && window.lucide.createIcons && window.lucide.createIcons();
    } catch (e) {}
  });

  const copyTemplate = async () => {
    const step7 = InquiryMethodSteps.find((s) => s.id === 7);
    const textToCopy = (step7?.templateBox || [])
      .map((item) => `${item.label}: ${item.text}`)
      .join("\n");

    try {
      if (navigator.clipboard && navigator.clipboard.writeText) {
        await navigator.clipboard.writeText(textToCopy);
      } else {
        // file:// ë“±ì—ì„œ clipboard APIê°€ ë§‰íˆëŠ” ê²½ìš° ëŒ€ë¹„
        const ta = document.createElement("textarea");
        ta.value = textToCopy;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
      }
      setCopied(true);
      setTimeout(() => setCopied(false), 2000);
    } catch (e) {
      alert("ë³µì‚¬ ê¶Œí•œì´ ì°¨ë‹¨ë˜ì–´ í…œí”Œë¦¿ì„ ë³µì‚¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì—ì„œ HTTPS í™˜ê²½ìœ¼ë¡œ ì—´ê±°ë‚˜, ë‚´ìš©ì„ ì§ì ‘ ë³µì‚¬í•´ ì£¼ì„¸ìš”.");
    }
  };

  const toggleCheck = (id) => {
    setCheckedItems((prev) => ({
      ...prev,
      [id]: !prev[id]
    }));
  };

  const calculateProgress = (step) => {
    if (step.id === 6 && step.mistakes) {
      const total = step.mistakes.length;
      const checked = step.mistakes.filter((m) => checkedItems[m.id]).length;
      return { total, checked, percentage: Math.round((checked / total) * 100) };
    }
    if (step.id === 7 && step.fiveSecCheck) {
      const total = step.fiveSecCheck.length;
      const checked = step.fiveSecCheck.filter((c) => checkedItems[c.id]).length;
      return { total, checked, percentage: Math.round((checked / total) * 100) };
    }
    return null;
  };

  const progress = calculateProgress(activeStep);

  const scrollToCard = (id) => {
    if (!id) return;
    const element = document.getElementById(id);
    if (element) {
      element.scrollIntoView({ behavior: "smooth", block: "center" });
      element.classList.add("ring-4", "ring-indigo-300", "transition-all");
      setTimeout(() => element.classList.remove("ring-4", "ring-indigo-300"), 2000);
    }
  };

  return (
    <div className="min-h-screen bg-slate-50 text-slate-800 font-sans selection:bg-indigo-100">
      {/* Header */}
      <header className="bg-white shadow-sm sticky top-0 z-20">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
          <div className="flex items-center gap-2">
            <div className="bg-indigo-600 p-2 rounded-lg text-white">
              <LucideIcon name="clipboard-list" className="w-5 h-5" />
            </div>
            <h1 className="text-xl font-bold text-slate-900">íƒêµ¬ ë°©ë²• ê°€ì´ë“œ</h1>
          </div>

          {/* Mobile Menu Button */}
          <button
            className="md:hidden p-2 rounded-md hover:bg-slate-100"
            onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
          >
            {isMobileMenuOpen ? (
              <LucideIcon name="x" className="w-5 h-5" />
            ) : (
              <LucideIcon name="menu" className="w-5 h-5" />
            )}
          </button>
        </div>
      </header>

      <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div className="flex flex-col md:flex-row gap-8">
          {/* Sidebar Navigation (Desktop) / Mobile Menu */}
          <nav className={`md:w-1/3 lg:w-1/4 flex-shrink-0 ${isMobileMenuOpen ? "block" : "hidden md:block"}`}>
            <div className="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden sticky top-24">
              <div className="p-4 bg-slate-50 border-b border-slate-100">
                <h2 className="font-semibold text-slate-700">íƒêµ¬ ì§„í–‰ ë‹¨ê³„</h2>
              </div>
              <ul className="divide-y divide-slate-100">
                {InquiryMethodSteps.map((step) => (
                  <li key={step.id}>
                    <button
                      onClick={() => {
                        setActiveStep(step);
                        setIsMobileMenuOpen(false);
                        window.scrollTo({ top: 0, behavior: "smooth" });
                      }}
                      className={`w-full text-left p-4 transition-all duration-200 flex items-center gap-3 hover:bg-slate-50
                        ${
                          activeStep.id === step.id
                            ? "bg-indigo-50 border-l-4 border-indigo-500"
                            : "border-l-4 border-transparent"
                        }`}
                    >
                      <div className={`p-2 rounded-full ${step.color} bg-opacity-20`}>
                        <LucideIcon name={step.iconName} className="w-6 h-6" />
                      </div>
                      <div>
                        <span
                          className={`block text-xs font-bold uppercase tracking-wider ${
                            activeStep.id === step.id ? "text-indigo-700" : "text-slate-500"
                          }`}
                        >
                          {step.id >= 6 ? "ì‹¬í™” ê°€ì´ë“œ" : `${step.id}ë‹¨ê³„`}
                        </span>
                        <span
                          className={`text-base font-medium ${
                            activeStep.id === step.id ? "text-slate-900" : "text-slate-600"
                          }`}
                        >
                          {step.title.split("(")[0]}
                        </span>
                      </div>
                      {activeStep.id === step.id && (
                        <LucideIcon name="arrow-right" className="ml-auto w-4 h-4 text-indigo-500" />
                      )}
                    </button>
                  </li>
                ))}
              </ul>
            </div>
          </nav>

          {/* Main Content Area */}
          <section className="flex-1 min-h-[600px]">
            <div className="bg-white rounded-3xl shadow-lg border border-slate-100 overflow-hidden transition-all duration-300">
              {/* Content Header */}
              <div
                className={`p-8 sm:p-12 text-white relative overflow-hidden bg-gradient-to-r 
                  ${
                    activeStep.id === 6
                      ? "from-red-900 to-red-800"
                      : activeStep.id === 7
                      ? "from-teal-900 to-teal-800"
                      : activeStep.id === 8
                      ? "from-orange-900 to-orange-800"
                      : activeStep.id === 9
                      ? "from-rose-900 to-rose-800"
                      : "from-slate-900 to-slate-800"
                  }`}
              >
                <div className="absolute top-0 right-0 p-8 opacity-10 transform translate-x-1/4 -translate-y-1/4">
                  <LucideIcon name={activeStep.iconName} className="w-[200px] h-[200px]" />
                </div>
                <div className="relative z-10">
                  <div className="flex items-center gap-2 mb-4">
                    <span className="bg-white/20 text-white px-3 py-1 rounded-full text-sm font-medium backdrop-blur-sm">
                      {activeStep.id >= 6 ? "ì‹¬í™” ê°€ì´ë“œ" : `${activeStep.id}ë‹¨ê³„`}
                    </span>
                  </div>
                  <h2 className="text-3xl sm:text-4xl font-bold mb-2">{activeStep.title}</h2>
                  <p className="text-slate-300 text-lg sm:text-xl">{activeStep.subtitle}</p>
                </div>
              </div>

              {/* Content Body */}
              <div className="p-8 sm:p-12">
                {/* CORE FRAME Section (Step 1 Only) */}
                {activeStep.coreFrame && (
                  <div className="mb-10 bg-indigo-50 border-l-4 border-indigo-500 p-6 rounded-r-xl">
                    <h3 className="text-lg font-bold text-indigo-900 mb-3 flex items-center gap-2">
                      <LucideIcon name="info" className="w-5 h-5" />
                      í•µì‹¬ êµ¬ì¡°
                    </h3>
                    <div className="mb-4 font-medium text-indigo-800 bg-white bg-opacity-60 p-3 rounded-lg inline-block">
                      {activeStep.coreFrame.flow}
                    </div>
                    <p className="text-indigo-700 leading-relaxed flex items-start gap-2">
                      <span className="mt-1 text-xl">ğŸ’¡</span>
                      <span>{activeStep.coreFrame.tip}</span>
                    </p>
                  </div>
                )}

                {/* Progress Bar (Step 6 & 7) */}
                {progress && (
                  <div className="mb-8">
                    <div className="flex justify-between items-end mb-2">
                      <h3 className="text-xl font-bold text-slate-900 flex items-center gap-2">
                        <LucideIcon
                          name="check-square"
                          className={`w-6 h-6 ${activeStep.id === 7 ? "text-teal-500" : "text-red-500"}`}
                        />
                        ì§„í–‰ë¥  (Progress)
                      </h3>
                      <span className={`${activeStep.id === 7 ? "text-teal-600" : "text-red-600"} font-bold text-lg`}>
                        {progress.checked} / {progress.total} ì™„ë£Œ
                      </span>
                    </div>
                    <div className="w-full bg-slate-200 rounded-full h-4 overflow-hidden">
                      <div
                        className={`h-4 rounded-full transition-all duration-500 ease-out ${
                          activeStep.id === 7 ? "bg-teal-500" : "bg-red-500"
                        }`}
                        style={{ width: `${progress.percentage}%` }}
                      ></div>
                    </div>
                  </div>
                )}

                <div className="mb-10">
                  <h3 className="text-lg font-bold text-slate-900 mb-4 flex items-center gap-2">
                    <LucideIcon
                      name="lightbulb"
                      className={`w-6 h-6 ${
                        activeStep.id === 6
                          ? "text-red-500"
                          : activeStep.id === 7
                          ? "text-teal-500"
                          : activeStep.id === 8
                          ? "text-orange-500"
                          : activeStep.id === 9
                          ? "text-rose-500"
                          : "text-indigo-500"
                      }`}
                    />
                    {activeStep.id >= 6 ? "ì‹¬í™” ê°€ì´ë“œ" : "í•µì‹¬ ê°€ì´ë“œ"}
                  </h3>
                  <p className="text-slate-600 leading-relaxed text-lg">{activeStep.content}</p>
                </div>

                {/* Main Content Render Logic */}
                <div
                  className={`bg-slate-50 rounded-2xl p-6 sm:p-8 border border-slate-100 ${
                    activeStep.id === 6
                      ? "bg-red-50/50"
                      : activeStep.id === 7
                      ? "bg-teal-50/50"
                      : activeStep.id === 8
                      ? "bg-orange-50/50"
                      : activeStep.id === 9
                      ? "bg-rose-50/50"
                      : ""
                  }`}
                >
                  <h3
                    className={`text-lg font-bold mb-6 flex items-center gap-2 ${
                      activeStep.id === 6
                        ? "text-red-700"
                        : activeStep.id === 7
                        ? "text-teal-700"
                        : activeStep.id === 8
                        ? "text-orange-700"
                        : activeStep.id === 9
                        ? "text-rose-700"
                        : "text-slate-900"
                    }`}
                  >
                    {activeStep.id === 6 ? (
                      <LucideIcon name="alert-triangle" className="w-6 h-6 text-red-600" />
                    ) : activeStep.id === 7 ? (
                      <LucideIcon name="check-circle" className="w-6 h-6 text-teal-600" />
                    ) : activeStep.id === 8 ? (
                      <LucideIcon name="layout" className="w-6 h-6 text-orange-600" />
                    ) : activeStep.id === 9 ? (
                      <LucideIcon name="star" className="w-6 h-6 text-rose-600" />
                    ) : (
                      <LucideIcon name="pen-tool" className="w-6 h-6 text-indigo-500" />
                    )}
                    {activeStep.id === 1
                      ? "ì£¼ì œë³„ ì¶”ì²œ ë°©ë²• (ë°©ë²• ì°¾ê¸°)"
                      : activeStep.id === 6
                      ? "ìƒì„¸ ì ê²€ ë¦¬ìŠ¤íŠ¸"
                      : activeStep.id === 7
                      ? "ë¬¸ì¥ ì‘ì„± í…œí”Œë¦¿"
                      : activeStep.id === 8
                      ? "ë³´ê³ ì„œ êµ¬ì„± ëª©ì°¨"
                      : activeStep.id === 9
                      ? "3ëŒ€ í•µì‹¬ ì—­ëŸ‰ + Î±"
                      : "ìƒì„¸ í™œë™ ë° í•„ìˆ˜ ìš”ê±´"}
                  </h3>

                  {/* Case 1: Table Data (Step 1) */}
                  {activeStep.tableData && (
                    <div className="overflow-x-auto mb-10">
                      <p className="text-sm text-slate-500 mb-2 flex items-center gap-1">
                        <LucideIcon name="mouse-pointer-click" className="w-4 h-4" />
                        í‘œì˜ í–‰ì„ í´ë¦­í•˜ë©´ ìƒì„¸ ì„¤ëª…ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
                      </p>
                      <table className="w-full text-left text-sm whitespace-nowrap md:whitespace-normal">
                        <thead>
                          <tr className="bg-slate-200 text-slate-700">
                            <th className="p-3 rounded-tl-lg font-bold">ì£¼ì œì˜ í•µì‹¬ ì§ˆë¬¸</th>
                            <th className="p-3 font-bold">ì¶”ì²œ ë°©ë²•</th>
                            <th className="p-3 rounded-tr-lg font-bold">í•„ìˆ˜ ê·¼ê±° (ì¤‘ìš”)</th>
                          </tr>
                        </thead>
                        <tbody className="divide-y divide-slate-200 bg-white">
                          {activeStep.tableData.map((row, idx) => (
                            <tr
                              key={idx}
                              onClick={() => scrollToCard(row.targetId)}
                              className="hover:bg-indigo-50 transition-colors cursor-pointer group"
                            >
                              <td className="p-3 text-slate-900 font-medium group-hover:text-indigo-700 transition-colors">
                                {row.q}
                              </td>
                              <td className="p-3 text-indigo-600 font-bold flex items-center gap-1">
                                {row.m}
                                <LucideIcon
                                  name="arrow-right"
                                  className="w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity"
                                />
                              </td>
                              <td className="p-3 text-slate-600">{row.e}</td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  )}

                  {/* Case 1.5: Method Cards (Step 1 - New) */}
                  {activeStep.methodCards && (
                    <div className="space-y-6">
                      <h4 className="font-bold text-indigo-900 text-lg flex items-center gap-2">
                        <LucideIcon name="layers" className="w-5 h-5" />
                        ìƒì„¸ ê°€ì´ë“œ: ìœ í˜•ë³„ ê³µëµë²•
                      </h4>
                      <div className="grid grid-cols-1 gap-6">
                        {activeStep.methodCards.map((card, idx) => (
                          <div
                            id={card.id}
                            key={idx}
                            className="bg-white rounded-xl border border-indigo-100 shadow-sm overflow-hidden hover:shadow-md transition-shadow"
                          >
                            <div className="bg-indigo-50 p-4 border-b border-indigo-100 flex items-center justify-between">
                              <div className="flex items-center gap-3">
                                <div className="bg-white p-2 rounded-lg text-indigo-600 shadow-sm">
                                  <LucideIcon name={card.iconName} className="w-5 h-5" />
                                </div>
                                <div>
                                  <h5 className="font-bold text-indigo-900">{card.title}</h5>
                                  <span className="text-xs font-medium text-indigo-600 bg-white px-2 py-0.5 rounded-full">
                                    {card.subtitle}
                                  </span>
                                </div>
                              </div>
                            </div>
                            <div className="p-5 space-y-4">
                              <div>
                                <strong className="text-sm text-indigo-800 block mb-1">ğŸ“Œ í•„ìˆ˜ ì‚°ì¶œë¬¼</strong>
                                <p className="text-slate-700 font-medium text-sm">{card.outputs}</p>
                              </div>

                              <div className="grid md:grid-cols-2 gap-4">
                                <div className="bg-slate-50 p-3 rounded-lg">
                                  <strong className="text-xs text-slate-500 block mb-2 uppercase">ì´ëŸ´ ë•Œ ì„ íƒ (Check)</strong>
                                  <ul className="space-y-1">
                                    {card.when.map((text, i) => (
                                      <li key={i} className="flex items-start gap-2 text-sm text-slate-700">
                                        <LucideIcon name="check-circle" className="w-4 h-4 text-green-500 mt-0.5 shrink-0" />
                                        <span>{text}</span>
                                      </li>
                                    ))}
                                  </ul>
                                </div>
                                <div className="bg-orange-50 p-3 rounded-lg">
                                  <strong className="text-xs text-orange-500 block mb-2 uppercase">ì´ê²ƒì´ ì—†ìœ¼ë©´ ì•½í•´ì§</strong>
                                  <ul className="space-y-1">
                                    {card.weakness.map((text, i) => (
                                      <li key={i} className="flex items-start gap-2 text-sm text-slate-700">
                                        <LucideIcon
                                          name="alert-triangle"
                                          className="w-4 h-4 text-orange-400 mt-0.5 shrink-0"
                                        />
                                        <span>{text}</span>
                                      </li>
                                    ))}
                                  </ul>
                                </div>
                              </div>

                              <div className="flex flex-col sm:flex-row gap-0 sm:gap-4 border-t border-slate-100 pt-3">
                                <div className="flex-1 py-2">
                                  <span className="text-xs font-bold text-red-500 uppercase block mb-1">Bad (í”í•œ ì‹¤ìˆ˜)</span>
                                  <p className="text-sm text-slate-600">{card.mistake}</p>
                                </div>
                                <div className="hidden sm:block w-px bg-slate-100"></div>
                                <div className="flex-1 py-2">
                                  <span className="text-xs font-bold text-green-600 uppercase block mb-1">Good (ë°”ë¡œ ê³ ì¹˜ëŠ” ë²•)</span>
                                  <p className="text-sm text-slate-800 font-medium">{card.fix}</p>
                                </div>
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}

                  {/* Case 2: Mistakes Checklist (Step 6) */}
                  {activeStep.mistakes && (
                    <div className="grid gap-6">
                      {activeStep.mistakes.map((mistake) => (
                        <div
                          key={mistake.id}
                          onClick={() => toggleCheck(mistake.id)}
                          className={`
                            relative bg-white rounded-xl p-5 border-2 transition-all cursor-pointer hover:shadow-md
                            ${
                              checkedItems[mistake.id]
                                ? "border-green-400 shadow-sm opacity-60"
                                : "border-red-100 shadow-sm hover:border-red-300"
                            }
                          `}
                        >
                          <div className="flex items-start gap-4">
                            <div
                              className={`
                                mt-1 w-6 h-6 rounded border-2 flex items-center justify-center flex-shrink-0 transition-colors
                                ${
                                  checkedItems[mistake.id] ? "bg-green-500 border-green-500" : "bg-white border-slate-300"
                                }
                              `}
                            >
                              {checkedItems[mistake.id] && (
                                <LucideIcon name="check-square" className="w-4 h-4 text-white" />
                              )}
                            </div>

                            <div className="flex-1">
                              <h4
                                className={`text-lg font-bold mb-3 ${
                                  checkedItems[mistake.id] ? "text-slate-500 line-through" : "text-slate-900"
                                }`}
                              >
                                {mistake.title}
                              </h4>

                              {!checkedItems[mistake.id] && (
                                <div className="space-y-3 text-sm">
                                  <div className="bg-red-50 p-3 rounded-lg text-red-800">
                                    <span className="font-bold block text-xs text-red-600 mb-1 uppercase">ì™œ ë¬¸ì œì¸ê°€?</span>
                                    {mistake.why}
                                  </div>
                                  <div className="bg-blue-50 p-3 rounded-lg text-blue-800">
                                    <span className="font-bold block text-xs text-blue-600 mb-1 uppercase">ì´ë ‡ê²Œ ê³ ì¹˜ê¸°</span>
                                    {mistake.how}
                                  </div>
                                  <div className="bg-green-50 p-3 rounded-lg text-green-800 border border-green-100">
                                    <span className="font-bold block text-xs text-green-600 mb-1 uppercase">ì™„ë£Œ ê¸°ì¤€</span>
                                    {mistake.criteria}
                                  </div>
                                </div>
                              )}
                              {checkedItems[mistake.id] && <p className="text-green-600 font-medium text-sm">âœ“ í™•ì¸ ì™„ë£Œ</p>}
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>
                  )}

                  {/* Case 3: Template Box (Step 7) */}
                  {activeStep.templateBox && (
                    <div className="space-y-8">
                      <div className="bg-white rounded-xl border-2 border-teal-200 overflow-hidden shadow-sm">
                        <div className="bg-teal-50 px-6 py-4 border-b border-teal-100 flex justify-between items-center">
                          <h4 className="font-bold text-teal-800">ì£¼ì¥-ê·¼ê±° 4ì¹¸ í…œí”Œë¦¿</h4>
                          <button
                            onClick={copyTemplate}
                            className="text-xs flex items-center gap-1 bg-white border border-teal-200 px-3 py-1.5 rounded-lg text-teal-700 hover:bg-teal-50 transition-colors"
                          >
                            {copied ? <LucideIcon name="check" className="w-4 h-4" /> : <LucideIcon name="copy" className="w-4 h-4" />}
                            {copied ? "ë³µì‚¬ë¨" : "í…œí”Œë¦¿ ë³µì‚¬"}
                          </button>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-px bg-teal-100">
                          {activeStep.templateBox.map((item, idx) => (
                            <div key={idx} className="bg-white p-6 hover:bg-teal-50/30 transition-colors">
                              <span className="block text-sm font-bold text-teal-600 mb-2 uppercase tracking-wide">
                                {item.label}
                              </span>
                              <p className="text-slate-700 font-medium">{item.text}</p>
                            </div>
                          ))}
                        </div>
                      </div>

                      {/* 5 Second Check List (Interactive) */}
                      <div className="bg-white rounded-xl p-6 border border-slate-200">
                        <h4 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                          <LucideIcon name="check-circle" className="w-5 h-5 text-teal-500" />
                          5ì´ˆ ì ê²€ (ì²´í¬)
                        </h4>
                        <div className="space-y-3">
                          {activeStep.fiveSecCheck.map((check) => (
                            <label
                              key={check.id}
                              className="flex items-start gap-3 p-3 rounded-lg hover:bg-slate-50 cursor-pointer transition-colors group"
                            >
                              <div
                                className={`mt-0.5 w-5 h-5 rounded border flex items-center justify-center flex-shrink-0 transition-colors
                                  ${
                                    checkedItems[check.id]
                                      ? "bg-teal-500 border-teal-500"
                                      : "bg-white border-slate-300 group-hover:border-teal-400"
                                  }`}
                              >
                                {checkedItems[check.id] && <LucideIcon name="check" className="w-4 h-4 text-white" />}
                              </div>
                              <input
                                type="checkbox"
                                className="hidden"
                                checked={!!checkedItems[check.id]}
                                onChange={() => toggleCheck(check.id)}
                              />
                              <span className={`text-sm ${checkedItems[check.id] ? "text-slate-400 line-through" : "text-slate-700"}`}>
                                {check.text}
                              </span>
                            </label>
                          ))}
                        </div>
                      </div>

                      {/* Examples Bad vs Good */}
                      {activeStep.examples && (
                        <div className="mt-8 space-y-6">
                          <h4 className="font-bold text-slate-800 text-lg flex items-center gap-2">
                            <LucideIcon name="arrow-right" className="w-5 h-5 text-teal-500" />
                            ì‹¤ì „ ì˜ˆì‹œ (Bad vs Good)
                          </h4>
                          <div className="grid gap-4">
                            {activeStep.examples.map((ex, idx) => (
                              <div
                                key={idx}
                                className="bg-white rounded-xl border border-slate-200 overflow-hidden flex flex-col md:flex-row shadow-sm"
                              >
                                <div className="flex-1 p-5 bg-red-50/50 border-b md:border-b-0 md:border-r border-slate-100">
                                  <div className="flex items-center gap-2 text-red-600 font-bold mb-2 text-sm uppercase">
                                    <LucideIcon name="x-circle" className="w-4 h-4" /> ë‚˜ìœ ì˜ˆ
                                  </div>
                                  <p className="text-slate-700">{ex.bad}</p>
                                </div>
                                <div className="flex-1 p-5 bg-teal-50/50">
                                  <div className="flex items-center gap-2 text-teal-600 font-bold mb-2 text-sm uppercase">
                                    <LucideIcon name="thumbs-up" className="w-4 h-4" /> ì¢‹ì€ ì˜ˆ
                                  </div>
                                  <p className="text-slate-800 font-medium">{ex.good}</p>
                                </div>
                              </div>
                            ))}
                          </div>
                        </div>
                      )}

                      {/* Final Tip */}
                      {activeStep.finalTip && (
                        <div className="bg-indigo-900 text-white p-6 rounded-xl flex items-start gap-4 shadow-lg">
                          <div className="bg-white/20 p-2 rounded-lg">
                            <LucideIcon name="lightbulb" className="w-6 h-6 text-yellow-300" />
                          </div>
                          <div>
                            <h4 className="font-bold text-yellow-300 mb-1">TIP</h4>
                            <p className="text-indigo-100 text-lg font-medium">{activeStep.finalTip}</p>
                          </div>
                        </div>
                      )}
                    </div>
                  )}

                  {/* Case 5: Report Structure (Step 8) */}
                  {activeStep.reportStructure && (
                    <div className="space-y-6">
                      <div className="grid gap-4">
                        {activeStep.reportStructure.map((item, idx) => (
                          <div
                            key={idx}
                            className="bg-white p-5 rounded-xl border border-orange-200 shadow-sm flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 hover:bg-orange-50/30 transition-colors"
                          >
                            <span className="font-bold text-orange-900 min-w-[180px] text-lg bg-orange-100/50 px-3 py-1 rounded-lg inline-block w-fit sm:w-auto">
                              {item.section}
                            </span>
                            <span className="hidden sm:block text-orange-300">|</span>
                            <span className="text-slate-700 font-medium flex-1">{item.content}</span>
                          </div>
                        ))}
                      </div>

                      {/* Final Tip for Step 8 */}
                      <div className="bg-orange-50 border-l-4 border-orange-400 p-5 rounded-r-lg mt-8 shadow-sm">
                        <div className="flex items-start gap-4">
                          <div className="bg-white p-2 rounded-full shadow-sm mt-0.5">
                            <LucideIcon name="info" className="w-6 h-6 text-orange-500" />
                          </div>
                          <div>
                            <h4 className="font-bold text-orange-800 mb-2 text-lg">ì‘ì„± ê¿€íŒ</h4>
                            <p className="text-orange-900 font-medium leading-relaxed">{activeStep.finalTip}</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Case 6: Admissions Points (Step 9) */}
                  {activeStep.admissionsPoints && (
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                      {activeStep.admissionsPoints.map((point, idx) => (
                        <div
                          key={idx}
                          className="bg-white p-6 rounded-xl border border-rose-100 shadow-sm hover:shadow-md hover:border-rose-300 transition-all group"
                        >
                          <h4 className="font-bold text-xl text-rose-700 mb-3 flex items-center gap-2">
                            <div className="w-8 h-8 rounded-lg bg-rose-100 flex items-center justify-center group-hover:bg-rose-600 group-hover:text-white transition-colors">
                              {idx + 1}
                            </div>
                            {point.title}
                          </h4>
                          <p className="text-slate-700 leading-relaxed font-medium">{point.desc}</p>
                        </div>
                      ))}
                    </div>
                  )}

                  {/* Case 7: Standard List (Other Steps) */}
                  {activeStep.details && (
                    <ul className="space-y-4">
                      {activeStep.details.map((detail, index) => (
                        <li key={index} className="flex items-start gap-3 group">
                          <div className="mt-1.5 min-w-[20px]">
                            <LucideIcon name="check-circle" className="w-5 h-5 text-indigo-500 group-hover:scale-110 transition-transform" />
                          </div>
                          <span className="text-slate-700 leading-relaxed group-hover:text-slate-900 transition-colors">
                            {detail}
                          </span>
                        </li>
                      ))}
                    </ul>
                  )}
                </div>
              </div>

              {/* Navigation Footer within Card */}
              <div className="bg-slate-50 p-6 border-t border-slate-100 flex justify-between items-center">
                <button
                  onClick={() =>
                    setActiveStep(InquiryMethodSteps.find((s) => s.id === activeStep.id - 1) || InquiryMethodSteps[0])
                  }
                  disabled={activeStep.id === 1}
                  className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2
                    ${activeStep.id === 1 ? "text-slate-400 cursor-not-allowed" : "text-slate-600 hover:bg-slate-200 hover:text-slate-900"}`}
                >
                  â† ì´ì „ ë‹¨ê³„
                </button>
                <div className="flex gap-1">
                  {InquiryMethodSteps.map((s) => (
                    <div key={s.id} className={`w-2 h-2 rounded-full transition-colors ${s.id === activeStep.id ? "bg-indigo-500" : "bg-slate-300"}`} />
                  ))}
                </div>
                <button
                  onClick={() =>
                    setActiveStep(
                      InquiryMethodSteps.find((s) => s.id === activeStep.id + 1) || InquiryMethodSteps[InquiryMethodSteps.length - 1]
                    )
                  }
                  disabled={activeStep.id === InquiryMethodSteps.length}
                  className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2
                    ${activeStep.id === InquiryMethodSteps.length ? "text-slate-400 cursor-not-allowed" : "text-slate-600 hover:bg-slate-200 hover:text-slate-900"}`}
                >
                  ë‹¤ìŒ ë‹¨ê³„ â†’
                </button>
              </div>
            </div>
          </section>
        </div>
      </main>
    </div>
  );
}

const TabContent = ({ activeTab, studentInfo, sessionData, handleStudent, handleInput, handleAiConsult, aiLoading }) => {
            const SectionHeader = ({ title, subTitle, btnText, onBtnClick }) => (
                <div className="flex justify-between items-center border-b pb-8 mb-8">
                    <div>
                        <h2 className="text-4xl font-black text-slate-900 tracking-tighter">{title}</h2>
                        {subTitle && <p className="text-slate-400 font-bold mt-1 text-xs uppercase">{subTitle}</p>}
                    </div>
                    {btnText && (
                        <button
                            onClick={onBtnClick}
                            disabled={aiLoading}
                            className="btn-ai-glow text-white px-8 py-4 rounded-3xl text-sm font-black flex items-center gap-2 active:scale-95 shadow-2xl disabled:opacity-60 disabled:cursor-not-allowed"
                        >
                            <LucideIcon name="sparkles" className="w-5 h-5 text-amber-300" /> {btnText}
                        </button>
                    )}
                </div>
            );

            const issues = getIssues(studentInfo, sessionData);

            const ValidationCallout = ({ title = "ì²´í¬ë¦¬ìŠ¤íŠ¸", items }) => {
                if (!items || items.length === 0) return null;
                return (
                    <div className="mb-8 bg-rose-50/60 border border-rose-200 rounded-[32px] p-7">
                        <div className="flex items-start gap-3">
                            <LucideIcon name="alert-triangle" className="w-5 h-5 text-rose-600 mt-0.5" />
                            <div className="flex-1">
                                <div className="font-black text-rose-900">{title}</div>
                                <ul className="mt-2 text-sm font-bold text-rose-900/90 space-y-1 list-disc ml-5">
                                    {items.map((t, i) => <li key={i}>{t}</li>)}
                                </ul>
                            </div>
                        </div>
                    </div>
                );
            };

            switch (activeTab) {
                case 0: return (
                    <div className="space-y-12 fade-in">
                        <SectionHeader title="ì •ë³´ ì…ë ¥" subTitle="Personal Profile" />
                        <ValidationCallout title="í•„ìˆ˜ ì…ë ¥ ëˆ„ë½" items={issues.info} />

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-10">
                            <InputField label="í•™êµëª…" name="school" value={studentInfo.school} onChange={handleStudent} placeholder="OOê³ ë“±í•™êµ" />
                            <InputField label="í•™ë²ˆ" name="gradeClass" value={studentInfo.gradeClass} onChange={handleStudent} placeholder="ì˜ˆ: 20101" />
                            <InputField label="ì„±ëª…" name="name" value={studentInfo.name} onChange={handleStudent} placeholder="í™ê¸¸ë™" />
                            <InputField label="í¬ë§ ì „ê³µ" name="major" value={studentInfo.major} onChange={handleStudent} placeholder="ì˜ˆ: ìƒëª…ê³µí•™" />
                        </div>

                        <div className="mt-10 p-8 bg-indigo-50/50 rounded-[32px] border border-indigo-100 italic font-bold text-indigo-800 text-sm">
                            â€» ì…ë ¥ ì •ë³´ëŠ” ë¦¬í¬íŠ¸ì˜ í‘œì§€ ë° AI ë¶„ì„ ì‹œ ê¸°ì´ˆ ìë£Œë¡œ í™œìš©ë©ë‹ˆë‹¤.
                        </div>
                    </div>
                );

                case 11: return (<ResearchStrategyModule />);
                case 14: return (<ResourceCheatkey />);

                case 12: return (
                    <div className="space-y-12 fade-in text-center py-16">
                        <div className="bg-rose-50 p-16 rounded-[80px] border-4 border-rose-100 max-w-3xl mx-auto shadow-2xl">
                            <LucideIcon name="alert-triangle" className="w-20 h-20 text-rose-500 mx-auto mb-8" />
                            <h2 className="text-4xl font-black text-rose-900 tracking-tighter mb-6">AIëŠ” ë°œí’ˆì„ ëŒ€ì‹  íŒ”ì§€ ì•ŠìŠµë‹ˆë‹¤.</h2>
                            <p className="text-xl text-rose-800 leading-relaxed font-bold mb-10 italic">
                                ì‚¬ì •ê´€ì€ ë§¤ë„ëŸ¬ìš´ AI ë¬¸ì¥ë³´ë‹¤<br />ì—¬ëŸ¬ë¶„ì˜ ê±°ì¹ ê³  íˆ¬ë°•í•œ 'ì‹œí–‰ì°©ì˜¤ ê¸°ë¡'ì„ ë” ì‹ ë¢°í•©ë‹ˆë‹¤.
                            </p>
                            <div className="text-left bg-white/60 p-10 rounded-[40px] space-y-6 font-bold text-base text-rose-950 border border-rose-200 shadow-inner">
                                <p className="flex gap-4"><LucideIcon name="check-circle" className="w-6 h-6 shrink-0 text-rose-600" /> AIëŠ” ë…¼ë¦¬ êµ¬ì¡°ë¥¼ ì¡ëŠ” ë³´ì¡° ë„êµ¬ë¡œë§Œ í™œìš©í•©ë‹ˆë‹¤.</p>
                                <p className="flex gap-4"><LucideIcon name="check-circle" className="w-6 h-6 shrink-0 text-rose-600" /> ë°˜ë“œì‹œ ì§ì ‘ ì°¾ì€ 'ìˆ«ì'ì™€ 'ë°ì´í„°'ë¥¼ í”„ë¡¬í”„íŠ¸ì— ë„£ìŠµë‹ˆë‹¤.</p>
                                <p className="flex gap-4"><LucideIcon name="check-circle" className="w-6 h-6 shrink-0 text-rose-600" /> ë§¤ë„ëŸ½ê²Œ ìˆ˜ì •í•´ë‹¬ë¼ëŠ” ìš”ì²­ë³´ë‹¤, ë…¼ë¦¬ì˜ í—ˆì ì„ ì°¾ì•„ë‹¬ë¼ê³  í•©ë‹ˆë‹¤.</p>
                            </div>
                        </div>
                    </div>
                );

                case 1: return (
                    <div className="fade-in space-y-10">
                        <SectionHeader
                            title="1ì°¨ì‹œ: í‚¤ì›Œë“œ â†’ ì£¼ì œ â†’ ë™ê¸° â†’ ì§ˆë¬¸"
                            subTitle="Career-linked Topic Design"
                            btnText="AI ì •êµí™”"
                            onBtnClick={handleAiConsult}
                        />
                        <ValidationCallout title="1ì°¨ì‹œ ì ê²€ í•„ìš”" items={issues.s1} />

                        <div className="p-8 bg-indigo-50/50 rounded-[32px] border border-indigo-100 font-bold text-indigo-900 text-sm leading-relaxed">
                            ìˆœì„œëŒ€ë¡œ ì…ë ¥í•˜ë©´ ì£¼ì œê°€ í”ë“¤ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤. â€œêµê³¼ ê°œë…â€ê³¼ â€œì§„ë¡œ í‚¤ì›Œë“œâ€ë¥¼ ë¨¼ì € ê³ ì •í•œ ë’¤,
                            ê·¸ ì•ˆì—ì„œ ì¸¡ì • ê°€ëŠ¥/ê²€ì¦ ê°€ëŠ¥í•˜ê²Œ ì§ˆë¬¸ì„ ë§Œë“­ë‹ˆë‹¤.
                        </div>

                        <div className="space-y-10">
                            <InputField
                                label="STEP 1) êµê³¼(ê³¼ëª©/ë‹¨ì›/í•µì‹¬ ê°œë…)"
                                name="s1_subject"
                                value={sessionData.s1_subject}
                                onChange={handleInput}
                                placeholder="ì˜ˆ: í†µí•©ê³¼í•™-ì—ë„ˆì§€ ì „í™˜ / í™•ë¥ ê³¼í†µê³„-ìƒê´€Â·íšŒê·€ / ê²½ì œ-ì‹œì¥ ì‹¤íŒ¨"
                            />
                            <InputField
                                label="STEP 2) í¬ë§ ë¶„ì•¼ ê´€ì‹¬ í‚¤ì›Œë“œ(ì‰¼í‘œë¡œ 5~10ê°œ)"
                                name="s1_keywords"
                                value={sessionData.s1_keywords}
                                onChange={handleInput}
                                placeholder="ì˜ˆ: ì¬í™œ, ë³´í–‰ë¶„ì„, ì„¼ì„œ, ì‹ í˜¸ì²˜ë¦¬, ë°ì´í„°, UX, ì•ˆì „, ë¹„ìš©"
                            />
                            <InputField
                                label="STEP 3) íƒêµ¬ ì£¼ì œ(ê°€ì œ)"
                                name="s1_topic"
                                value={sessionData.s1_topic}
                                onChange={handleInput}
                                placeholder="ì˜ˆ: êµë‚´ ê³„ë‹¨ ë³´í–‰ ë°ì´í„°ë¡œ ë‚™ìƒ ìœ„í—˜ ìš”ì¸ì„ ì¶”ì •í•  ìˆ˜ ìˆì„ê¹Œ?"
                            />
                            <TextAreaField
                                label="STEP 4) íƒêµ¬ ë™ê¸°(êµê³¼ì—ì„œ ìƒê¸´ ê¶ê¸ˆì¦ + ì§„ë¡œ ì—°ê²°)"
                                name="s1_motive"
                                value={sessionData.s1_motive}
                                onChange={handleInput}
                                height="h-40"
                                placeholder="ìˆ˜ì—…ì—ì„œ ë°°ìš´ ê°œë…ì´ ì§„ë¡œ ë¬¸ì œë¥¼ ì„¤ëª…/ê°œì„ í•˜ëŠ” ë° ì–´ë–»ê²Œ ì“°ì´ëŠ”ì§€ êµ¬ì²´ì ìœ¼ë¡œ"
                            />
                            <InputField
                                label="STEP 5) íƒêµ¬ ì§ˆë¬¸(RQ) 1ê°œ"
                                name="s1_question"
                                value={sessionData.s1_question}
                                onChange={handleInput}
                                placeholder="ì˜ˆ: (A)ì™€ (B) ì‚¬ì´ì— ìœ ì˜ë¯¸í•œ ê´€ê³„ê°€ ìˆëŠ”ê°€?"
                            />
                            <TextAreaField
                                label="STEP 6) ë²”ìœ„/ëŒ€ìƒ/ë³€ì¸(ì¸¡ì • ê°€ëŠ¥í•˜ê²Œ)"
                                name="s1_scope"
                                value={sessionData.s1_scope}
                                onChange={handleInput}
                                height="h-32"
                                placeholder="ëŒ€ìƒ(ëˆ„êµ¬/ì–´ë””/ê¸°ê°„), ë³€ì¸(ë…ë¦½/ì¢…ì†), ì¸¡ì •(ì§€í‘œ/ë„êµ¬)ì„ ì ì–´ ì£¼ì„¸ìš”."
                            />
                        </div>
                    </div>
                );

                case 2: {
                    const SRC_TYPES = ["ë„ì„œ", "ë…¼ë¬¸", "ë‰´ìŠ¤ê¸°ì‚¬", "ë³´ê³ ì„œ/ì •ì±…ìë£Œ", "ê³µê³µë°ì´í„°", "ê¸°íƒ€(ì›¹/ì˜ìƒ)"];

                    const SourceSlot = ({ i }) => {
                        const p = `s2_src${i}_`;
                        const ref = sessionData[`${p}ref`];
                        const refScore = scoreSourceRef(ref).score; // âœ… ì•„ì´ë””ì–´(ì¶œì²˜ í˜•ì‹ ê²€ì‚¬)
                        const showWarn = (norm(sessionData[`${p}title`]) || norm(ref) || norm(sessionData[`${p}core`]) || norm(sessionData[`${p}connect`])) && refScore < 2;

                        return (
                            <div className="bg-white rounded-[40px] border border-slate-200 shadow-sm p-8 space-y-6">
                                <div className="flex items-center justify-between flex-wrap gap-3">
                                    <div className="text-lg font-black text-slate-900">ìë£Œ {i}</div>

                                    <div className="flex items-center gap-2">
                                        {showWarn && (
                                            <span className="text-[11px] font-black px-3 py-1 rounded-full bg-rose-50 border border-rose-200 text-rose-700">
                                                ì¶œì²˜ í˜•ì‹ ë³´ê°• í•„ìš”
                                            </span>
                                        )}
                                        <div className="bg-slate-100 p-1.5 rounded-2xl">
                                            <select
                                                name={`${p}type`}
                                                value={sessionData[`${p}type`]}
                                                onChange={handleInput}
                                                className="px-4 py-2 rounded-xl text-xs font-black bg-white border border-slate-200"
                                            >
                                                {SRC_TYPES.map((t) => <option key={t}>{t}</option>)}
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <InputField
                                    label="ìë£Œëª…(ì œëª©)"
                                    name={`${p}title`}
                                    value={sessionData[`${p}title`]}
                                    onChange={handleInput}
                                    placeholder="ì˜ˆ: (ë„ì„œ) ë°ì´í„° ë¦¬í„°ëŸ¬ì‹œ / (ë…¼ë¬¸) ~ì— ëŒ€í•œ ì—°êµ¬ / (ê¸°ì‚¬) ~ ì´ìŠˆ"
                                />
                                <InputField
                                    label="ì¶œì²˜(ì €ì/ê¸°ê´€/ë°œí–‰ì—°ë„/URL) â€” ê¸°ê´€/ì—°ë„/URL ì¤‘ 2ê°œ ì´ìƒ ê¶Œì¥"
                                    name={`${p}ref`}
                                    value={sessionData[`${p}ref`]}
                                    onChange={handleInput}
                                    placeholder="ì˜ˆ: KOSIS(2023) https://... / í™ê¸¸ë™(2024) OOì¶œíŒ"
                                />
                                <TextAreaField
                                    label="ìš”ì•½ ë˜ëŠ” í•µì‹¬ ë‚´ìš©(3~6ì¤„)"
                                    name={`${p}core`}
                                    value={sessionData[`${p}core`]}
                                    onChange={handleInput}
                                    height="h-32"
                                    placeholder="í•µì‹¬ ì£¼ì¥/ê°œë…/ë°ì´í„°ë¥¼ â€˜ë‚´ ë§â€™ë¡œ ìš”ì•½í•©ë‹ˆë‹¤."
                                />
                                <TextAreaField
                                    label="ë‚´ ì£¼ì œ ì—°ê²°(ê°œë…/ë³€ì¸/ê´€ì /ë°©ë²•ë¡ )"
                                    name={`${p}connect`}
                                    value={sessionData[`${p}connect`]}
                                    onChange={handleInput}
                                    height="h-32"
                                    placeholder="ì´ ìë£Œê°€ ë‚´ íƒêµ¬ ì§ˆë¬¸ì„ ì–´ë–»ê²Œ ê°•í™”í•˜ëŠ”ì§€(ê·¼ê±°/ë³€ì¸/ë°©ë²•)ë¡œ ì—°ê²°í•©ë‹ˆë‹¤."
                                />
                            </div>
                        );
                    };

                    return (
                        <div className="fade-in space-y-10">
                            <SectionHeader
                                title="2ì°¨ì‹œ: ìë£Œ ì¡°ì‚¬(ì„ íƒ) â†’ ìš”ì•½ â†’ ì£¼ì œ ì—°ê²°"
                                subTitle="Evidence & Literature Scan"
                                btnText="AI ìš”ì•½Â·ì—°ê²° ê°•í™”"
                                onBtnClick={handleAiConsult}
                            />
                            <ValidationCallout title="2ì°¨ì‹œ ì ê²€(ê¶Œì¥ í¬í•¨)" items={issues.s2} />

                            <div className="grid grid-cols-1 gap-8">
                                <SourceSlot i={1} />
                                <SourceSlot i={2} />
                                <SourceSlot i={3} />
                            </div>

                            <div className="bg-slate-900 p-10 rounded-[48px] text-white shadow-2xl">
                                <div className="text-[10px] font-black uppercase tracking-[0.3em] text-slate-400">Synthesis</div>
                                <div className="text-lg font-black mt-2">ìë£Œì¡°ì‚¬ ì¢…í•© ì •ë¦¬(ê°€ì„¤/ë³€ì¸ í›„ë³´/ê´€ì  ì •ë¦¬)</div>
                                <textarea
                                    name="s2_takeaway"
                                    value={sessionData.s2_takeaway}
                                    onChange={handleInput}
                                    className="w-full h-40 bg-transparent border-none outline-none text-base font-bold leading-relaxed mt-6 resize-none scrollbar-hide"
                                    placeholder="ì˜ˆ: ì„ í–‰ì—°êµ¬ëŠ” Aë¥¼ í•µì‹¬ ë³€ì¸ìœ¼ë¡œ ë³´ë©°, ë‚˜ëŠ” ìš°ë¦¬ ë§¥ë½ì—ì„œ Bë¥¼ ì¶”ê°€ ë³€ì¸ìœ¼ë¡œ ê²€ì¦í•©ë‹ˆë‹¤."
                                />
                            </div>
                        </div>
                    );
                }

                case 3: return (
                    <div className="fade-in space-y-10">
                        <SectionHeader
                            title="3ì°¨ì‹œ: íƒêµ¬ ë°©ë²• ë° ê³¼ì • ì„¤ê³„"
                            subTitle="Method & Process"
                            btnText="AI ë°©ë²• ì„¤ê³„ ì½”ì¹­"
                            onBtnClick={handleAiConsult}
                        />
                        <ValidationCallout title="3ì°¨ì‹œ ì ê²€ í•„ìš”" items={issues.s3} />

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-10">
                            <div className="space-y-4">
                                <Label>ë°©ë²• ìœ í˜•</Label>
                                <select
                                    name="s3_method_type"
                                    value={sessionData.s3_method_type}
                                    onChange={handleInput}
                                    className="w-full p-6 rounded-3xl bg-slate-50 font-black text-lg appearance-none outline-none focus:ring-4 focus:ring-indigo-100 border border-slate-100"
                                >
                                    <option>ë¬¸í—Œì—°êµ¬(ì´ë¡ /ì‚¬ë¡€ë¶„ì„)</option>
                                    <option>ì„¤ë¬¸/ë©´ë‹´(ì¸ì‹Â·íƒœë„ ì¡°ì‚¬)</option>
                                    <option>ì‹¤í—˜/ê´€ì°°(ë³€ì¸ í†µì œ)</option>
                                    <option>ë°ì´í„° ë¶„ì„(ê³µê³µë°ì´í„°/í•™êµë°ì´í„°)</option>
                                    <option>ëª¨í˜•/ì‹œë®¬ë ˆì´ì…˜(ìˆ˜í•™/ì½”ë”©)</option>
                                    <option>í”„ë¡œì íŠ¸/ì„¤ê³„(í”„ë¡œí† íƒ€ì…Â·ê°œì„ ì•ˆ)</option>
                                </select>
                            </div>

                            <InputField
                                label="ê°€ì„¤/ì£¼ì¥(ì„ íƒ)"
                                name="s3_hypothesis"
                                value={sessionData.s3_hypothesis}
                                onChange={handleInput}
                                placeholder="ì˜ˆ: Xê°€ ì¦ê°€í•˜ë©´ Yê°€ ê°ì†Œí•  ê²ƒì´ë‹¤."
                            />
                        </div>

                        <TextAreaField
                            label="ë³€ì¸/ì§€í‘œ/ì¸¡ì •(ë…ë¦½Â·ì¢…ì†Â·í†µì œ ë³€ì¸, ì¸¡ì • ë„êµ¬/ì§€í‘œ)"
                            name="s3_variables"
                            value={sessionData.s3_variables}
                            onChange={handleInput}
                            height="h-40"
                            placeholder="ì˜ˆ: ë…ë¦½ë³€ì¸=..., ì¢…ì†ë³€ì¸=..., í†µì œ=..., ì§€í‘œ=..., ì¸¡ì •=..."
                        />

                        <TextAreaField
                            label="ê³¼ì •(ë‹¨ê³„ë³„ ì ˆì°¨: 1) ì¤€ë¹„ 2) ìˆ˜ì§‘ 3) ë¶„ì„ 4) ê²€ì¦ 5) ì •ë¦¬"
                            name="s3_process"
                            value={sessionData.s3_process}
                            onChange={handleInput}
                            height="h-56"
                            placeholder="ê° ë‹¨ê³„ì—ì„œ â€˜ë¬´ì—‡ì„â€™ â€˜ì–´ë–»ê²Œâ€™ â€˜ë¬´ìŠ¨ ë„êµ¬ë¡œâ€™ í• ì§€ êµ¬ì²´í™”í•©ë‹ˆë‹¤."
                        />

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <TextAreaField
                                label="ë°ì´í„° ê³„íš(ìˆ˜ì§‘/ì •ë¦¬/ì‹œê°í™”)"
                                name="s3_data_plan"
                                value={sessionData.s3_data_plan}
                                onChange={handleInput}
                                height="h-40"
                                placeholder="í‘œ/ê·¸ë˜í”„ ì‚°ì¶œë¬¼ì„ ë¯¸ë¦¬ ì •í•˜ë©´ ë³´ê³ ì„œê°€ ë¹¨ë¼ì§‘ë‹ˆë‹¤."
                            />
                            <TextAreaField
                                label="ë„êµ¬(ì—‘ì…€/í†µê·¸ë¼ë¯¸/íŒŒì´ì¬/ì„¤ë¬¸ë„êµ¬ ë“±)"
                                name="s3_tools"
                                value={sessionData.s3_tools}
                                onChange={handleInput}
                                height="h-40"
                                placeholder="ì˜ˆ: Excel í”¼ë²—/íšŒê·€, í†µê·¸ë¼ë¯¸, Google ì„¤ë¬¸, Python pandas ë“±"
                            />
                        </div>

                        <TextAreaField
                            label="ìœ¤ë¦¬/ì•ˆì „/ê°œì¸ì •ë³´(í•„ìˆ˜)"
                            name="s3_ethics_safety"
                            value={sessionData.s3_ethics_safety}
                            onChange={handleInput}
                            height="h-32"
                            bgColor="bg-rose-50/50"
                            textColor="text-rose-900"
                            placeholder="ìµëª… ì²˜ë¦¬/ë™ì˜ ì ˆì°¨/ì‚¬ì§„Â·ê¸°ë¡ë¬¼ ì²˜ë¦¬/ì‹¤í—˜ ì•ˆì „ ë“±ì„ ëª…ì‹œí•©ë‹ˆë‹¤."
                        />
                    </div>
                );

                case 4: return (
                    <div className="fade-in space-y-10">
                        <SectionHeader
                            title="4ì°¨ì‹œ: ê²°ê³¼ â†’ ê²°ë¡  â†’ ë°°ìš´ì  â†’ í›„ì† íƒêµ¬"
                            subTitle="Conclusion & Reflection"
                            btnText="AI ê²°ë¡ Â·ì„±ì°° ì½”ì¹­"
                            onBtnClick={handleAiConsult}
                        />
                        <ValidationCallout title="4ì°¨ì‹œ ì ê²€ í•„ìš”" items={issues.s4} />

                        <TextAreaField
                            label="í•µì‹¬ ê²°ê³¼(í‘œ/ê·¸ë˜í”„/ê´€ì°° ìš”ì•½)"
                            name="s4_findings"
                            value={sessionData.s4_findings}
                            onChange={handleInput}
                            height="h-40"
                            placeholder="ìˆ«ì/ê·¼ê±° ì¤‘ì‹¬ìœ¼ë¡œ 3~6ì¤„ ì‘ì„±í•©ë‹ˆë‹¤."
                        />

                        <TextAreaField
                            label="ê²°ë¡ (ì£¼ì¥ + ê·¼ê±° ì—°ê²°)"
                            name="s4_conclusion"
                            value={sessionData.s4_conclusion}
                            onChange={handleInput}
                            height="h-40"
                            bgColor="bg-indigo-50/30"
                            textColor="text-indigo-900"
                            placeholder="ì—°êµ¬ì§ˆë¬¸ì— ë‹µí•˜ëŠ” í˜•íƒœë¡œ: ê²°ê³¼ â†’ í•´ì„ â†’ ê²°ë¡ "
                        />

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <TextAreaField
                                label="ë°°ìš´ ì (ê°œë…/ê¸°ìˆ /íƒœë„)"
                                name="s4_learning"
                                value={sessionData.s4_learning}
                                onChange={handleInput}
                                height="h-40"
                                placeholder="ë¬´ì—‡ì„ ì•Œê²Œ ë˜ì—ˆê³  ì–´ë–¤ ì—­ëŸ‰ì´ ìëëŠ”ì§€ ì”ë‹ˆë‹¤."
                            />
                            <TextAreaField
                                label="í•œê³„/ì£¼ì˜ì (ì˜¤ì°¨, í‘œë³¸, í¸í–¥, ë°˜ë¡€)"
                                name="s4_limits"
                                value={sessionData.s4_limits}
                                onChange={handleInput}
                                height="h-40"
                                bgColor="bg-slate-50"
                                textColor="text-slate-900"
                                placeholder="ë‚´ ê²°ë¡ ì´ ê³¼ì¥ë˜ì§€ ì•Šë„ë¡ ìŠ¤ìŠ¤ë¡œ ë¸Œë ˆì´í¬ë¥¼ ê²ë‹ˆë‹¤."
                            />
                        </div>

                        <TextAreaField
                            label="í›„ì† íƒêµ¬(ë‹¤ìŒ ì§ˆë¬¸/ê°œì„ ì•ˆ/í™•ì¥ ê³„íš)"
                            name="s4_next"
                            value={sessionData.s4_next}
                            onChange={handleInput}
                            height="h-32"
                            placeholder="í•œê³„ë¥¼ ë³´ì™„í•˜ëŠ” ë‹¤ìŒ íƒêµ¬ë¥¼ 2~3ê°œ ì œì‹œí•©ë‹ˆë‹¤."
                        />
                    </div>
                );

                case 5: {
                    // âœ… 1í˜ì´ì§€ ìš”ì•½ íƒ­
                    const autoOnePage = buildOnePageSummary(studentInfo, sessionData);
                    const onePageValue = norm(sessionData.sR_onepage) ? sessionData.sR_onepage : autoOnePage;

                    const copyToClipboard = async () => {
                        try {
                            await navigator.clipboard.writeText(onePageValue);
                            alert("1í˜ì´ì§€ ìš”ì•½ì„ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆìŠµë‹ˆë‹¤.");
                        } catch (e) {
                            alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ê¶Œí•œì„ í™•ì¸í•´ ì£¼ì„¸ìš”.");
                        }
                    };

                    const overwriteAuto = () => {
                        const evt = { target: { name: "sR_onepage", value: autoOnePage } };
                        handleInput(evt);
                    };

                    return (
                        <div className="fade-in space-y-10">
                            <SectionHeader
                                title="1í˜ì´ì§€ ìš”ì•½(ì œì¶œìš©)"
                                subTitle="Executive Summary (1 page)"
                                btnText="AI ìš”ì•½ ë‹¤ë“¬ê¸°"
                                onBtnClick={handleAiConsult}
                            />
                            <ValidationCallout title="ìš”ì•½ ì™„ì„±ë„ ì ê²€" items={issues.onepage} />

                            <div className="bg-amber-50/60 border border-amber-100 rounded-[32px] p-8 font-bold text-amber-900 text-sm leading-relaxed">
                                â€˜ì£¼ì œ-ìë£Œ-ë°©ë²•-ê²°ë¡ -í•œê³„â€™ê°€ í•œ ì¥ì— ë“¤ì–´ì˜¤ë©´ ì‹¬ì‚¬/ë°œí‘œì—ì„œ ë§¤ìš° ê°•ë ¥í•©ë‹ˆë‹¤.
                                ìë™ ìƒì„± í›„ <b>ìˆ˜ì¹˜Â·ì¶œì²˜Â·í•œê³„</b>ë§Œ í™•ì‹¤íˆ ì±„ìš°ë©´ ì™„ì„±ë„ê°€ ì˜¬ë¼ê°‘ë‹ˆë‹¤.
                            </div>

                            <div className="flex items-center gap-3 flex-wrap">
                                <button
                                    type="button"
                                    onClick={copyToClipboard}
                                    className="bg-slate-900 text-white px-6 py-3 rounded-3xl text-xs font-black shadow-sm active:scale-95 flex items-center gap-2"
                                >
                                    <LucideIcon name="copy" className="w-4 h-4" /> ë³µì‚¬
                                </button>

                                <button
                                    type="button"
                                    onClick={overwriteAuto}
                                    className="bg-white border border-slate-200 hover:border-slate-400 text-slate-800 px-6 py-3 rounded-3xl text-xs font-black shadow-sm active:scale-95 flex items-center gap-2"
                                >
                                    <LucideIcon name="wand-2" className="w-4 h-4" /> ìë™ ìƒì„±ë³¸ìœ¼ë¡œ ë®ì–´ì“°ê¸°
                                </button>

                                <div className="text-xs font-bold text-slate-500">
                                    â€» í¸ì§‘/ì €ì¥ì„ ì›í•˜ë©´ ì•„ë˜ë¥¼ ìˆ˜ì •í•˜ê³  â€œì „ì²´ ì €ì¥â€ì„ ëˆ„ë¥´ì„¸ìš”.
                                </div>
                            </div>

                            <TextAreaField
                                label="1í˜ì´ì§€ ìš”ì•½(ìë™ êµ¬ì„± + í¸ì§‘ ê°€ëŠ¥)"
                                name="sR_onepage"
                                value={onePageValue}
                                onChange={handleInput}
                                height="h-[520px]"
                                bgColor="bg-slate-900"
                                textColor="text-white"
                                placeholder="ìë™ ìƒì„±ëœ 1í˜ì´ì§€ ìš”ì•½ì´ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤."
                            />
                        </div>
                    );
                }

                case 6: {
                    const autoReport = buildFinalReport(studentInfo, sessionData);
                    const reportValue = norm(sessionData.sR_report) ? sessionData.sR_report : autoReport;

                    const copyToClipboard = async () => {
                        try {
                            await navigator.clipboard.writeText(reportValue);
                            alert("íƒêµ¬ë³´ê³ ì„œë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆìŠµë‹ˆë‹¤.");
                        } catch (e) {
                            alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ê¶Œí•œì„ í™•ì¸í•´ ì£¼ì„¸ìš”.");
                        }
                    };

                    const overwriteAuto = () => {
                        const evt = { target: { name: "sR_report", value: autoReport } };
                        handleInput(evt);
                    };

                    return (
                        <div className="fade-in space-y-10">
                            <SectionHeader
                                title="íƒêµ¬ë³´ê³ ì„œ ì™„ì„±"
                                subTitle="Auto Compose from 1~4ì°¨ì‹œ"
                                btnText="AI ë¬¸ì¥ ë‹¤ë“¬ê¸°"
                                onBtnClick={handleAiConsult}
                            />
                            <ValidationCallout title="ë³´ê³ ì„œ ì™„ì„±ë„ ì ê²€" items={issues.report} />

                            <div className="bg-emerald-50/60 border border-emerald-100 rounded-[32px] p-8 font-bold text-emerald-900 text-sm leading-relaxed">
                                1~4ì°¨ì‹œ ì…ë ¥ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ìë™ êµ¬ì„±ë©ë‹ˆë‹¤.
                                ê·¸ëŒ€ë¡œ ì œì¶œí•˜ì§€ ë§ê³ , <b>ìˆ˜ì¹˜Â·ì¶œì²˜Â·í•œê³„</b>ë¥¼ ë°˜ë“œì‹œ í™•ì¸í•œ ë’¤ í¸ì§‘í•˜ì„¸ìš”.
                            </div>

                            <div className="flex items-center gap-3 flex-wrap">
                                <button
                                    type="button"
                                    onClick={copyToClipboard}
                                    className="bg-slate-900 text-white px-6 py-3 rounded-3xl text-xs font-black shadow-sm active:scale-95 flex items-center gap-2"
                                >
                                    <LucideIcon name="copy" className="w-4 h-4" /> ë³µì‚¬
                                </button>

                                <button
                                    type="button"
                                    onClick={overwriteAuto}
                                    className="bg-white border border-slate-200 hover:border-slate-400 text-slate-800 px-6 py-3 rounded-3xl text-xs font-black shadow-sm active:scale-95 flex items-center gap-2"
                                >
                                    <LucideIcon name="wand-2" className="w-4 h-4" /> ìë™ ìƒì„±ë³¸ìœ¼ë¡œ ë®ì–´ì“°ê¸°
                                </button>

                                <div className="text-xs font-bold text-slate-500">
                                    â€» í¸ì§‘/ì €ì¥ì„ ì›í•˜ë©´ ì•„ë˜ ë³´ê³ ì„œë¥¼ ìˆ˜ì •í•˜ê³  â€œì „ì²´ ì €ì¥â€ì„ ëˆ„ë¥´ì„¸ìš”.
                                </div>
                            </div>

                            <TextAreaField
                                label="ì™„ì„±ëœ íƒêµ¬ë³´ê³ ì„œ(ìë™ êµ¬ì„± + í¸ì§‘ ê°€ëŠ¥)"
                                name="sR_report"
                                value={reportValue}
                                onChange={handleInput}
                                height="h-[520px]"
                                bgColor="bg-slate-900"
                                textColor="text-white"
                                placeholder="ìë™ ìƒì„±ëœ ë³´ê³ ì„œê°€ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤."
                            />
                        </div>
                    );
                }


                case 13:
  return <InquiryMethodPage />;





                default:
                    return <div className="p-10 text-center font-bold text-slate-400">ì„ íƒëœ íƒ­ì˜ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.</div>;
            }
        };

        /****************************************************************
         * 5) PrintView
         ****************************************************************/
        const PrintView = ({ studentInfo, sessionData, issueDate }) => (
            <div className="print-only print-root">
                {/* Cover */}
                <section className="print-section first">
                    <div className="avoid-break">
                        <div className="print-label">Research Workbook</div>
                        <h1 className="print-title">ì‹¬í™” íƒêµ¬ ê³¼ì • í†µí•© ì›Œí¬ë¶</h1>
                        <div className="print-subtitle">Comprehensive Research Workbook</div>
                    </div>

                    <div style={{ height: "10mm" }} />

                    <div className="print-card avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "10mm", padding: "8mm" }}>
                        <div className="print-label">Student</div>
                        <div className="print-body print-pre" style={{ marginTop: "2mm", fontWeight: 800 }}>
                            <div><b>í•™êµ</b>: {studentInfo.school || "ë¯¸ì…ë ¥"}</div>
                            <div><b>í•™ë²ˆ</b>: {studentInfo.gradeClass || "ë¯¸ì…ë ¥"}</div>
                            <div><b>ì´ë¦„</b>: {studentInfo.name || "ë¯¸ì…ë ¥"}</div>
                            <div><b>í¬ë§ ì „ê³µ</b>: {studentInfo.major || "ë¯¸ì…ë ¥"}</div>
                            <div><b>ë°œê¸‰ì¼</b>: {issueDate}</div>
                        </div>
                    </div>
                </section>

                {/* 1ì°¨ì‹œ */}
                <section className="print-section">
                    <h2 className="print-h2">01. 1ì°¨ì‹œ(ì£¼ì œÂ·ì§ˆë¬¸)</h2>

                    <div className="print-block avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "8mm", padding: "7mm", marginBottom: "6mm" }}>
                        <div className="print-label">Subject / Keywords</div>
                        <div className="print-small print-pre" style={{ marginTop: "2mm" }}>
                            - êµê³¼: {sessionData.s1_subject || "ë¯¸ì…ë ¥"}{"\n"}
                            - í‚¤ì›Œë“œ: {sessionData.s1_keywords || "ë¯¸ì…ë ¥"}
                        </div>
                    </div>

                    <div className="print-block avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "8mm", padding: "7mm", marginBottom: "6mm" }}>
                        <div className="print-label">Topic / RQ</div>
                        <div className="print-body" style={{ marginTop: "2mm", whiteSpace: "pre-wrap", fontWeight: 800 }}>
                            {sessionData.s1_topic || "ì£¼ì œ ë¯¸ì…ë ¥"}
                            {"\n\n"}
                            {sessionData.s1_question || "RQ ë¯¸ì…ë ¥"}
                        </div>
                    </div>

                    <div className="print-block avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "8mm", padding: "7mm" }}>
                        <div className="print-label">Motive / Scope</div>
                        <div className="print-small" style={{ marginTop: "2mm", whiteSpace: "pre-wrap" }}>
                            [ë™ê¸°]{"\n"}{sessionData.s1_motive || ""}{"\n\n"}
                            [ë²”ìœ„/ëŒ€ìƒ/ë³€ì¸]{"\n"}{sessionData.s1_scope || ""}
                        </div>
                    </div>
                </section>

                {/* 2ì°¨ì‹œ */}
                <section className="print-section">
                    <h2 className="print-h2">02. 2ì°¨ì‹œ(ìë£Œì¡°ì‚¬)</h2>

                    <div className="print-block avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "8mm", padding: "7mm", marginBottom: "6mm" }}>
                        <div className="print-label">Sources</div>
                        <div className="print-small print-pre" style={{ marginTop: "2mm" }}>
                            {buildSourcesText(sessionData)}
                        </div>
                    </div>

                    <div className="print-block avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "8mm", padding: "7mm" }}>
                        <div className="print-label">Synthesis</div>
                        <div className="print-small print-pre" style={{ marginTop: "2mm" }}>
                            {sessionData.s2_takeaway || ""}
                        </div>
                    </div>
                </section>

                {/* 3ì°¨ì‹œ */}
                <section className="print-section">
                    <h2 className="print-h2">03. 3ì°¨ì‹œ(ë°©ë²•Â·ê³¼ì •)</h2>

                    <div className="print-block avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "8mm", padding: "7mm", marginBottom: "6mm" }}>
                        <div className="print-label">Method</div>
                        <div className="print-small print-pre" style={{ marginTop: "2mm" }}>
                            - ê°€ì„¤/ì£¼ì¥: {sessionData.s3_hypothesis || ""}
                        </div>
                    </div>

                    <div className="print-block avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "8mm", padding: "7mm", marginBottom: "6mm" }}>
                        <div className="print-label">Variables / Process</div>
                        <div className="print-small print-pre" style={{ marginTop: "2mm" }}>
                            [ë³€ì¸/ì§€í‘œ/ì¸¡ì •]{"\n"}{sessionData.s3_variables || ""}{"\n\n"}
                            [ì ˆì°¨]{"\n"}{sessionData.s3_process || ""}
                        </div>
                    </div>

                    <div className="print-block avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "8mm", padding: "7mm" }}>
                        <div className="print-label">Data / Tools / Ethics</div>
                        <div className="print-small print-pre" style={{ marginTop: "2mm" }}>
                            [ë°ì´í„° ê³„íš]{"\n"}{sessionData.s3_data_plan || ""}{"\n\n"}
                            [ë„êµ¬]{"\n"}{sessionData.s3_tools || ""}{"\n\n"}
                            [ìœ¤ë¦¬/ì•ˆì „]{"\n"}{sessionData.s3_ethics_safety || ""}
                        </div>
                    </div>
                </section>

                {/* 4ì°¨ì‹œ */}
                <section className="print-section">
                    <h2 className="print-h2">04. 4ì°¨ì‹œ(ê²°ë¡ Â·ì„±ì°°)</h2>

                    <div className="print-block avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "8mm", padding: "7mm", marginBottom: "6mm" }}>
                        <div className="print-label">Findings</div>
                        <div className="print-small print-pre" style={{ marginTop: "2mm" }}>
                            {sessionData.s4_findings || ""}
                        </div>
                    </div>

                    <div className="print-block avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "8mm", padding: "7mm", marginBottom: "6mm" }}>
                        <div className="print-label">Conclusion</div>
                        <div className="print-body print-pre" style={{ marginTop: "2mm", fontWeight: 800 }}>
                            {sessionData.s4_conclusion || ""}
                        </div>
                    </div>

                    <div className="print-block avoid-break" style={{ border: "1px solid #e5e7eb", borderRadius: "8mm", padding: "7mm" }}>
                        <div className="print-label">Learning / Limits / Next</div>
                        <div className="print-small print-pre" style={{ marginTop: "2mm" }}>
                            [ë°°ìš´ ì ]{"\n"}{sessionData.s4_learning || ""}{"\n\n"}
                            [í•œê³„]{"\n"}{sessionData.s4_limits || ""}{"\n\n"}
                            [í›„ì†]{"\n"}{sessionData.s4_next || ""}
                        </div>
                    </div>
                </section>

                {/* 1í˜ì´ì§€ ìš”ì•½ */}
                <section className="print-section">
                    <h2 className="print-h2">05. 1í˜ì´ì§€ ìš”ì•½(ì œì¶œìš©)</h2>
                    <div className="print-block avoid-break" style={{ border: "1px solid #111827", borderRadius: "8mm", padding: "7mm" }}>
                        <div className="print-label">Executive Summary</div>
                        <div className="print-small print-pre" style={{ marginTop: "2mm" }}>
                            {(sessionData.sR_onepage || buildOnePageSummary(studentInfo, sessionData))}
                        </div>
                    </div>
                </section>

                {/* ìµœì¢… ë³´ê³ ì„œ */}
                <section className="print-section">
                    <h2 className="print-h2">06. íƒêµ¬ë³´ê³ ì„œ(ì™„ì„±ë³¸)</h2>
                    <div className="print-block avoid-break" style={{ border: "1px solid #111827", borderRadius: "8mm", padding: "7mm" }}>
                        <div className="print-label">Final Report</div>
                        <div className="print-small print-pre" style={{ marginTop: "2mm" }}>
                            {(sessionData.sR_report || buildFinalReport(studentInfo, sessionData))}
                        </div>
                    </div>
                </section>
            </div>
        );


        /****************************************************************
         * 6) ë©”ì¸ App
         ****************************************************************/
        const App = () => {
            const [personalCode, setPersonalCode] = useState("");
            const [activeUserKey, setActiveUserKey] = useState("");
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [serverStatus, setServerStatus] = useState("");
            const [studentInfo, setStudentInfo] = useState({ ...EMPTY_STUDENT });
            const [sessionData, setSessionData] = useState({ ...EMPTY_SESSION });
            const [activeTab, setActiveTab] = useState(0);
            const [aiLoading, setAiLoading] = useState(false);
            const [aiResult, setAiResult] = useState("");
            const [issueDate] = useState(() => new Date().toLocaleDateString());

            const refreshIcons = () => { if (window.lucide) window.lucide.createIcons(); };

            useEffect(() => {
                const timer = setTimeout(() => {
                    const loader = document.getElementById("loading-screen");
                    if (loader) {
                        loader.style.opacity = "0";
                        setTimeout(() => { loader.style.display = "none"; }, 500);
                    }
                    refreshIcons();
                }, 800);
                return () => clearTimeout(timer);
            }, []);

            useEffect(() => { setTimeout(refreshIcons, 100); }, [activeTab, aiResult, isLoggedIn]);

            // ë¡œê·¸ì¸(JSONP)
            const handleLogin = async () => {
                const code = personalCode.trim();
                if (!code) return setServerStatus("ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
                setServerStatus("ë°ì´í„° í™•ì¸ ì¤‘...");

                try {
                    const cb = `cb_${Date.now()}`;

                    const res = await new Promise((resolve, reject) => {
                        window[cb] = (data) => {
                            resolve(data);
                            try { delete window[cb]; } catch (_) { }
                        };

                        const script = document.createElement("script");
                        script.src = `${CONFIG.SCRIPT_URL}?userKey=${encodeURIComponent(code)}&callback=${cb}&nocache=${Date.now()}`;
                        script.onload = () => { script.remove(); };
                        script.onerror = () => { script.remove(); reject(new Error("ì„œë²„ ì—°ê²° ì‹¤íŒ¨")); };
                        document.body.appendChild(script);
                    });

                    if (res.ok) {
                        if (res.exists && res.data) {
                            setStudentInfo({
                                school: res.data.school || "",
                                gradeClass: res.data.gradeClass || "",
                                name: res.data.name || "",
                                major: res.data.major || ""
                            });

                            const nextSession = { ...EMPTY_SESSION };
                            Object.keys(EMPTY_SESSION).forEach((k) => {
                                if (res.data && Object.prototype.hasOwnProperty.call(res.data, k)) {
                                    nextSession[k] = res.data[k] ?? "";
                                }
                            });
                            setSessionData(nextSession);

                            setServerStatus("âœ… ë¡œë“œ ì™„ë£Œ");
                        } else {
                            setServerStatus("ğŸ†• ì‹ ê·œ ê³„ì •");
                            setStudentInfo({ ...EMPTY_STUDENT });
                            setSessionData({ ...EMPTY_SESSION });
                        }
                        setActiveUserKey(code);
                        setIsLoggedIn(true);
                    } else {
                        setServerStatus("âš ï¸ ì˜¤ë¥˜: " + (res.error || ""));
                    }
                } catch (e) {
                    setServerStatus("âš ï¸ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜");
                    console.error(e);
                }
            };

            // ì €ì¥ - Upsert
            const handleSaveAll = async () => {
                if (!isLoggedIn || !activeUserKey) return alert("ë¡œê·¸ì¸ í•„ìš”");

                /************************************************************
                 * (ì•„ì´ë””ì–´ 1) ì €ì¥ ì „ "ê²€ì¦ ê²½ê³ " ë„ìš°ê¸°
                 * - í•„ìˆ˜ ì…ë ¥ì´ ë¹„ì–´ìˆìœ¼ë©´ ê²½ê³  ëª©ë¡ì„ ë³´ì—¬ì£¼ê³ 
                 * - ì‚¬ìš©ìê°€ ì·¨ì†Œí•˜ë©´ ì €ì¥ì„ ì¤‘ë‹¨í•©ë‹ˆë‹¤.
                 ************************************************************/
                const warnings = [];

                // í•™ìƒ ì •ë³´(ê¸°ë³¸)
                if (!norm(studentInfo.school)) warnings.push("í•™êµëª…");
                if (!norm(studentInfo.gradeClass)) warnings.push("í•™ë²ˆ");
                if (!norm(studentInfo.name)) warnings.push("ì´ë¦„");
                if (!norm(studentInfo.major)) warnings.push("í¬ë§ ì „ê³µ");

                // íƒêµ¬ í•µì‹¬(ìµœì†Œ)
                if (!norm(sessionData.s1_subject)) warnings.push("1ì°¨ì‹œ: êµê³¼(ê³¼ëª©/ë‹¨ì›/ê°œë…)");
                if (!norm(sessionData.s1_keywords)) warnings.push("1ì°¨ì‹œ: ê´€ì‹¬ í‚¤ì›Œë“œ");
                if (!norm(sessionData.s1_topic)) warnings.push("1ì°¨ì‹œ: íƒêµ¬ ì£¼ì œ(ê°€ì œ)");
                if (!norm(sessionData.s1_question)) warnings.push("1ì°¨ì‹œ: íƒêµ¬ ì§ˆë¬¸(RQ)");
                if (!norm(sessionData.s3_process)) warnings.push("3ì°¨ì‹œ: ê³¼ì •(ë‹¨ê³„ë³„ ì ˆì°¨)");
                if (!norm(sessionData.s3_ethics_safety)) warnings.push("3ì°¨ì‹œ: ìœ¤ë¦¬/ì•ˆì „/ê°œì¸ì •ë³´");

                // ê²½ê³ ê°€ ìˆìœ¼ë©´ confirmìœ¼ë¡œ í•œ ë²ˆ ë” ë¬»ê¸°
                if (warnings.length) {
                    const msg =
                        "ì €ì¥ ì „ì— í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.\n" +
                        "ë‹¤ìŒ í•­ëª©ì´ ë¹„ì–´ìˆê±°ë‚˜ ë¶€ì¡±í•©ë‹ˆë‹¤:\n\n" +
                        warnings.map((w) => `- ${w}`).join("\n") +
                        "\n\nê·¸ë˜ë„ ì €ì¥í• ê¹Œìš”?";
                    const ok = window.confirm(msg);
                    if (!ok) {
                        setServerStatus("ì €ì¥ ì·¨ì†Œë¨(ê²€ì¦ ê²½ê³ )");
                        return;
                    }
                }

                // ì—¬ê¸°ë¶€í„° ì›ë˜ ì €ì¥ ë¡œì§
                setServerStatus("ì €ì¥ ì¤‘...");
                try {
                    const payload = { userKey: activeUserKey, ...sessionData, ...studentInfo };
                    const res = await fetch(CONFIG.SCRIPT_URL, {
                        method: "POST",
                        headers: { "Content-Type": "text/plain; charset=utf-8" },
                        body: JSON.stringify(payload)
                    });

                    const text = await res.text();
                    let json;
                    try { json = JSON.parse(text); }
                    catch (_) {
                        throw new Error("ì„œë²„ ì‘ë‹µì´ JSONì´ ì•„ë‹™ë‹ˆë‹¤.\n\nì‘ë‹µ ì¼ë¶€:\n" + text.slice(0, 300));
                    }

                    if (json.ok) {
                        const act = json.action === "updated" ? "ìˆ˜ì •" : "ì‹ ê·œì €ì¥";
                        setServerStatus(`âœ… ${act} ì™„ë£Œ (${json.timestamp || ""})`);
                        setTimeout(() => setServerStatus(""), 3000);
                    } else {
                        throw new Error(json.error || "ì €ì¥ ì‹¤íŒ¨");
                    }

                } catch (e) {
                    setServerStatus("âš ï¸ ì €ì¥ ì‹¤íŒ¨");
                    alert(e.message);
                }
            };

            // ì¸ì‡„/PDF
            const handlePrint = () => {
                try {
                    setServerStatus("ì¸ì‡„ ì°½ì„ ì—¬ëŠ” ì¤‘...");
                    // print CSS ì ìš©ë  ì‹œê°„ ì•½ê°„ í™•ë³´
                    setTimeout(() => {
                        window.print();
                        setTimeout(() => setServerStatus(""), 500);
                    }, 50);
                } catch (e) {
                    setServerStatus("âš ï¸ ì¸ì‡„ ì‹¤íŒ¨");
                    alert("ì¸ì‡„ë¥¼ ì‹¤í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.");
                }
            };


            const handleAskAI = async ({ promptText, systemText }) => {
                if (!promptText || !isLoggedIn) return alert("ì…ë ¥ í™•ì¸ ë° ë¡œê·¸ì¸ í•„ìš”");
                setAiLoading(true); setAiResult("");

                try {
                    const res = await fetch(CONFIG.SCRIPT_URL, {
                        method: "POST",
                        headers: { "Content-Type": "text/plain; charset=utf-8" },
                        body: JSON.stringify({
                            action: "askGemini",
                            prompt: promptText,
                            system: systemText,
                            userKey: activeUserKey,
                            model: CONFIG.GEMINI_MODEL
                        })
                    });

                    const text = await res.text();
                    let json;
                    try { json = JSON.parse(text); }
                    catch (_) { throw new Error("AI ì‘ë‹µì´ JSONì´ ì•„ë‹™ë‹ˆë‹¤:\n" + text.slice(0, 300)); }

                    if (json.ok) setAiResult(json.answer || "ì‘ë‹µ ì—†ìŒ");
                    else throw new Error(json.error);

                } catch (e) {
                    setAiResult("ì˜¤ë¥˜: " + e.message);
                } finally {
                    setAiLoading(false);
                }
            };

            // handleAiConsult
            // handleAiConsult
            const handleAiConsult = () => {
                const system = `
ì—­í• : ê³ ë“±í•™êµ í•™ìƒìš© íƒêµ¬ ì½”ì¹˜.
ëª©í‘œ: í•™ìƒ ì…ë ¥ì„ ê°œì¡°ì‹ìœ¼ë¡œ ëª…í™•í•˜ê³  ì´í•´í•˜ê¸° ì‰½ê²Œ ì •ë¦¬/ê°œì„ .

[ì¶œë ¥ í˜•ì‹ ê³ ì •]
- ë°˜ë“œì‹œ ë²ˆí˜¸ ê°œì¡°ì‹ (1) (2) (3) ...
- ê° í•­ëª© 1~2ë¬¸ì¥, í•œ í•­ëª© 80ì ë‚´ì™¸ ê¶Œì¥.
- ë¶ˆí•„ìš”í•œ ìˆ˜ì‹ì–´ ì‚­ì œ, í•µì‹¬ì–´ ì•ë°°ì¹˜.
- ê²°ê³¼ë¬¼ì€ í•™ìƒì´ ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ì–´ë„ ìì—°ìŠ¤ëŸ½ê²Œ.
- ë‚´ìš©ì´ ë¹„ì–´ìˆê±°ë‚˜ ì•½í•˜ë©´ ë§ˆì§€ë§‰ì— "ì¶”ê°€ë¡œ ì ì„ ê²ƒ(ì§ˆë¬¸ 3ê°œ)" í¬í•¨.
- ê³¼ì¥/í—ˆìœ„ ê¸ˆì§€. ì…ë ¥ì—ì„œ ë²—ì–´ë‚œ ì‚¬ì‹¤ ìƒì„± ê¸ˆì§€.
`.trim();

                let prompt = "";

                switch (activeTab) {
                    case 1:
                        prompt = `
[í¬ë§ ì „ê³µ] ${studentInfo.major}
[êµê³¼(ê³¼ëª©/ë‹¨ì›)] ${sessionData.s1_subject}
[ê´€ì‹¬ í‚¤ì›Œë“œ] ${sessionData.s1_keywords}
[íƒêµ¬ ì£¼ì œ(ê°€ì œ)] ${sessionData.s1_topic}
[íƒêµ¬ ë™ê¸°] ${sessionData.s1_motive}
[íƒêµ¬ ì§ˆë¬¸(RQ)] ${sessionData.s1_question}
[ë²”ìœ„/ëŒ€ìƒ/ë³€ì¸] ${sessionData.s1_scope}

(1) í‚¤ì›Œë“œ ì¬ì •ë¦¬(5~10ê°œ, ì¤‘ë³µ ì œê±°)
(2) ì£¼ì œ í•œ ì¤„ ì •ì˜(êµê³¼ê°œë…+ì§„ë¡œë¬¸ì œ)
(3) RQ 1ê°œ + í•˜ìœ„ì§ˆë¬¸ 2ê°œ(ì¸¡ì • ê°€ëŠ¥í•˜ê²Œ)
(4) ë³€ì¸/ì§€í‘œ/ëŒ€ìƒ/ê¸°ê°„ ì œì•ˆ 3ì¤„
(5) ì¶”ê°€ë¡œ ì ì„ ê²ƒ(ì§ˆë¬¸ 3ê°œ)
- "~í•©ë‹ˆë‹¤"ë¡œ í†µì¼
`.trim();
                        break;

                    case 2:
                        prompt = `
[ìë£Œ1] (${sessionData.s2_src1_type}) ${sessionData.s2_src1_title} / ${sessionData.s2_src1_ref}
[í•µì‹¬] ${sessionData.s2_src1_core}
[ì—°ê²°] ${sessionData.s2_src1_connect}

[ìë£Œ2] (${sessionData.s2_src2_type}) ${sessionData.s2_src2_title} / ${sessionData.s2_src2_ref}
[í•µì‹¬] ${sessionData.s2_src2_core}
[ì—°ê²°] ${sessionData.s2_src2_connect}

[ìë£Œ3] (${sessionData.s2_src3_type}) ${sessionData.s2_src3_title} / ${sessionData.s2_src3_ref}
[í•µì‹¬] ${sessionData.s2_src3_core}
[ì—°ê²°] ${sessionData.s2_src3_connect}

[ì¢…í•©] ${sessionData.s2_takeaway}

(1) ê° ìë£Œ í•µì‹¬ì„ 2ë¬¸ì¥ìœ¼ë¡œ ì••ì¶•(ë‚´ ë§ë¡œ)
(2) ë‚´ ì£¼ì œì— 'ì§ì ‘ ì“°ì¼' ê°œë…/ê·¼ê±°/ë°©ë²• 5ê°œ
(3) ê°€ì„¤/ë³€ì¸ í›„ë³´ 3ê°œ(ì¸¡ì • ì•„ì´ë””ì–´ í¬í•¨)
(4) ë³´ê³ ì„œì— ë°”ë¡œ ë„£ì„ ë¬¸ì¥ 3ê°œ(ì¶œì²˜ í‘œê¸° ìë¦¬ í¬í•¨)
(5) ì¶”ê°€ë¡œ ì ì„ ê²ƒ(ì§ˆë¬¸ 3ê°œ)
- "~í•©ë‹ˆë‹¤"
`.trim();
                        break;

                    case 3:
                        prompt = `
[ë°©ë²• ìœ í˜•] ${sessionData.s3_method_type}
[ê°€ì„¤/ì£¼ì¥] ${sessionData.s3_hypothesis}
[ë³€ì¸/ì§€í‘œ/ì¸¡ì •] ${sessionData.s3_variables}
[ì ˆì°¨] ${sessionData.s3_process}
[ë°ì´í„° ê³„íš] ${sessionData.s3_data_plan}
[ë„êµ¬] ${sessionData.s3_tools}
[ìœ¤ë¦¬/ì•ˆì „] ${sessionData.s3_ethics_safety}

(1) ë°©ë²• ì„¤ê³„ ì ê²€(ë¹ˆì¹¸/ëª¨í˜¸í•¨ 5ê°œ ì°¾ì•„ ìˆ˜ì •)
(2) ë‹¨ê³„ë³„ ì ˆì°¨ë¥¼ 'í–‰ë™ ë™ì‚¬'ë¡œ 6~10ë‹¨ê³„ ì¬ì‘ì„±
(3) ë°ì´í„°/ë¶„ì„(í‘œÂ·ê·¸ë˜í”„) ì‚°ì¶œë¬¼ 3ê°œ ì œì•ˆ
(4) ìœ¤ë¦¬/ì•ˆì „ ì²´í¬ë¦¬ìŠ¤íŠ¸ 6ê°œ
(5) ì¶”ê°€ë¡œ ì ì„ ê²ƒ(ì§ˆë¬¸ 3ê°œ)
- "~í•©ë‹ˆë‹¤"
`.trim();
                        break;

                    case 4:
                        prompt = `
[ê²°ê³¼] ${sessionData.s4_findings}
[ê²°ë¡ ] ${sessionData.s4_conclusion}
[ë°°ìš´ì ] ${sessionData.s4_learning}
[í•œê³„] ${sessionData.s4_limits}
[í›„ì†] ${sessionData.s4_next}

(1) ê²°ê³¼ë¥¼ 'ê·¼ê±° ë¬¸ì¥' 3ê°œë¡œ ì •ë¦¬(ìˆ˜ì¹˜ ìë¦¬ í¬í•¨)
(2) ê²°ë¡ ì„ RQì— ë‹µí•˜ëŠ” í˜•íƒœë¡œ 3~5ë¬¸ì¥ ì¬ì‘ì„±
(3) í•œê³„ 2~3ê°œë¥¼ ë” ì„¤ë“ë ¥ ìˆê²Œ(ê³¼ì¥ ë°©ì§€ ë¬¸ì¥)
(4) í›„ì† íƒêµ¬ 2~3ê°œë¥¼ ì‹¤í–‰ ê°€ëŠ¥í•œ ìˆ˜ì¤€ìœ¼ë¡œ êµ¬ì²´í™”
(5) ì„¸íŠ¹ì— ë“¤ì–´ê°ˆ ì—­ëŸ‰ í‚¤ì›Œë“œ 5ê°œ + ê·¼ê±°
- "~í•©ë‹ˆë‹¤"
`.trim();
                        break;

                    case 5:
                        prompt = `
[1í˜ì´ì§€ ìš”ì•½ ì´ˆì•ˆ]
${norm(sessionData.sR_onepage) ? sessionData.sR_onepage : buildOnePageSummary(studentInfo, sessionData)}

ìš”êµ¬:
(1) 1í˜ì´ì§€ì—ì„œ í•µì‹¬ì´ ë³´ì´ë„ë¡ ë¬¸ì¥ì„ ë” ì••ì¶•í•©ë‹ˆë‹¤.
(2) ì¶œì²˜/ìˆ˜ì¹˜/ê·¼ê±°ê°€ ì—†ëŠ” ë¶€ë¶„ì€ "ì¶”ê°€ í•„ìš”"ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.
(3) ê³¼ì¥ í‘œí˜„ ì œê±°, ë…¼ë¦¬ ë¹„ì•½ì„ ì¡ìŠµë‹ˆë‹¤.
(4) ìµœì¢… ê²°ê³¼ë¬¼ì€ ë²ˆí˜¸ ê°œì¡°ì‹(1)~(10) í˜•íƒœë¡œ ê°œì„  í¬ì¸íŠ¸ + ìˆ˜ì • ì˜ˆì‹œë¥¼ ì œê³µí•©ë‹ˆë‹¤.
- "~í•©ë‹ˆë‹¤"
`.trim();
                        break;

                    case 6:
                        prompt = `
[íƒêµ¬ë³´ê³ ì„œ ì´ˆì•ˆ]
${norm(sessionData.sR_report) ? sessionData.sR_report : buildFinalReport(studentInfo, sessionData)}

ìš”êµ¬:
(1) ê³ ë“±í•™ìƒ ë³´ê³ ì„œ í†¤ìœ¼ë¡œ ê°„ê²°í•˜ê²Œ ë‹¤ë“¬ìŠµë‹ˆë‹¤.
(2) ì‚¬ì‹¤/ìˆ˜ì¹˜/ì¶œì²˜ê°€ ì—†ëŠ” ë¶€ë¶„ì€ "ì¶”ê°€ í•„ìš”"ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.
(3) ê³¼ì¥ í‘œí˜„ ì œê±°, ë…¼ë¦¬ ë¹„ì•½/ê²°ë¡  ì í”„ë¥¼ ì¡ìŠµë‹ˆë‹¤.
(4) (1)~(12) ê°œì„  í¬ì¸íŠ¸ + ìˆ˜ì • ì˜ˆì‹œ 1ì¤„ì”© ì œì‹œí•©ë‹ˆë‹¤.
- "~í•©ë‹ˆë‹¤"
`.trim();
                        break;

                    default:
                        prompt = `
(1) í•µì‹¬ ìš”ì•½ 3ì¤„
(2) ì¢‹ì€ ì  2ì¤„
(3) ë³´ì™„í•  ì  3ì¤„
(4) ë‹¤ìŒ í–‰ë™ ì²´í¬ë¦¬ìŠ¤íŠ¸ 5ê°œ
- "~í•©ë‹ˆë‹¤"
`.trim();
                }

                // âœ… ì‹¤ì œ AI í˜¸ì¶œ(ì´ê²Œ ì—†ìœ¼ë©´ ë²„íŠ¼ ëˆŒëŸ¬ë„ ì•„ë¬´ ì¼ë„ ì•ˆ ì¼ì–´ë‚¨)
                handleAskAI({ promptText: prompt, systemText: system });
            };

            // í•™ìƒ ì •ë³´ ì…ë ¥
            const handleStudent = (e) => {
                const { name, value } = e.target;
                setStudentInfo((prev) => ({ ...prev, [name]: value }));
            };

            // ì„¸ì…˜ ì…ë ¥
            const handleInput = (e) => {
                const { name, value } = e.target;
                setSessionData((prev) => ({ ...prev, [name]: value }));
            };

            const handleLogout = () => {
                setIsLoggedIn(false);
                setActiveUserKey("");
                setPersonalCode("");
                setServerStatus("");
                setStudentInfo({ ...EMPTY_STUDENT });
                setSessionData({ ...EMPTY_SESSION });
                setActiveTab(0);
                setAiResult("");
                setAiLoading(false);
            };

            const handleCloseAi = () => setAiResult("");

            // âœ… ì—¬ê¸°ì„œë¶€í„° í™”ë©´ ë Œë”ë§(return)ì´ ë°˜ë“œì‹œ ìˆì–´ì•¼ í•¨
            if (!isLoggedIn) {
                return (
                    <LoginScreen
                        personalCode={personalCode}
                        setPersonalCode={setPersonalCode}
                        handleLogin={handleLogin}
                        serverStatus={serverStatus}
                    />
                );
            }

            return (
                <div>
                    {/* ===== í™”ë©´(UI) ì˜ì—­: ì¸ì‡„ì—ì„œëŠ” ìˆ¨ê¹€ ===== */}
                    <div className="no-print">
                        <Header
                            serverStatus={serverStatus}
                            handleSaveAll={handleSaveAll}
                            handlePrint={handlePrint}
                            handleLogout={handleLogout}
                        />

                        <TabNavigation
                            activeTab={activeTab}
                            setActiveTab={setActiveTab}
                            setAiResult={setAiResult}
                        />

                        <main className="max-w-6xl mx-auto px-4 md:px-10 py-10">
                            <AiResultBox loading={aiLoading} result={aiResult} onClose={handleCloseAi} />

                            <TabContent
                                activeTab={activeTab}
                                studentInfo={studentInfo}
                                sessionData={sessionData}
                                handleStudent={handleStudent}
                                handleInput={handleInput}
                                handleAiConsult={handleAiConsult}
                                aiLoading={aiLoading}
                            />
                        </main>
                    </div>

                    {/* ===== ì¸ì‡„ ì „ìš©(PrintView): ë°˜ë“œì‹œ no-print ë°”ê¹¥ì— ìˆì–´ì•¼ ì¶œë ¥ë¨ ===== */}
                    <PrintView
                        studentInfo={studentInfo}
                        sessionData={sessionData}
                        issueDate={issueDate}
                    />
                </div>
            );

        };

        // âœ… ë Œë”ë§ì€ ë°˜ë“œì‹œ App ì •ì˜ â€œë°–â€ì—ì„œ 1ë²ˆë§Œ
        ReactDOM.createRoot(document.getElementById("root")).render(<App />);
        ReactDOM.createRoot(document.getElementById("root")).render(<App />);

        const root = ReactDOM.createRoot(document.getElementById("root"));
        root.render(<App />);

    </script>
</body>

</html>
