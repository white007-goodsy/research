<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì‹¬í™” íƒêµ¬ í†µí•© ì›Œí¬ë¶ ì‹œìŠ¤í…œ (ì„œë²„ ì €ì¥ B)</title>

  <!-- í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&display=swap');

    * { box-sizing: border-box; }
    body {
      font-family: 'Noto Sans KR', sans-serif;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
      background-color: #f8fafc;
      margin: 0;
      color: #0f172a;
      word-break: keep-all;
    }

    .scrollbar-hide::-webkit-scrollbar { display: none; }

    /* ë¡œë”© í™”ë©´ ìŠ¤íƒ€ì¼ */
    #loading-screen {
      position: fixed; inset: 0;
      background: #0f172a; color: white;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      z-index: 9999;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* í˜ì´ë“œ ì¸ ì• ë‹ˆë©”ì´ì…˜ */
    .fade-in { animation: fadeIn 0.4s ease-out; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ì¸ì‡„ ìµœì í™” ìŠ¤íƒ€ì¼ */
    @media print {
      .no-print { display: none !important; }
      .print-only { display: block !important; }
      body { background: white !important; margin: 0 !important; padding: 0 !important; }
      #root { display: block !important; }
      .page-break { page-break-after: always; }
      .page { 
        border: none !important; 
        box-shadow: none !important; 
        margin: 0 !important; 
        width: 100% !important;
        min-height: 297mm; /* A4 ë†’ì´ ë³´ì¥ */
        padding: 20mm !important;
      }
    }
    .print-only { display: none; }

    /* ì»¤ìŠ¤í…€ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .btn-ai-glow {
      background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
      transition: all 0.3s ease;
    }
    .btn-ai-glow:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px -5px rgba(79, 70, 229, 0.5);
    }
  </style>
</head>

<body>
  <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
  <div id="loading-screen">
    <div style="width:40px;height:40px;border:4px solid #6366f1;border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:20px;"></div>
    <p style="font-weight:900;letter-spacing:2px;">SYSTEM LOADING...</p>
    <p style="font-size:12px;color:#94a3b8;margin-top:6px;">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”.</p>
  </div>

  <!-- React Mount Point -->
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    /**
     * =========================
     * ì‹œìŠ¤í…œ ì„¤ì • (CONFIG)
     * =========================
     * [ì¤‘ìš”] SCRIPT_URLì€ ë³¸ì¸ì´ ë°°í¬í•œ GAS ì›¹ ì•± URLë¡œ êµì²´í•´ì•¼ í•©ë‹ˆë‹¤.
     */
    const CONFIG = {
      SCRIPT_URL: "https://script.google.com/macros/s/AKfycbxXxqcvTnjomn4jubLUlKOg6Y28AFxW14pAEWe4BmO1tfGjddOhfAXSMi2FtAkfHbSa/exec", 
      GEMINI_MODEL: "gemini-1.5-flash",
      APP_VERSION: "v3.9-FINAL",
      LOCAL_PREFIX: "master_serverB",
    };

    const EMPTY_STUDENT = { school: "", gradeClass: "", name: "", major: "" };

    const EMPTY_SESSION = {
      s1_motive: "", s1_question: "", s1_connection: "",
      s2_book: "", s2_author: "", s2_level: "ì „ê³µ ê¸°ì´ˆ(ê°œë¡ )", s2_part: "", s2_goal: "í•™ìˆ  ë³´ê³ ì„œ",
      s3_depth: "", s3_trace: "",
      s4_keyword: "", s4_fact: "",
      s5_log: "", s5_error: "", s5_result: "",
      s8_claim: "", s8_growth: "", s8_next: "", s8_summary: "",
    };

    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í‚¤ ìƒì„±ê¸°
    const makeLocalKey = (userKey, kind) => {
      const safe = String(userKey || "").trim();
      return `${CONFIG.LOCAL_PREFIX}:${CONFIG.APP_VERSION}:${safe}:${kind}`;
    };

    // =================================================================================================
    // Main App Component
    // =================================================================================================
    const App = () => {
      // 1. ìƒíƒœ ê´€ë¦¬ Hooks
      const [personalCode, setPersonalCode] = useState("");
      const [activeUserKey, setActiveUserKey] = useState(""); 
      const [isLoggedIn, setIsLoggedIn] = useState(false);
      const [serverStatus, setServerStatus] = useState("");

      const [studentInfo, setStudentInfo] = useState({ ...EMPTY_STUDENT });
      const [sessionData, setSessionData] = useState({ ...EMPTY_SESSION });

      const [activeTab, setActiveTab] = useState(0);
      const [aiLoading, setAiLoading] = useState(false);
      const [aiResult, setAiResult] = useState("");
      const [saveStatus, setSaveStatus] = useState("");
      const [issueDate] = useState(() => new Date().toLocaleDateString());

      // ì•„ì´ì½˜ ë¦¬í”„ë ˆì‹œ (Lucide)
      const refreshIcons = () => { if (window.lucide) window.lucide.createIcons(); };

      // ì´ˆê¸° ë¡œë”© í™”ë©´ ì œì–´
      useEffect(() => {
        const timer = setTimeout(() => {
          const loader = document.getElementById("loading-screen");
          if (loader) {
            loader.style.transition = "opacity 0.5s ease";
            loader.style.opacity = "0";
            setTimeout(() => { loader.style.display = "none"; }, 500);
          }
          refreshIcons();
        }, 500);
        return () => clearTimeout(timer);
      }, []);

      // íƒ­ ë³€ê²½ ì‹œ ì•„ì´ì½˜ ê°±ì‹ 
      useEffect(() => {
        const t = setTimeout(refreshIcons, 100);
        return () => clearTimeout(t);
      }, [activeTab, aiResult, aiLoading, isLoggedIn]);

      /**
       * =========================
       * ì„œë²„ ë° AI í†µì‹  í•¨ìˆ˜ (ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™”)
       * =========================
       */
      
      const handleAskAI = async ({ promptText, systemText }) => {
        if (!promptText) return alert("ë¶„ì„í•  ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        if (!isLoggedIn || !activeUserKey) return alert("ë¨¼ì € ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.");

        setAiLoading(true);
        setAiResult(""); // ì´ˆê¸°í™”

        try {
          // GAS ì„œë²„ë¡œ ìš”ì²­ ì „ì†¡
          const response = await fetch(CONFIG.SCRIPT_URL, {
            method: "POST",
            headers: { "Content-Type": "text/plain; charset=utf-8" },
            body: JSON.stringify({
              action: "askGemini",
              prompt: promptText,
              system: systemText,
              userKey: activeUserKey
            })
          });

          if (!response.ok) {
            throw new Error(`HTTP ì˜¤ë¥˜! ìƒíƒœ ì½”ë“œ: ${response.status}`);
          }

          const text = await response.text();
          let result;
          try {
            result = JSON.parse(text);
          } catch (e) {
            throw new Error("ì„œë²„ ì‘ë‹µì´ ì˜¬ë°”ë¥¸ JSON í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤: " + text.substring(0, 100));
          }

          if (result.ok) {
            setAiResult(result.answer || "AIê°€ ë‹µë³€ì„ ìƒì„±í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
          } else {
            // ì„œë²„ì—ì„œ ëª…ì‹œì ìœ¼ë¡œ ì—ëŸ¬ë¥¼ ë³´ë‚¸ ê²½ìš°
            throw new Error(result.error || "ì•Œ ìˆ˜ ì—†ëŠ” AI ì˜¤ë¥˜");
          }
        } catch (err) {
          console.error("AI Error ìƒì„¸:", err);
          
          const errorMsg = (err.message || "").toString();

          // ì‚¬ìš©ìì—ê²Œ í•´ê²° ë°©ë²•ì„ ì•ˆë‚´í•˜ëŠ” ì¹œì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€
          if (errorMsg.includes("Script Properties") || errorMsg.includes("API í‚¤") || errorMsg.includes("key")) {
            setAiResult(
              "âš ï¸ [ê´€ë¦¬ì ì„¤ì • í•„ìš”] Google Apps Scriptì— API í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤.\n\n" +
              "ğŸ’¡ í•´ê²° ë°©ë²• (ì„ ìƒë‹˜/ê´€ë¦¬ììš©):\n" +
              "1. Apps Script ì—ë””í„° ì ‘ì†\n" +
              "2. ì™¼ìª½ ë©”ë‰´ [í”„ë¡œì íŠ¸ ì„¤ì •(âš™ï¸)] í´ë¦­\n" +
              "3. ë§¨ ì•„ë˜ [ìŠ¤í¬ë¦½íŠ¸ ì†ì„±] -> [ì†ì„± ì¶”ê°€] í´ë¦­\n" +
              "4. ì†ì„±: GEMINI_API_KEY / ê°’: (ë°œê¸‰ë°›ì€ AI í‚¤) ì…ë ¥ í›„ ì €ì¥\n" +
              "5. ì €ì¥ í›„ ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”."
            );
          } else {
            setAiResult(`âš ï¸ ì˜¤ë¥˜ ë°œìƒ: ${errorMsg}\n\n(ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ê±°ë‚˜, GAS ë°°í¬ URLì„ í™•ì¸í•´ì£¼ì„¸ìš”.)`);
          }
        } finally {
          setAiLoading(false);
        }
      };

      // íƒ­ë³„ ë§ì¶¤ í”„ë¡¬í”„íŠ¸ ìƒì„±ê¸°
      const handleAiConsult = () => {
        const system = "ë„ˆëŠ” ê³ ë“±í•™ìƒì˜ ì‹¬í™” íƒêµ¬ë¥¼ ë•ëŠ” ì…ì‹œÂ·í•™ìˆ  ì½”ì¹˜ë‹¤. ë°˜ë“œì‹œ 'ì£¼ì¥-ê·¼ê±°-ì„¤ëª…(ì£¼ê·¼ì„¤)' êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ê³ , í•™ìƒì´ ì‹¤ì œë¡œ í•  ìˆ˜ ìˆëŠ” ë‹¤ìŒ í–‰ë™ì„ êµ¬ì²´ì ìœ¼ë¡œ ì œì‹œí•œë‹¤.";
        let prompt = "";

        switch(activeTab) {
          case 1:
            prompt = `[í¬ë§ì „ê³µ: ${studentInfo.major}]\n[íƒêµ¬ë™ê¸°: ${sessionData.s1_motive}]\n[í˜„ì¬ì§ˆë¬¸: ${sessionData.s1_question}]\nì´ ì§ˆë¬¸ì„ ë” í•™ìˆ ì ì´ê³  ê³ ë“±í•™ìƒ ìˆ˜ì¤€ì—ì„œ ê²€ì¦ ê°€ëŠ¥í•œ ë¬¸ì¥ìœ¼ë¡œ 3ê°œ ì œì•ˆí•˜ê³ , í•„ìš”í•œ ë³€ì¸ì„ ì„¤ëª…í•´ì¤˜.`;
            break;
          case 2:
            prompt = `[ë„ì„œëª…: ${sessionData.s2_book}]\n[ëª©í‘œ: ${sessionData.s2_goal}]\nì´ ì±…ì„ í™œìš©í•˜ì—¬ ${studentInfo.major} ì „ê³µê³¼ ê´€ë ¨ëœ ì‹¬í™” íƒêµ¬ ê³„íšì„ ì„¸ì›Œì¤˜.`;
            break;
          case 3:
            prompt = `[ë„ì„œ ì‹¬í™” ë‚´ìš©: ${sessionData.s3_depth}]\nì´ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ êµê³¼ì„œ ê°œë…ê³¼ ì—°ê²°ëœ í•™ìˆ ì  ì›ë¦¬ë¥¼ ì„¤ëª…í•˜ê³  ì¶”ê°€ë¡œ ì½ì–´ë³¼ë§Œí•œ ë…¼ë¬¸ í‚¤ì›Œë“œë¥¼ ì¶”ì²œí•´ì¤˜.`;
            break;
          case 4:
            prompt = `[í‚¤ì›Œë“œ: ${sessionData.s4_keyword}]\n[í•µì‹¬ ë°ì´í„°: ${sessionData.s4_fact}]\nì´ ë°ì´í„°ë¥¼ ê·¼ê±°ë¡œ í™œìš©í•˜ì—¬ íƒêµ¬ ë³´ê³ ì„œ ë³¸ë¬¸ì— ë“¤ì–´ê°ˆ ë…¼ë¦¬ì ì¸ ë¬¸ë‹¨(ì£¼ì¥-ê·¼ê±°-ì„¤ëª…)ì„ 3ê°œ ì‘ì„±í•´ì¤˜.`;
            break;
          case 5:
            prompt = `[ìˆ˜í–‰ ê¸°ë¡: ${sessionData.s5_log}]\n[ì‹¤íŒ¨ ê¸°ë¡: ${sessionData.s5_error}]\nì´ ê³¼ì •ì—ì„œ ë“œëŸ¬ë‚œ í•™ìƒì˜ ë¬¸ì œí•´ê²° ì—­ëŸ‰ì„ í‰ê°€í•˜ê³ , ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ë³´ì™„í•´ì•¼ í•  ì ì„ ì¡°ì–¸í•´ì¤˜.`;
            break;
          case 8:
            prompt = `[ìµœì¢…ì£¼ì¥: ${sessionData.s8_claim}]\n[ì„±ì¥ì : ${sessionData.s8_growth}]\n[í›„ì†íƒêµ¬: ${sessionData.s8_next}]\nì´ ë‚´ìš©ì„ ì¢…í•©í•˜ì—¬ ìƒí™œê¸°ë¡ë¶€ ì„¸ë¶€ëŠ¥ë ¥ ë° íŠ¹ê¸°ì‚¬í•­(ì„¸íŠ¹)ì— ë“¤ì–´ê°ˆ ë§Œí•œ 500ì ë‚´ì™¸ì˜ ìš”ì•½ê¸€ì„ ì‘ì„±í•´ì¤˜.`;
            break;
          default:
            prompt = `í˜„ì¬ íƒêµ¬ì˜ ${activeTab}ë‹¨ê³„ì…ë‹ˆë‹¤. í•™ìƒì´ ë” ê¹Šì´ ìˆëŠ” íƒêµ¬ë¥¼ ìœ„í•´ ì ê²€í•´ì•¼ í•  ì²´í¬ë¦¬ìŠ¤íŠ¸ 5ê°€ì§€ë¥¼ ì•Œë ¤ì¤˜.`;
        }
        handleAskAI({ promptText: prompt, systemText: system });
      };

      // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (JSONP ë°©ì‹)
      const handleLogin = async () => {
        const code = personalCode.trim();
        if (!code) return setServerStatus("ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        setServerStatus("ë°ì´í„° í™•ì¸ ì¤‘...");

        try {
          const cb = `cb_${Date.now()}`;
          const res = await new Promise((resolve, reject) => {
            window[cb] = resolve;
            const script = document.createElement("script");
            script.src = `${CONFIG.SCRIPT_URL}?userKey=${encodeURIComponent(code)}&callback=${cb}`;
            script.onerror = () => reject(new Error("ì„œë²„ ì—°ê²° ì‹¤íŒ¨"));
            document.body.appendChild(script);
          });

          if (res.ok && res.exists) {
            const d = res.data;
            setStudentInfo({ 
              school: d.school || "", gradeClass: d.gradeClass || "", 
              name: d.name || "", major: d.major || "" 
            });
            setSessionData({ ...EMPTY_SESSION, ...d });
            setServerStatus("âœ… ë°ì´í„° ë¡œë“œ ì™„ë£Œ");
          } else if (res.ok && !res.exists) {
            setServerStatus("ğŸ†• ì‹ ê·œ ê³„ì •ì…ë‹ˆë‹¤");
          } else {
            setServerStatus("âš ï¸ ì˜¤ë¥˜: " + res.error);
          }
          setActiveUserKey(code);
          setIsLoggedIn(true);
          saveToLocal(code);
        } catch (e) {
          setServerStatus("âš ï¸ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜");
          console.error(e);
        }
      };

      // ë°ì´í„° ì €ì¥ (POST ë°©ì‹)
      const handleSaveAll = async () => {
        if (!isLoggedIn || !activeUserKey) return alert("ë¡œê·¸ì¸ ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤.");
        setServerStatus("ì„œë²„ ì €ì¥ ì¤‘...");
        try {
          const res = await fetch(CONFIG.SCRIPT_URL, {
            method: "POST",
            headers: { "Content-Type": "text/plain; charset=utf-8" },
            body: JSON.stringify({ userKey: activeUserKey, ...studentInfo, ...sessionData })
          });
          const json = await res.json();
          if (json.ok) {
            setServerStatus("âœ… ì €ì¥ ì™„ë£Œ");
            saveToLocal(activeUserKey);
            setTimeout(() => setServerStatus(""), 3000);
          } else {
            throw new Error(json.error);
          }
        } catch (e) {
          setServerStatus("âš ï¸ ì €ì¥ ì‹¤íŒ¨");
          console.error(e);
        }
      };

      // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í—¬í¼
      const saveToLocal = (userKey) => {
        try {
          localStorage.setItem(makeLocalKey(userKey, "info"), JSON.stringify(studentInfo));
          localStorage.setItem(makeLocalKey(userKey, "data"), JSON.stringify(sessionData));
        } catch (e) {}
      };
      
      const loadFromLocal = (userKey) => {
        try {
          const info = localStorage.getItem(makeLocalKey(userKey, "info"));
          const data = localStorage.getItem(makeLocalKey(userKey, "data"));
          if(info) setStudentInfo(JSON.parse(info));
          if(data) setSessionData({...EMPTY_SESSION, ...JSON.parse(data)});
        } catch (e) {}
      };

      const handleLogout = () => {
        setIsLoggedIn(false); setActiveUserKey(""); setPersonalCode("");
        setStudentInfo({...EMPTY_STUDENT}); setSessionData({...EMPTY_SESSION}); setAiResult("");
        setServerStatus("");
      };

      const handleInput = (e) => {
        const { name, value } = e.target;
        setSessionData(prev => ({ ...prev, [name]: value }));
      };

      const handleStudent = (e) => {
        const { name, value } = e.target;
        setStudentInfo(prev => ({ ...prev, [name]: value }));
      };

      // íƒ­ ë©”ë‰´ ì •ì˜
      const tabs = [
        { id: 0, title: "ì •ë³´ ì…ë ¥", icon: "user", color: "bg-slate-900" },
        { id: 11, title: "ìë£Œê²€ìƒ‰ ë¹„ë²•", icon: "search", color: "bg-amber-600" },
        { id: 1, title: "1ì°¨ì‹œ: ì§ˆë¬¸", icon: "clipboard-list", color: "bg-indigo-600" },
        { id: 2, title: "2ì°¨ì‹œ: ê³„íš", icon: "calendar", color: "bg-indigo-600" },
        { id: 3, title: "3ì°¨ì‹œ: ë„ì„œë¶„ì„", icon: "book-open", color: "bg-indigo-600" },
        { id: 4, title: "4ì°¨ì‹œ: ë…¼ë¬¸ë¶„ì„", icon: "file-text", color: "bg-indigo-600" },
        { id: 13, title: "íƒêµ¬ ë°©ë²•ë¡ ", icon: "bar-chart-3", color: "bg-indigo-600" },
        { id: 5, title: "5~7ì°¨ì‹œ: ìˆ˜í–‰", icon: "wand-2", color: "bg-indigo-600" },
        { id: 12, title: "AI ê°€ì´ë“œ", icon: "shield-check", color: "bg-rose-600" },
        { id: 8, title: "8~10ì°¨ì‹œ: ì„±ì°°", icon: "graduation-cap", color: "bg-indigo-600" },
      ];

      const Label = ({ children }) => (
        <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">{children}</label>
      );

      return (
        <div className="flex flex-col min-h-screen relative">
          
          {/* ë¡œê·¸ì¸ í™”ë©´ (isLoggedIn falseì¼ ë•Œ) */}
          {!isLoggedIn && (
            <div className="fixed inset-0 z-[1000] bg-slate-900 flex items-center justify-center p-6">
              <div className="w-full max-w-md bg-white rounded-[48px] p-12 shadow-2xl fade-in text-center border border-white/20">
                <div className="mb-8 flex justify-center">
                  <div className="bg-indigo-100 p-4 rounded-3xl text-indigo-600">
                    <i data-lucide="key" className="w-8 h-8"></i>
                  </div>
                </div>
                <h2 className="text-3xl font-black text-slate-900 tracking-tight">ê°œì¸ ì½”ë“œ ë¡œê·¸ì¸</h2>
                <p className="text-slate-500 mt-3 font-medium text-sm">ê¸°ì¡´ ì €ì¥ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê±°ë‚˜ ìƒˆë¡œ ì‹œì‘í•©ë‹ˆë‹¤.</p>
                <input
                  value={personalCode}
                  onChange={e => setPersonalCode(e.target.value)}
                  onKeyDown={e => e.key === 'Enter' && handleLogin()}
                  className="mt-10 w-full p-6 rounded-3xl bg-slate-100 border-2 border-transparent focus:border-indigo-500 outline-none font-black text-center text-2xl tracking-widest"
                  placeholder="ì˜ˆ: 20101í™ê¸¸ë™"
                />
                {serverStatus && <p className="mt-4 text-xs font-bold text-indigo-600 bg-indigo-50 py-2 rounded-full">{serverStatus}</p>}
                <button
                  onClick={handleLogin}
                  className="mt-8 w-full bg-slate-900 text-white py-5 rounded-[24px] font-black text-lg shadow-xl active:scale-95 transition-all"
                >
                  ì‹œìŠ¤í…œ ì ‘ì†
                </button>
                <div className="mt-8 text-[10px] text-slate-400 font-bold uppercase tracking-widest leading-relaxed">
                  * ì´ˆê¸° ì ‘ì† ì‹œ í•´ë‹¹ ì½”ë“œë¡œ ê³„ì •ì´ ìë™ ìƒì„±ë©ë‹ˆë‹¤.
                </div>
              </div>
            </div>
          )}

          {/* ë©”ì¸ UI (ë¡œê·¸ì¸ í›„) */}
          <div className="no-print flex-grow flex flex-col">
            
            {/* ìƒë‹¨ë°” */}
            <header className="bg-slate-900 text-white p-5 px-8 flex justify-between items-center sticky top-0 z-50 shadow-2xl">
              <div className="flex items-center gap-4">
                <div className="bg-indigo-500 p-2.5 rounded-2xl shadow-lg"><i data-lucide="zap" className="w-5 h-5"></i></div>
                <div>
                  <h1 className="text-xl font-black tracking-tighter leading-none">ì‹¬í™” íƒêµ¬ í†µí•© ì›Œí¬ë¶</h1>
                  <p className="text-slate-400 text-[9px] font-bold uppercase tracking-[0.3em] mt-1.5">Premium Research Master {CONFIG.APP_VERSION}</p>
                </div>
              </div>
              <div className="flex gap-2.5 items-center">
                {serverStatus && <span className="text-[10px] font-black bg-white/5 border border-white/10 px-4 py-2 rounded-xl">{serverStatus}</span>}
                <button onClick={handleSaveAll} className="bg-indigo-600 hover:bg-indigo-500 px-5 py-2.5 rounded-2xl text-xs font-black flex items-center gap-2 shadow-lg transition-all active:scale-95">
                  <i data-lucide="save" className="w-3.5 h-3.5"></i> ì„œë²„ ì €ì¥
                </button>
                <button onClick={() => window.print()} className="bg-white/10 hover:bg-white/20 px-5 py-2.5 rounded-2xl text-xs font-black flex items-center gap-2 border border-white/5 active:scale-95 transition-all">
                  <i data-lucide="printer" className="w-3.5 h-3.5"></i> ì¸ì‡„
                </button>
                <button onClick={handleLogout} className="bg-rose-600 hover:bg-rose-500 px-5 py-2.5 rounded-2xl text-xs font-black active:scale-95 transition-all">
                  ë¡œê·¸ì•„ì›ƒ
                </button>
              </div>
            </header>

            {/* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */}
            <nav className="bg-white border-b flex gap-1.5 overflow-x-auto p-3 px-6 scrollbar-hide sticky top-[76px] z-40 shadow-sm">
              {tabs.map(tab => (
                <button
                  key={tab.id}
                  onClick={() => { setActiveTab(tab.id); setAiResult(""); }}
                  className={`flex-shrink-0 px-5 py-3 rounded-2xl border font-black text-[11px] flex items-center gap-2.5 transition-all ${
                    activeTab === tab.id ? `${tab.color} text-white shadow-xl scale-105 ring-4 ring-indigo-50` : "bg-white text-slate-500 border-slate-100 hover:bg-slate-50"
                  }`}
                >
                  <i data-lucide={tab.icon} className="w-3.5 h-3.5"></i> {tab.title}
                </button>
              ))}
            </nav>

            {/* ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ */}
            <main className="flex-grow p-4 md:p-10 bg-slate-50">
              <div className="max-w-6xl mx-auto pb-32">
                
                {/* AI ê²°ê³¼ íŒì—… */}
                {(aiLoading || aiResult) && (
                  <div className="mb-10 bg-white border-2 border-indigo-100 rounded-[40px] p-10 shadow-2xl border-l-[16px] border-l-indigo-600 fade-in">
                    <div className="flex items-center justify-between mb-6 pb-6 border-b">
                      <div className="flex items-center gap-3 text-indigo-600 font-black text-lg">
                        <i data-lucide="sparkles" className="w-6 h-6"></i> AI íŠœí„°ì˜ íƒêµ¬ ì •ë°€ ì§„ë‹¨
                      </div>
                      <button onClick={() => setAiResult("")} className="text-slate-300 hover:text-slate-900 transition-colors">
                        <i data-lucide="x" className="w-6 h-6"></i>
                      </button>
                    </div>
                    {aiLoading ? (
                      <div className="flex flex-col items-center py-10">
                        <div className="w-12 h-12 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin mb-6"></div>
                        <p className="text-base font-bold text-slate-500 tracking-tight">í•™ìƒì˜ ë°ì´í„°ë¥¼ í•™ìˆ ì ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ ì²˜ë°©ì„ êµ¬ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
                      </div>
                    ) : (
                      <div className="text-base font-medium leading-relaxed whitespace-pre-wrap text-slate-800 bg-slate-50 p-8 rounded-3xl border border-slate-100 shadow-inner">
                        {aiResult}
                      </div>
                    )}
                  </div>
                )}

                {/* íƒ­ë³„ ì»¨í…ì¸  ì¹´ë“œ */}
                <div className="bg-white rounded-[56px] border border-slate-200 shadow-sm p-8 md:p-16 min-h-[700px] flex flex-col">

                  {/* íƒ­ 0: ì •ë³´ ì…ë ¥ */}
                  {activeTab === 0 && (
                    <div className="space-y-12 fade-in">
                      <div>
                        <h2 className="text-5xl font-black text-slate-900 tracking-tighter">ì •ë³´ ì…ë ¥</h2>
                        <p className="text-slate-400 font-black mt-2 text-sm uppercase tracking-[0.3em]">Personal Profile</p>
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-10">
                        {[
                          { id: "school", label: "í•™êµëª…", placeholder: "OOê³ ë“±í•™êµ" },
                          { id: "gradeClass", label: "í•™ë²ˆ", placeholder: "ì˜ˆ: 1111(4ìë¦¬)" },
                          { id: "name", label: "ì„±ëª…", placeholder: "í™ê¸¸ë™" },
                          { id: "major", label: "í¬ë§ ì „ê³µ", placeholder: "ì˜ˆ: ìƒëª…ê³µí•™" },
                        ].map(item => (
                          <div key={item.id} className="space-y-4">
                            <Label>{item.label}</Label>
                            <input
                              name={item.id}
                              value={studentInfo[item.id]}
                              onChange={handleStudent}
                              className="w-full p-6 rounded-3xl bg-slate-50 border-2 border-transparent focus:border-indigo-500 focus:bg-white outline-none font-black text-xl transition-all shadow-sm"
                              placeholder={item.placeholder}
                            />
                          </div>
                        ))}
                      </div>
                      <div className="mt-10 p-8 bg-indigo-50/50 rounded-[32px] border border-indigo-100 italic font-bold text-indigo-800 text-sm">
                        â€» ì…ë ¥ ì •ë³´ëŠ” ë¦¬í¬íŠ¸ì˜ í‘œì§€ ë° AI ë¶„ì„ ì‹œ ê¸°ì´ˆ ìë£Œë¡œ í™œìš©ë©ë‹ˆë‹¤.
                      </div>
                    </div>
                  )}

                  {/* íƒ­ 11: ìë£Œê²€ìƒ‰ ë¹„ë²• */}
                  {activeTab === 11 && (
                    <div className="space-y-10 fade-in">
                      <h2 className="text-4xl font-black text-amber-600 flex items-center gap-4">
                        <i data-lucide="search" className="w-10 h-10"></i> ìë£Œ ê²€ìƒ‰ ë¹„ë²• (R-Master)
                      </h2>
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div className="bg-amber-50 p-8 rounded-[40px] border border-amber-100 shadow-sm">
                          <h3 className="font-black text-amber-900 text-lg mb-4">â‘  í•™ìˆ DB í•„í„°ë§</h3>
                          <ul className="text-sm text-amber-800 font-bold space-y-3">
                            <li>- DBpia/RISS ìµœê·¼ 3ë…„ ì´ë‚´ ë…¼ë¬¸</li>
                            <li>- 'KCI ë“±ì¬' ë…¼ë¬¸ ìš°ì„  í™•ì¸</li>
                            <li>- ì´ˆë¡(Abstract)ì˜ ê²°ê³¼ ìœ„ì£¼ í™•ì¸</li>
                          </ul>
                        </div>
                        <div className="bg-indigo-50 p-8 rounded-[40px] border border-indigo-100 shadow-sm">
                          <h3 className="font-black text-indigo-900 text-lg mb-4">â‘¡ ê³ ê¸‰ ê²€ìƒ‰ ë¬¸ë²•</h3>
                          <ul className="text-sm text-indigo-800 font-bold space-y-3">
                            <li>- AND: ë‘ í‚¤ì›Œë“œ ëª¨ë‘ í¬í•¨</li>
                            <li>- OR: í•œ í‚¤ì›Œë“œë¼ë„ í¬í•¨</li>
                            <li>- " ": ì •í™•í•œ ë¬¸ì¥ ê²€ìƒ‰</li>
                          </ul>
                        </div>
                        <div className="bg-slate-900 p-8 rounded-[40px] text-white shadow-xl">
                          <h3 className="font-black text-indigo-400 text-lg mb-4">â‘¢ í†µê³„ ë° ì›ë°ì´í„°</h3>
                          <ul className="text-sm font-bold space-y-3">
                            <li>- KOSIS êµ­ê°€í†µê³„í¬í„¸</li>
                            <li>- ê³µê³µë°ì´í„°í¬í„¸(data.go.kr)</li>
                            <li>- ê° ê¸°ê´€ ë³´ë„ìë£Œ í†µê³„</li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  )}

                  {/* íƒ­ 1: 1ì°¨ì‹œ ì§ˆë¬¸ ìƒì„± */}
                  {activeTab === 1 && (
                    <div className="space-y-10 fade-in flex-grow">
                      <div className="flex justify-between items-center border-b pb-8">
                        <div>
                          <h2 className="text-4xl font-black text-slate-900 tracking-tighter">1ì°¨ì‹œ: íƒêµ¬ ì§ˆë¬¸ ìƒì„±</h2>
                          <p className="text-slate-400 font-bold mt-1 text-xs uppercase">Research Question & Motivation</p>
                        </div>
                        <button onClick={handleAiConsult} disabled={aiLoading} className="btn-ai-glow text-white px-8 py-4 rounded-3xl text-sm font-black flex items-center gap-2 active:scale-95 shadow-2xl">
                          <i data-lucide="sparkles" className="w-5 h-5 text-amber-300"></i> AI ì§ˆë¬¸ ì •êµí™” ìš”ì²­
                        </button>
                      </div>
                      <div className="space-y-10 flex-grow">
                        <div className="space-y-4">
                          <Label>íƒêµ¬ ë™ê¸° ë° ê³„ê¸°</Label>
                          <textarea
                            name="s1_motive"
                            value={sessionData.s1_motive}
                            onChange={handleInput}
                            className="w-full h-48 p-8 rounded-[40px] bg-slate-50 border-none outline-none font-medium text-base focus:ring-4 focus:ring-indigo-100 transition-all leading-relaxed"
                            placeholder="ìˆ˜ì—… ì¤‘ ìƒê¸´ ê¶ê¸ˆì¦ì´ë‚˜ ì‚¬íšŒì  ì‚¬ê±´ ë“± êµ¬ì²´ì ì¸ ë™ê¸°ë¥¼ ì‘ì„±í•˜ì„¸ìš”."
                          />
                        </div>
                        <div className="space-y-4">
                          <Label>í•µì‹¬ íƒêµ¬ ì§ˆë¬¸ (RQ)</Label>
                          <input
                            name="s1_question"
                            value={sessionData.s1_question}
                            onChange={handleInput}
                            className="w-full p-8 rounded-[32px] bg-indigo-50/50 border-2 border-indigo-100 focus:border-indigo-600 focus:bg-white outline-none font-black text-2xl text-indigo-950 transition-all shadow-sm"
                            placeholder="ì˜ˆ: AI ê¸°ë°˜ ë°ì´í„° ë¶„ì„ì´ ì˜ë£Œ ì§„ë‹¨ ì •í™•ë„ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ë¶„ì„"
                          />
                        </div>
                        <div className="space-y-4">
                          <Label>êµê³¼/ì „ê³µ ì—°ê²° ê³ ë¦¬</Label>
                          <textarea
                            name="s1_connection"
                            value={sessionData.s1_connection}
                            onChange={handleInput}
                            className="w-full h-32 p-8 rounded-[40px] bg-slate-50 outline-none font-medium text-base"
                            placeholder="êµê³¼ì„œì˜ ì–´ë–¤ ì›ë¦¬ê°€ ì „ê³µì˜ ì–´ë–¤ ê°œë…ê³¼ ì—°ê²°ë˜ë‚˜ìš”?"
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {/* íƒ­ 2: 2ì°¨ì‹œ ê³„íš */}
                  {activeTab === 2 && (
                    <div className="space-y-10 fade-in flex-grow">
                      <h2 className="text-4xl font-black text-slate-900 tracking-tighter border-b pb-8">2ì°¨ì‹œ: ë„ì„œ ë° íƒêµ¬ ê³„íš</h2>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-10">
                        <div className="space-y-4">
                          <Label>ì‹¬í™” ë„ì„œëª…</Label>
                          <input name="s2_book" value={sessionData.s2_book} onChange={handleInput} className="w-full p-6 rounded-3xl bg-slate-50 outline-none font-black text-xl" placeholder="ì±… ì œëª©" />
                        </div>
                        <div className="space-y-4">
                          <Label>ì €ì</Label>
                          <input name="s2_author" value={sessionData.s2_author} onChange={handleInput} className="w-full p-6 rounded-3xl bg-slate-50 outline-none font-black text-xl" placeholder="ì €ìëª…" />
                        </div>
                        <div className="space-y-4">
                          <Label>ë„ì„œ ë‚œì´ë„</Label>
                          <select name="s2_level" value={sessionData.s2_level} onChange={handleInput} className="w-full p-6 rounded-3xl bg-slate-50 font-black text-lg appearance-none outline-none focus:ring-4 focus:ring-indigo-100">
                            <option>ì „ê³µ ê¸°ì´ˆ(ê°œë¡ )</option><option>ì „ë¬¸ í•™ìˆ ì„œ</option><option>êµì–‘ì„œ</option><option>ì›ì „/ê³ ì „</option>
                          </select>
                        </div>
                        <div className="space-y-4">
                          <Label>ìµœì¢… ì‚°ì¶œë¬¼ ëª©í‘œ</Label>
                          <select name="s2_goal" value={sessionData.s2_goal} onChange={handleInput} className="w-full p-6 rounded-3xl bg-slate-50 font-black text-lg appearance-none outline-none focus:ring-4 focus:ring-indigo-100">
                            <option>í•™ìˆ  ë³´ê³ ì„œ</option><option>ë°ì´í„° ë¦¬í¬íŠ¸</option><option>ì‹¤í—˜ ë³´ê³ ì„œ</option><option>ì •ì±… ì œì•ˆì„œ</option>
                          </select>
                        </div>
                      </div>
                      <div className="space-y-4">
                        <Label>ì§‘ì¤‘ íƒë… ì§€ì  (ë°œì·Œë… ì±•í„°)</Label>
                        <input name="s2_part" value={sessionData.s2_part} onChange={handleInput} className="w-full p-6 rounded-3xl bg-indigo-50/50 border border-indigo-100 outline-none font-black text-xl" placeholder="ì˜ˆ: ì œ3ì¥ ë°ì´í„° ë¦¬í„°ëŸ¬ì‹œì˜ ì‹¤ì œì  ì ìš© ì‚¬ë¡€" />
                      </div>
                    </div>
                  )}

                  {/* íƒ­ 3: 3ì°¨ì‹œ ë„ì„œ ë¶„ì„ */}
                  {activeTab === 3 && (
                    <div className="space-y-10 fade-in flex-grow">
                      <div className="flex justify-between items-center border-b pb-8">
                        <h2 className="text-4xl font-black text-slate-900 tracking-tighter">3ì°¨ì‹œ: ë„ì„œ ì‹¬í™” ë¶„ì„</h2>
                        <button onClick={handleAiConsult} disabled={aiLoading} className="btn-ai-glow text-white px-8 py-4 rounded-3xl text-sm font-black active:scale-95 shadow-2xl">
                          <i data-lucide="book-open" className="w-5 h-5 inline-block mr-2"></i> ì§€ì‹ ì •êµí™” ì½”ì¹­
                        </button>
                      </div>
                      <div className="space-y-6">
                        <div className="space-y-4">
                          <Label>êµê³¼ì„œ ë„ˆë¨¸ì˜ ì§€ì‹ (Depth Analysis)</Label>
                          <textarea
                            name="s3_depth"
                            value={sessionData.s3_depth}
                            onChange={handleInput}
                            className="w-full h-80 p-10 rounded-[48px] bg-slate-50 border-none outline-none font-medium text-lg leading-relaxed shadow-inner"
                            placeholder="ë„ì„œë¥¼ í†µí•´ ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ í•™ìˆ ì  ì›ë¦¬ë¥¼ ìƒì„¸íˆ ì •ë¦¬í•˜ì„¸ìš”."
                          />
                        </div>
                        <div className="space-y-4">
                          <Label>ì¶”ê°€ ìë£Œ ì¶”ì </Label>
                          <input
                            name="s3_trace"
                            value={sessionData.s3_trace}
                            onChange={handleInput}
                            className="w-full p-6 rounded-3xl bg-slate-50 outline-none font-bold"
                            placeholder="ì±…ì—ì„œ ì–¸ê¸‰ëœ ë…¼ë¬¸ì´ë‚˜ ë‹¤ë¥¸ ë„ì„œ ë¦¬ìŠ¤íŠ¸"
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {/* íƒ­ 4: 4ì°¨ì‹œ ë…¼ë¬¸ ë¶„ì„ */}
                  {activeTab === 4 && (
                    <div className="space-y-10 fade-in flex-grow">
                      <div className="flex justify-between items-center border-b pb-8">
                        <div>
                          <h2 className="text-4xl font-black text-slate-900 tracking-tighter">4ì°¨ì‹œ: ë…¼ë¬¸ ë°ì´í„° ë¶„ì„</h2>
                          <p className="text-slate-400 font-bold mt-1 text-xs uppercase">Scholarly Evidence & Facts</p>
                        </div>
                        <button onClick={handleAiConsult} disabled={aiLoading} className="btn-ai-glow text-white px-8 py-4 rounded-3xl text-sm font-black flex items-center gap-2 active:scale-95">
                          <i data-lucide="bar-chart" className="w-5 h-5"></i> AI ì£¼ê·¼ì„¤ ë¬¸ì¥ ìƒì„±
                        </button>
                      </div>
                      <div className="space-y-10 flex-grow">
                        <div className="space-y-4">
                          <Label>ìµœì‹  í•™ìˆ  íŠ¸ë Œë“œ/í‚¤ì›Œë“œ</Label>
                          <textarea name="s4_keyword" value={sessionData.s4_keyword} onChange={handleInput} className="w-full h-32 p-8 rounded-[40px] bg-slate-50 outline-none font-medium" placeholder="ë…¼ë¬¸ë“¤ì—ì„œ ê³µí†µì ìœ¼ë¡œ ë‹¤ë£¨ëŠ” í•µì‹¬ ë¬¸ì œì˜ì‹" />
                        </div>
                        <div className="space-y-4">
                          <Label>í•µì‹¬ ìˆ«ìì™€ íŒ©íŠ¸ (Core Evidence)</Label>
                          <textarea
                            name="s4_fact"
                            value={sessionData.s4_fact}
                            onChange={handleInput}
                            className="w-full h-64 p-10 rounded-[48px] bg-indigo-50/30 border-2 border-dashed border-indigo-200 outline-none font-black text-lg text-indigo-900 leading-relaxed shadow-sm"
                            placeholder="ë³´ê³ ì„œì˜ ê·¼ê±°ê°€ ë  í†µê³„ ìˆ˜ì¹˜, ì‹¤í—˜ ê²°ê³¼, í‘œì˜ ë°ì´í„° ë“±ì„ ì¶œì²˜ì™€ í•¨ê»˜ ê¸°ë¡í•˜ì„¸ìš”."
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {/* íƒ­ 13: íƒêµ¬ ë°©ë²•ë¡  */}
                  {activeTab === 13 && (
                    <div className="space-y-12 fade-in">
                      <h2 className="text-4xl font-black text-indigo-600 tracking-tighter">ğŸ“Š íƒêµ¬ ë°©ë²•ë¡  ë§ˆìŠ¤í„° ê°€ì´ë“œ</h2>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div className="bg-indigo-50 p-10 rounded-[48px] border-2 border-indigo-100 shadow-sm relative overflow-hidden group">
                           <div className="absolute top-0 right-0 p-6 opacity-10 group-hover:scale-110 transition-transform"><i data-lucide="database" className="w-20 h-20"></i></div>
                           <h3 className="font-black text-indigo-900 text-2xl mb-4">â‘  ë°ì´í„° ì¬í•´ì„í˜•</h3>
                           <p className="text-sm text-indigo-800 leading-relaxed font-bold">ê³µê³µë°ì´í„°ë‚˜ í†µê³„ ìˆ˜ì¹˜ë¥¼ ìƒˆë¡œìš´ ê°€ì„¤ë¡œ ì—°ê²°í•˜ì—¬ ì‹œê°í™”í•˜ê³  ë¶„ì„í•©ë‹ˆë‹¤.</p>
                        </div>
                        <div className="bg-emerald-50 p-10 rounded-[48px] border-2 border-emerald-100 shadow-sm relative overflow-hidden group">
                           <div className="absolute top-0 right-0 p-6 opacity-10 group-hover:scale-110 transition-transform"><i data-lucide="shuffle" className="w-20 h-20"></i></div>
                           <h3 className="font-black text-emerald-900 text-2xl mb-4">â‘¡ ì‚¬ë¡€ ë¹„êµí˜•</h3>
                           <p className="text-sm text-emerald-800 leading-relaxed font-bold">ë™ì¼í•œ ë³€ì¸ì„ ê°€ì§„ ë‹¤ë¥¸ ì‚¬ë¡€ Aì™€ Bë¥¼ ëŒ€ì¡°í•˜ì—¬ ì°¨ì´ì˜ ì›ì¸ì„ íƒêµ¬í•©ë‹ˆë‹¤.</p>
                        </div>
                        <div className="bg-rose-50 p-10 rounded-[48px] border-2 border-rose-100 shadow-sm relative overflow-hidden group">
                           <div className="absolute top-0 right-0 p-6 opacity-10 group-hover:scale-110 transition-transform"><i data-lucide="test-tube" className="w-20 h-20"></i></div>
                           <h3 className="font-black text-rose-900 text-2xl mb-4">â‘¢ ê°€ì„¤ ì‹¤í—˜í˜•</h3>
                           <p className="text-sm text-rose-800 leading-relaxed font-bold">íŠ¹ì • ë³€ì¸ì„ í†µì œí•œ ìƒíƒœì—ì„œ ì‹¤í—˜ì„ ìˆ˜í–‰í•˜ê³  ì˜ˆì¸¡ê°’ê³¼ ì‹¤ì œê°’ì„ ë¹„êµí•©ë‹ˆë‹¤.</p>
                        </div>
                        <div className="bg-amber-50 p-10 rounded-[48px] border-2 border-amber-100 shadow-sm relative overflow-hidden group">
                           <div className="absolute top-0 right-0 p-6 opacity-10 group-hover:scale-110 transition-transform"><i data-lucide="pen-tool" className="w-20 h-20"></i></div>
                           <h3 className="font-black text-amber-900 text-2xl mb-4">â‘£ ì´ë¡  ì ìš©í˜•</h3>
                           <p className="text-sm text-amber-800 leading-relaxed font-bold">ì¶”ìƒì ì¸ ì „ê³µ ì´ë¡ ì„ ì‹¤ì œ ì‚¬íšŒ í˜„ìƒì´ë‚˜ ê¸°ì—… ì‚¬ë¡€ì— ëŒ€ì…í•˜ì—¬ ë¶„ì„í•©ë‹ˆë‹¤.</p>
                        </div>
                      </div>
                      <div className="bg-slate-900 p-10 rounded-[48px] text-white shadow-2xl">
                         <h3 className="font-black text-indigo-400 text-xl mb-4 tracking-tighter">ğŸ’¡ ì£¼ê·¼ì„¤ ë¬¸ì¥ ê³µì‹</h3>
                         <p className="text-lg leading-relaxed font-bold italic">"[ìë£Œì¶œì²˜/ì—°ë„]ì— ì˜í•˜ë©´ [A] ì§€í‘œê°€ [N] ìˆ˜ì¹˜ë¡œ ë‚˜íƒ€ë‚¨. ì´ëŠ” [í•™ìŠµí•œ ì›ë¦¬]ì— ë¹„ì¶”ì–´ ë³¼ ë•Œ [í•´ì„/ë¶„ì„]ìœ¼ë¡œ íŒë‹¨í•  ìˆ˜ ìˆìŒ."</p>
                      </div>
                    </div>
                  )}

                  {/* íƒ­ 5: 5~7ì°¨ì‹œ ìˆ˜í–‰ ê¸°ë¡ */}
                  {activeTab === 5 && (
                    <div className="space-y-10 fade-in flex-grow">
                      <div className="flex justify-between items-center border-b pb-8">
                        <div>
                          <h2 className="text-4xl font-black text-slate-900 tracking-tighter">5~7ì°¨ì‹œ: ìˆ˜í–‰ ë° ë…¸ë ¥ ê¸°ë¡</h2>
                          <p className="text-slate-400 font-bold mt-1 text-xs uppercase">Action Log & Failure Record</p>
                        </div>
                        <button onClick={handleAiConsult} disabled={aiLoading} className="btn-ai-glow text-white px-8 py-4 rounded-3xl text-sm font-black active:scale-95">
                           <i data-lucide="list-checks" className="w-5 h-5 inline-block mr-2"></i> ìˆ˜í–‰ ì½”ì¹­ ìš”ì²­
                        </button>
                      </div>
                      <div className="space-y-8 flex-grow">
                        <div className="space-y-4">
                          <Label>ì§„ì§œ ë…¸ë ¥ ì¼ì§€ (Action Log)</Label>
                          <textarea
                            name="s5_log"
                            value={sessionData.s5_log}
                            onChange={handleInput}
                            className="w-full h-48 p-8 rounded-[40px] bg-slate-50 border-none outline-none font-medium text-sm leading-relaxed shadow-inner"
                            placeholder="ë°©ë¬¸ ì‚¬ì´íŠ¸, ë°ì´í„° ê°€ê³µ ê³¼ì •, ì°¸ê³ í•œ ìˆ˜ì‹ ë“± êµ¬ì²´ì ì¸ í–‰ìœ„ë¥¼ ë‚ ì§œë³„ë¡œ ê¸°ë¡í•˜ì„¸ìš”."
                          />
                        </div>
                        <div className="space-y-4">
                          <Label>ì‹œí–‰ì°©ì˜¤ ë° ì‹¤íŒ¨ ê¸°ë¡ (Error Log)</Label>
                          <textarea
                            name="s5_error"
                            value={sessionData.s5_error}
                            onChange={handleInput}
                            className="w-full h-32 p-8 rounded-[40px] bg-rose-50/50 border-none outline-none font-medium text-sm text-rose-900 italic"
                            placeholder="ìë£Œê°€ ì—†ì–´ì„œ ì‹¤íŒ¨í–ˆê±°ë‚˜ ê°€ì„¤ì´ í‹€ë ¸ë˜ ì§€ì  ë“± ì‹¤íŒ¨ì˜ í”ì ì„ ì†”ì§íˆ ì ìœ¼ì„¸ìš”."
                          />
                        </div>
                        <div className="space-y-4">
                          <Label>ì¤‘ê°„ ì‚°ì¶œë¬¼ (Interim Result)</Label>
                          <textarea
                            name="s5_result"
                            value={sessionData.s5_result}
                            onChange={handleInput}
                            className="w-full h-32 p-8 rounded-[40px] bg-emerald-50/50 border-none outline-none font-black text-sm text-emerald-900"
                            placeholder="ë„ì¶œëœ í‘œ, ê·¸ë˜í”„ì˜ ìˆ˜ì¹˜ë‚˜ í•µì‹¬ ì¤‘ê°„ ê²°ë¡ ì„ ì ìœ¼ì„¸ìš”."
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {/* íƒ­ 12: AI ê°€ì´ë“œ */}
                  {activeTab === 12 && (
                    <div className="space-y-12 fade-in text-center py-16">
                      <div className="bg-rose-50 p-16 rounded-[80px] border-4 border-rose-100 max-w-3xl mx-auto shadow-2xl">
                         <i data-lucide="alert-triangle" className="w-20 h-20 text-rose-500 mx-auto mb-8"></i>
                         <h2 className="text-4xl font-black text-rose-900 tracking-tighter mb-6">AIëŠ” ë°œí’ˆì„ ëŒ€ì‹  íŒ”ì§€ ì•ŠìŠµë‹ˆë‹¤.</h2>
                         <p className="text-xl text-rose-800 leading-relaxed font-bold mb-10 italic">
                            ì‚¬ì •ê´€ì€ ë§¤ë„ëŸ¬ìš´ AI ë¬¸ì¥ë³´ë‹¤<br />ì—¬ëŸ¬ë¶„ì˜ ê±°ì¹ ê³  íˆ¬ë°•í•œ 'ì‹œí–‰ì°©ì˜¤ ê¸°ë¡'ì„ ë” ì‹ ë¢°í•©ë‹ˆë‹¤.
                         </p>
                         <div className="text-left bg-white/60 p-10 rounded-[40px] space-y-6 font-bold text-base text-rose-950 border border-rose-200 shadow-inner">
                            <p className="flex gap-4"><i data-lucide="check-circle" className="w-6 h-6 shrink-0 text-rose-600"></i> AIëŠ” ë…¼ë¦¬ êµ¬ì¡°ë¥¼ ì¡ëŠ” ë³´ì¡° ë„êµ¬ë¡œë§Œ í™œìš©í•˜ì„¸ìš”.</p>
                            <p className="flex gap-4"><i data-lucide="check-circle" className="w-6 h-6 shrink-0 text-rose-600"></i> ë°˜ë“œì‹œ ì§ì ‘ ì°¾ì€ 'ìˆ«ì'ì™€ 'ë°ì´í„°'ë¥¼ í”„ë¡¬í”„íŠ¸ì— ë„£ìœ¼ì„¸ìš”.</p>
                            <p className="flex gap-4"><i data-lucide="check-circle" className="w-6 h-6 shrink-0 text-rose-600"></i> ë§¤ë„ëŸ½ê²Œ ìˆ˜ì •í•´ë‹¬ë¼ëŠ” ìš”ì²­ë³´ë‹¤, ë…¼ë¦¬ì˜ í—ˆì ì„ ì°¾ì•„ë‹¬ë¼ê³  í•˜ì„¸ìš”.</p>
                         </div>
                      </div>
                    </div>
                  )}

                  {/* íƒ­ 8: 8~10ì°¨ì‹œ ì„±ì°° */}
                  {activeTab === 8 && (
                    <div className="space-y-10 fade-in flex-grow">
                      <div className="flex justify-between items-center border-b pb-8">
                        <div>
                          <h2 className="text-4xl font-black text-indigo-600 tracking-tighter">8~10ì°¨ì‹œ: ì„±ì°° ë° ìµœì¢… ìš”ì•½</h2>
                          <p className="text-slate-400 font-bold mt-1 text-xs uppercase">Synthesis & Final Portfolio</p>
                        </div>
                        <button onClick={handleAiConsult} disabled={aiLoading} className="bg-indigo-600 text-white px-8 py-5 rounded-[24px] text-sm font-black active:scale-95 shadow-2xl">
                           <i data-lucide="sparkles" className="w-5 h-5 inline-block mr-2"></i> AI ì„¸íŠ¹ ì´ˆì•ˆ ì™„ì„± ìš”ì²­
                        </button>
                      </div>
                      <div className="space-y-8 flex-grow">
                        <div className="space-y-4">
                          <Label>ìµœì¢… ì£¼ì¥ (Final Claim)</Label>
                          <textarea name="s8_claim" value={sessionData.s8_claim} onChange={handleInput} className="w-full h-32 p-8 rounded-[40px] bg-slate-50 outline-none font-black text-xl leading-relaxed" placeholder="íƒêµ¬ ê²°ê³¼ë¥¼ í•œ ë¬¸ì¥ìœ¼ë¡œ ì •ì˜í•œë‹¤ë©´?" />
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                          <div className="space-y-4">
                            <Label>ì„±ì¥ ë° ë°°ìš´ ì </Label>
                            <textarea name="s8_growth" value={sessionData.s8_growth} onChange={handleInput} className="w-full h-40 p-8 rounded-[40px] bg-slate-50 outline-none font-bold text-base" placeholder="ê°œë…/ê¸°ìˆ /íƒœë„ ì¸¡ë©´ì—ì„œì˜ ë³€í™”" />
                          </div>
                          <div className="space-y-4">
                            <Label>í›„ì† íƒêµ¬ ì œì–¸</Label>
                            <textarea name="s8_next" value={sessionData.s8_next} onChange={handleInput} className="w-full h-40 p-8 rounded-[40px] bg-slate-50 outline-none font-bold text-base" placeholder="í•œê³„ì ê³¼ ë‹¤ìŒ ì—°êµ¬ ë°©í–¥" />
                          </div>
                        </div>
                        <div className="p-12 bg-slate-900 text-white rounded-[64px] shadow-2xl relative overflow-hidden flex-grow">
                           <div className="absolute top-0 right-0 p-10 opacity-10"><i data-lucide="graduation-cap" className="w-40 h-40 text-indigo-400"></i></div>
                           <Label><span className="text-indigo-400">ğŸ“ ìƒí™œê¸°ë¡ë¶€ ìš”ì•½ë³¸ (FINAL SUMMARY)</span></Label>
                           <textarea
                             name="s8_summary"
                             value={sessionData.s8_summary}
                             onChange={handleInput}
                             className="w-full h-72 bg-transparent border-none outline-none text-xl font-black leading-relaxed mt-6 resize-none scrollbar-hide relative z-10"
                             placeholder="[ë™ê¸°-ê³¼ì •-ì„±ì¥-í›„ì†] êµ¬ì¡°ë¡œ 10ì°¨ì‹œ ì—¬ì •ì„ 500ì ì´ë‚´ë¡œ ì™„ê²°í•˜ì„¸ìš”."
                           />
                        </div>
                      </div>
                    </div>
                  )}

                </div>
              </div>
            </main>
          </div>

          {/* ğŸ–¨ï¸ ì¸ì‡„ìš© ë ˆì´ì•„ì›ƒ (ì™„ì „ ë³µêµ¬) */}
          <div className="print-only bg-white text-slate-900 w-full font-serif">
            
            {/* 1í˜ì´ì§€: í‘œì§€ */}
            <div className="page flex flex-col justify-between p-24 border-[30px] border-double border-slate-900 m-10">
              <div className="mt-20">
                <div className="flex gap-4 items-center mb-10">
                  <div className="bg-slate-900 text-white p-3 font-black text-xs uppercase tracking-widest">Premium Research Report</div>
                </div>
                <h1 className="text-8xl font-black tracking-tighter leading-tight mb-6">ì‹¬í™” íƒêµ¬<br />í†µí•© ì›Œí¬ë¶</h1>
                <p className="text-3xl font-bold text-slate-400 uppercase tracking-[0.4em] mb-40">Comprehensive Research Workbook</p>
                
                <div className="grid grid-cols-2 gap-y-16 gap-x-32 pt-20 border-t-8 border-slate-900">
                  <div><p className="text-sm font-black text-slate-400 mb-4 uppercase">Institution</p><p className="text-5xl font-black">{studentInfo.school || "ë¯¸ì…ë ¥"}</p></div>
                  <div><p className="text-sm font-black text-slate-400 mb-4 uppercase">Target Major</p><p className="text-5xl font-black">{studentInfo.major || "ë¯¸ì…ë ¥"}</p></div>
                  <div><p className="text-sm font-black text-slate-400 mb-4 uppercase">Student Info</p><p className="text-5xl font-black">{studentInfo.gradeClass} {studentInfo.name || "ë¯¸ì…ë ¥"}</p></div>
                  <div><p className="text-sm font-black text-slate-400 mb-4 uppercase">Issued Date</p><p className="text-5xl font-black">{issueDate}</p></div>
                </div>
              </div>
              <div className="text-right text-slate-300 font-black italic text-xl">MASTER SYSTEM v3.9 PRO EDITION</div>
            </div>

            <div className="page-break"></div>

            {/* 2í˜ì´ì§€: íƒêµ¬ ì§ˆë¬¸ ë° ì„¤ê³„ */}
            <div className="page p-20 space-y-16 min-h-[290mm]">
              <h2 className="text-5xl font-black border-b-8 border-slate-900 pb-6 uppercase tracking-tighter">01. íƒêµ¬ ì„¤ê³„ ë° ë°°ê²½</h2>
              <div className="space-y-12">
                <div className="p-12 bg-slate-50 border-4 border-slate-100 rounded-[48px]">
                  <h3 className="text-sm font-black text-slate-400 mb-4 uppercase">[Core Question]</h3>
                  <p className="text-4xl font-black text-indigo-900 leading-tight">{sessionData.s1_question || "ì…ë ¥ëœ íƒêµ¬ ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤."}</p>
                </div>
                <div className="grid grid-cols-1 gap-12">
                  <div>
                    <h3 className="text-sm font-black text-slate-400 mb-4 uppercase border-b-2 pb-2 inline-block">[Motivation]</h3>
                    <p className="text-xl font-medium leading-relaxed whitespace-pre-wrap">{sessionData.s1_motive}</p>
                  </div>
                  <div>
                    <h3 className="text-sm font-black text-slate-400 mb-4 uppercase border-b-2 pb-2 inline-block">[Academic Connection]</h3>
                    <p className="text-xl font-medium leading-relaxed whitespace-pre-wrap">{sessionData.s1_connection}</p>
                  </div>
                </div>
                <div className="grid grid-cols-2 gap-12 border-t-2 pt-10">
                  <div><h3 className="text-sm font-black text-slate-400 mb-2">[Target Book]</h3><p className="text-2xl font-black">{sessionData.s2_book}</p></div>
                  <div><h3 className="text-sm font-black text-slate-400 mb-2">[Final Goal]</h3><p className="text-2xl font-black">{sessionData.s2_goal}</p></div>
                </div>
              </div>
            </div>

            <div className="page-break"></div>

            {/* 3í˜ì´ì§€: ë°ì´í„° ë¶„ì„ ë° ìˆ˜í–‰ */}
            <div className="page p-20 space-y-16 min-h-[290mm]">
              <h2 className="text-5xl font-black border-b-8 border-slate-900 pb-6 uppercase tracking-tighter">02. ë°ì´í„° ë¶„ì„ ë° ìˆ˜í–‰ ê³¼ì •</h2>
              <div className="space-y-12">
                <div className="bg-slate-900 text-white p-16 rounded-[64px] shadow-xl relative overflow-hidden">
                   <div className="absolute top-0 right-0 p-8 opacity-10"><i data-lucide="bar-chart-2" className="w-40 h-40"></i></div>
                   <h3 className="text-xs font-black text-indigo-400 mb-6 uppercase tracking-widest">[Core Evidence & Data]</h3>
                   <p className="text-2xl font-bold leading-relaxed whitespace-pre-wrap relative z-10">{sessionData.s4_fact}</p>
                </div>
                <div>
                  <h3 className="text-sm font-black text-slate-400 mb-4 uppercase border-b-2 pb-2 inline-block">[Knowledge Depth]</h3>
                  <p className="text-xl font-medium leading-relaxed whitespace-pre-wrap">{sessionData.s3_depth}</p>
                </div>
                <div className="p-10 bg-slate-50 border-2 border-slate-100 rounded-[48px]">
                  <h3 className="text-sm font-black text-slate-400 mb-4 uppercase">[Action Log]</h3>
                  <p className="text-lg font-bold leading-relaxed whitespace-pre-wrap">{sessionData.s5_log}</p>
                </div>
              </div>
            </div>

            <div className="page-break"></div>

            {/* 4í˜ì´ì§€: ìµœì¢… ê²°ê³¼ ë° ì„¸íŠ¹ */}
            <div className="page p-20 space-y-16 min-h-[290mm]">
              <h2 className="text-5xl font-black border-b-8 border-slate-900 pb-6 uppercase tracking-tighter">03. ìµœì¢… ì„±ì°° ë° ë¦¬í¬íŠ¸ ìš”ì•½</h2>
              <div className="space-y-12">
                <div className="p-16 bg-indigo-600 text-white rounded-[72px] shadow-2xl">
                  <h3 className="text-xs font-black text-indigo-300 mb-6 uppercase tracking-widest">[Final Thesis / Claim]</h3>
                  <p className="text-4xl font-black leading-tight">{sessionData.s8_claim}</p>
                </div>
                <div className="grid grid-cols-2 gap-16">
                  <div>
                    <h3 className="text-sm font-black text-slate-400 mb-4 uppercase border-b-2 pb-2 inline-block">[Growth & Insight]</h3>
                    <p className="text-xl font-bold leading-relaxed whitespace-pre-wrap">{sessionData.s8_growth}</p>
                  </div>
                  <div>
                    <h3 className="text-sm font-black text-slate-400 mb-4 uppercase border-b-2 pb-2 inline-block">[Further Research]</h3>
                    <p className="text-xl font-bold leading-relaxed whitespace-pre-wrap">{sessionData.s8_next}</p>
                  </div>
                </div>
                <div className="mt-20 p-20 bg-slate-50 rounded-[80px] border-[10px] border-double border-indigo-200">
                  <h3 className="text-3xl font-black text-indigo-950 mb-8 flex items-center gap-3">
                    <i data-lucide="graduation-cap" className="w-10 h-10"></i> ìƒí™œê¸°ë¡ë¶€ ìµœì¢… ìš”ì•½ë³¸
                  </h3>
                  <p className="text-2xl font-bold leading-loose whitespace-pre-wrap">
                    {sessionData.s8_summary || "ìš”ì•½ë³¸ì´ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."}
                  </p>
                </div>
              </div>
            </div>

          </div>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
